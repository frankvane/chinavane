function h(r,s,e){const c=(s.baseDelayMs??500)*Math.pow(2,Math.max(0,e-1)),n=s.jitter?Math.random()*.25*c:0,u=c+n;setTimeout(()=>{var a;const t=(a=r.imageRef)==null?void 0:a.current;if(t)try{const o=`${r.src}${r.src.includes("?")?"&":"?"}retry=${Date.now()}&n=${e}`;t.src=o}catch{}},u)}function y(r={}){const{maxRetries:s=2}=r;return{name:"retry-on-error",version:"1.0.0",config:r,hooks:{onLoadError:(e,c)=>{var a,o,i;try{(a=e.sharedData)==null||a.set("had-error",!0)}catch{}const n="retry-count",t=Number(((o=e.sharedData)==null?void 0:o.get(n))??0)+1;return t<=s?((i=e.sharedData)==null||i.set(n,t),h(e,r,t),!0):!1}}}}export{y as c};
