function s(n,e){try{const t=new URL(n,typeof window<"u"?window.location.origin:"http://localhost");return Object.entries(e).forEach(([r,i])=>{i!=null&&t.searchParams.set(r,String(i))}),t.toString()}catch{const t=Object.keys(e).filter(o=>e[o]!==void 0&&e[o]!==null);if(t.length===0)return n;const r=n.includes("?")?"&":"?",i=t.map(o=>`${encodeURIComponent(o)}=${encodeURIComponent(String(e[o]))}`).join("&");return`${n}${r}${i}`}}function w(n={}){const{enabled:e=!0,maxWidth:t=1920,quality:r=.85,format:i="auto",widthParam:o="w",qualityParam:d="q",formatParam:c="format"}=n;return{name:"image-optimization",version:"1.0.0",config:n,hooks:{transformProps:a=>{if(!e)return a;try{const u=typeof window<"u"?Math.max(1,window.devicePixelRatio||1):1,h=typeof window<"u"&&window.innerWidth||t,m=Math.min(Math.round(h*u),t),f=s(a.src,{[o]:m,[d]:Math.max(0,Math.min(1,r)),[c]:i});return{...a,src:f}}catch{return a}}}}}export{w as c};
