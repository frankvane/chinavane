import{r,j as q}from"./index-DYgqlTni.js";function ae(e){let t=e;for(;t;){if(t.dir)return t.dir==="rtl";t=t.parentElement}return!1}function ce(e,t){const[o,n]=r.useState(t==="rtl");return r.useLayoutEffect(()=>{e&&(t||n(ae(e)))},[t,e]),o}const D=typeof window<"u"?r.useLayoutEffect:r.useEffect;function X(e){if(e!==void 0)switch(typeof e){case"number":return e;case"string":{if(e.endsWith("px"))return parseFloat(e);break}}}function de({box:e,defaultHeight:t,defaultWidth:o,disabled:n,element:i,mode:s,style:l}){const{styleHeight:u,styleWidth:c}=r.useMemo(()=>({styleHeight:X(l==null?void 0:l.height),styleWidth:X(l==null?void 0:l.width)}),[l==null?void 0:l.height,l==null?void 0:l.width]),[d,h]=r.useState({height:t,width:o}),f=n||s==="only-height"&&u!==void 0||s==="only-width"&&c!==void 0||u!==void 0&&c!==void 0;return D(()=>{if(i===null||f)return;const g=new ResizeObserver(b=>{for(const S of b){const{contentRect:w,target:m}=S;i===m&&h(z=>z.height===w.height&&z.width===w.width?z:{height:w.height,width:w.width})}});return g.observe(i,{box:e}),()=>{g==null||g.unobserve(i)}},[e,f,i,u,c]),r.useMemo(()=>({height:u??d.height,width:c??d.width}),[d,u,c])}function te(e){const t=r.useRef(()=>{throw new Error("Cannot call an event handler while rendering.")});return D(()=>{t.current=e},[e]),r.useCallback(o=>{var n;return(n=t.current)==null?void 0:n.call(t,o)},[t])}let $=null;function ue(e=!1){if($===null||e){const t=document.createElement("div"),o=t.style;o.width="50px",o.height="50px",o.overflow="scroll",o.direction="rtl";const n=document.createElement("div"),i=n.style;return i.width="100px",i.height="100px",t.appendChild(n),document.body.appendChild(t),t.scrollLeft>0?$="positive-descending":(t.scrollLeft=1,t.scrollLeft===0?$="negative":$="positive-ascending"),document.body.removeChild(t),$}return $}function Y({containerElement:e,direction:t,isRtl:o,scrollOffset:n}){if(t==="horizontal"&&o)switch(ue()){case"negative":return-n;case"positive-descending":{if(e){const{clientWidth:i,scrollLeft:s,scrollWidth:l}=e;return l-i-s}break}}return n}function A(e,t="Assertion error"){if(!e)throw console.error(t),Error(t)}function _(e,t){if(e===t)return!0;if(!!e!=!!t||(A(e!==void 0),A(t!==void 0),Object.keys(e).length!==Object.keys(t).length))return!1;for(const o in e)if(!Object.is(t[o],e[o]))return!1;return!0}function ne({cachedBounds:e,itemCount:t,itemSize:o}){if(t===0)return 0;if(typeof o=="number")return t*o;{const n=e.get(e.size===0?0:e.size-1);A(n!==void 0,"Unexpected bounds cache miss");const i=(n.scrollOffset+n.size)/e.size;return t*i}}function fe({align:e,cachedBounds:t,index:o,itemCount:n,itemSize:i,containerScrollOffset:s,containerSize:l}){const u=ne({cachedBounds:t,itemCount:n,itemSize:i}),c=t.get(o),d=Math.max(0,Math.min(u-l,c.scrollOffset)),h=Math.max(0,c.scrollOffset-l+c.size);switch(e==="smart"&&(s>=h&&s<=d?e="auto":e="center"),e){case"start":return d;case"end":return h;case"center":return c.scrollOffset<=l/2?0:c.scrollOffset+c.size/2>=u-l/2?u-l:c.scrollOffset+c.size/2-l/2;case"auto":default:return s>=h&&s<=d?s:s<h?h:d}}function ee({cachedBounds:e,containerScrollOffset:t,containerSize:o,itemCount:n,overscanCount:i}){const s=n-1;let l=0,u=-1,c=0,d=-1,h=0;for(;h<s;){const f=e.get(h);if(f.scrollOffset+f.size>t)break;h++}for(l=h,c=Math.max(0,l-i);h<s;){const f=e.get(h);if(f.scrollOffset+f.size>=t+o)break;h++}return u=Math.min(s,h),d=Math.min(n-1,u+i),l<0&&(l=0,u=-1,c=0,d=-1),{startIndexVisible:l,stopIndexVisible:u,startIndexOverscan:c,stopIndexOverscan:d}}function he({itemCount:e,itemProps:t,itemSize:o}){const n=new Map;return{get(i){for(A(i<e,`Invalid index ${i}`);n.size-1<i;){const l=n.size;let u;switch(typeof o){case"function":{u=o(l,t);break}case"number":{u=o;break}}if(l===0)n.set(l,{size:u,scrollOffset:0});else{const c=n.get(l-1);A(c!==void 0,`Unexpected bounds cache miss for index ${i}`),n.set(l,{scrollOffset:c.scrollOffset+c.size,size:u})}}const s=n.get(i);return A(s!==void 0,`Unexpected bounds cache miss for index ${i}`),s},set(i,s){n.set(i,s)},get size(){return n.size}}}function me({itemCount:e,itemProps:t,itemSize:o}){return r.useMemo(()=>he({itemCount:e,itemProps:t,itemSize:o}),[e,t,o])}function ge({containerSize:e,itemSize:t}){let o;switch(typeof t){case"string":{A(t.endsWith("%"),`Invalid item size: "${t}"; string values must be percentages (e.g. "100%")`),A(e!==void 0,"Container size must be defined if a percentage item size is specified"),o=e*parseInt(t)/100;break}default:{o=t;break}}return o}function Q({containerElement:e,containerStyle:t,defaultContainerSize:o=0,direction:n,isRtl:i=!1,itemCount:s,itemProps:l,itemSize:u,onResize:c,overscanCount:d}){const[h,f]=r.useState({startIndexVisible:0,startIndexOverscan:0,stopIndexVisible:-1,stopIndexOverscan:-1}),{startIndexVisible:g,startIndexOverscan:b,stopIndexVisible:S,stopIndexOverscan:w}={startIndexVisible:Math.min(s-1,h.startIndexVisible),startIndexOverscan:Math.min(s-1,h.startIndexOverscan),stopIndexVisible:Math.min(s-1,h.stopIndexVisible),stopIndexOverscan:Math.min(s-1,h.stopIndexOverscan)},{height:m=o,width:z=o}=de({defaultHeight:n==="vertical"?o:void 0,defaultWidth:n==="horizontal"?o:void 0,element:e,mode:n==="vertical"?"only-height":"only-width",style:t}),y=r.useRef({height:0,width:0}),k=n==="vertical"?m:z,a=ge({containerSize:k,itemSize:u});r.useLayoutEffect(()=>{if(typeof c=="function"){const x=y.current;(x.height!==m||x.width!==z)&&(c({height:m,width:z},{...x}),x.height=m,x.width=z)}},[m,c,z]);const O=me({itemCount:s,itemProps:l,itemSize:a}),H=r.useCallback(x=>O.get(x),[O]),C=r.useCallback(()=>ne({cachedBounds:O,itemCount:s,itemSize:a}),[O,s,a]),L=r.useCallback(x=>{const R=Y({containerElement:e,direction:n,isRtl:i,scrollOffset:x});return ee({cachedBounds:O,containerScrollOffset:R,containerSize:k,itemCount:s,overscanCount:d})},[O,e,k,n,i,s,d]);D(()=>{const x=(n==="vertical"?e==null?void 0:e.scrollTop:e==null?void 0:e.scrollLeft)??0;f(L(x))},[e,n,L]),D(()=>{if(!e)return;const x=()=>{f(R=>{const{scrollLeft:M,scrollTop:v}=e,p=Y({containerElement:e,direction:n,isRtl:i,scrollOffset:n==="vertical"?v:M}),T=ee({cachedBounds:O,containerScrollOffset:p,containerSize:k,itemCount:s,overscanCount:d});return _(T,R)?R:T})};return e.addEventListener("scroll",x),()=>{e.removeEventListener("scroll",x)}},[O,e,k,n,s,d]);const I=te(({align:x="auto",containerScrollOffset:R,index:M})=>{let v=fe({align:x,cachedBounds:O,containerScrollOffset:R,containerSize:k,index:M,itemCount:s,itemSize:a});if(e){if(v=Y({containerElement:e,direction:n,isRtl:i,scrollOffset:v}),typeof e.scrollTo!="function"){const p=L(v);_(h,p)||f(p)}return v}});return{getCellBounds:H,getEstimatedSize:C,scrollToIndex:I,startIndexOverscan:b,startIndexVisible:g,stopIndexOverscan:w,stopIndexVisible:S}}function oe(e){return r.useMemo(()=>e,Object.values(e))}function ie(e,t){const{ariaAttributes:o,style:n,...i}=e,{ariaAttributes:s,style:l,...u}=t;return _(o,s)&&_(n,l)&&_(i,u)}function xe({cellComponent:e,cellProps:t,children:o,className:n,columnCount:i,columnWidth:s,defaultHeight:l=0,defaultWidth:u=0,dir:c,gridRef:d,onCellsRendered:h,onResize:f,overscanCount:g=3,rowCount:b,rowHeight:S,style:w,tagName:m="div",...z}){const y=oe(t),k=r.useMemo(()=>r.memo(e,ie),[e]),[a,O]=r.useState(null),H=ce(a,c),{getCellBounds:C,getEstimatedSize:L,startIndexOverscan:I,startIndexVisible:x,scrollToIndex:R,stopIndexOverscan:M,stopIndexVisible:v}=Q({containerElement:a,containerStyle:w,defaultContainerSize:u,direction:"horizontal",isRtl:H,itemCount:i,itemProps:y,itemSize:s,onResize:f,overscanCount:g}),{getCellBounds:p,getEstimatedSize:T,startIndexOverscan:V,startIndexVisible:J,scrollToIndex:U,stopIndexOverscan:N,stopIndexVisible:K}=Q({containerElement:a,containerStyle:w,defaultContainerSize:l,direction:"vertical",itemCount:b,itemProps:y,itemSize:S,onResize:f,overscanCount:g});r.useImperativeHandle(d,()=>({get element(){return a},scrollToCell({behavior:W="auto",columnAlign:E="auto",columnIndex:B,rowAlign:j="auto",rowIndex:P}){const G=R({align:E,containerScrollOffset:(a==null?void 0:a.scrollLeft)??0,index:B}),le=U({align:j,containerScrollOffset:(a==null?void 0:a.scrollTop)??0,index:P});typeof(a==null?void 0:a.scrollTo)=="function"&&a.scrollTo({behavior:W,left:G,top:le})},scrollToColumn({align:W="auto",behavior:E="auto",index:B}){const j=R({align:W,containerScrollOffset:(a==null?void 0:a.scrollLeft)??0,index:B});typeof(a==null?void 0:a.scrollTo)=="function"&&a.scrollTo({behavior:E,left:j})},scrollToRow({align:W="auto",behavior:E="auto",index:B}){const j=U({align:W,containerScrollOffset:(a==null?void 0:a.scrollTop)??0,index:B});typeof(a==null?void 0:a.scrollTo)=="function"&&a.scrollTo({behavior:E,top:j})}}),[a,R,U]),r.useEffect(()=>{I>=0&&M>=0&&V>=0&&N>=0&&h&&h({columnStartIndex:x,columnStopIndex:v,rowStartIndex:J,rowStopIndex:K},{columnStartIndex:I,columnStopIndex:M,rowStartIndex:V,rowStopIndex:N})},[h,I,x,M,v,V,J,N,K]);const re=r.useMemo(()=>{const W=[];if(i>0&&b>0)for(let E=V;E<=N;E++){const B=p(E),j=[];for(let P=I;P<=M;P++){const G=C(P);j.push(r.createElement(k,{...y,ariaAttributes:{"aria-colindex":P+1,role:"gridcell"},columnIndex:P,key:P,rowIndex:E,style:{position:"absolute",left:H?void 0:0,right:H?0:void 0,transform:`translate(${H?-G.scrollOffset:G.scrollOffset}px, ${B.scrollOffset}px)`,height:B.size,width:G.size}}))}W.push(q.jsx("div",{role:"row","aria-rowindex":E+1,children:j},E))}return W},[k,y,i,I,M,C,p,H,b,V,N]),se=q.jsx("div",{"aria-hidden":!0,style:{height:T(),width:L(),zIndex:-1}});return r.createElement(m,{"aria-colcount":i,"aria-rowcount":b,role:"grid",...z,className:n,dir:c,ref:O,style:{position:"relative",width:"100%",height:"100%",maxHeight:"100%",maxWidth:"100%",flexGrow:1,overflow:"auto",...w}},re,o,se)}const pe=r.useState,ve=r.useRef;function be(e){return e!=null&&typeof e=="object"&&"getAverageRowHeight"in e&&typeof e.getAverageRowHeight=="function"}const Z="data-react-window-index";function we({children:e,className:t,defaultHeight:o=0,listRef:n,onResize:i,onRowsRendered:s,overscanCount:l=3,rowComponent:u,rowCount:c,rowHeight:d,rowProps:h,tagName:f="div",style:g,...b}){const S=oe(h),w=r.useMemo(()=>r.memo(u,ie),[u]),[m,z]=r.useState(null),y=be(d),k=r.useMemo(()=>y?v=>d.getRowHeight(v)??d.getAverageRowHeight():d,[y,d]),{getCellBounds:a,getEstimatedSize:O,scrollToIndex:H,startIndexOverscan:C,startIndexVisible:L,stopIndexOverscan:I,stopIndexVisible:x}=Q({containerElement:m,containerStyle:g,defaultContainerSize:o,direction:"vertical",itemCount:c,itemProps:S,itemSize:k,onResize:i,overscanCount:l});r.useImperativeHandle(n,()=>({get element(){return m},scrollToRow({align:v="auto",behavior:p="auto",index:T}){const V=H({align:v,containerScrollOffset:(m==null?void 0:m.scrollTop)??0,index:T});typeof(m==null?void 0:m.scrollTo)=="function"&&m.scrollTo({behavior:p,top:V})}}),[m,H]),D(()=>{if(!m)return;const v=Array.from(m.children).filter((p,T)=>{if(p.hasAttribute("aria-hidden"))return!1;const V=`${C+T}`;return p.setAttribute(Z,V),!0});if(y)return d.observeRowElements(v)},[m,y,d,C,I]),r.useEffect(()=>{C>=0&&I>=0&&s&&s({startIndex:L,stopIndex:x},{startIndex:C,stopIndex:I})},[s,C,L,I,x]);const R=r.useMemo(()=>{const v=[];if(c>0)for(let p=C;p<=I;p++){const T=a(p);v.push(r.createElement(w,{...S,ariaAttributes:{"aria-posinset":p+1,"aria-setsize":c,role:"listitem"},key:p,index:p,style:{position:"absolute",left:0,transform:`translateY(${T.scrollOffset}px)`,height:y?void 0:T.size,width:"100%"}}))}return v},[w,a,y,c,S,C,I]),M=q.jsx("div",{"aria-hidden":!0,style:{height:O(),width:"100%",zIndex:-1}});return r.createElement(f,{role:"list",...b,className:t,ref:z,style:{position:"relative",maxHeight:"100%",flexGrow:1,overflowY:"auto",...g}},R,e,M)}function ze({defaultRowHeight:e,key:t}){const[o,n]=r.useState({key:t,map:new Map});o.key!==t&&n({key:t,map:new Map});const{map:i}=o,s=r.useCallback(()=>{let f=0;return i.forEach(g=>{f+=g}),f===0?e:f/i.size},[e,i]),l=r.useCallback(f=>i.get(f),[i]),u=r.useCallback((f,g)=>{n(b=>{if(b.map.get(f)===g)return b;const S=new Map(b.map);return S.set(f,g),{...b,map:S}})},[]),c=te(f=>{f.length!==0&&f.forEach(g=>{const{borderBoxSize:b,target:S}=g,w=S.getAttribute(Z);A(w!==null,`Invalid ${Z} attribute value`);const m=parseInt(w),{blockSize:z}=b[0];z&&u(m,z)})}),[d]=r.useState(()=>new ResizeObserver(c));r.useEffect(()=>()=>{d.disconnect()},[d]);const h=r.useCallback(f=>(f.forEach(g=>d.observe(g)),()=>{f.forEach(g=>d.unobserve(g))}),[d]);return r.useMemo(()=>({getAverageRowHeight:s,getRowHeight:l,setRowHeight:u,observeRowElements:h}),[s,l,u,h])}const Se=r.useState,Ie=r.useRef;let F=-1;function ye(e=!1){if(F===-1||e){const t=document.createElement("div"),o=t.style;o.width="50px",o.height="50px",o.overflow="scroll",document.body.appendChild(t),F=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return F}const Ce=Object.freeze(Object.defineProperty({__proto__:null,Grid:xe,List:we,getScrollbarSize:ye,useDynamicRowHeight:ze,useGridCallbackRef:pe,useGridRef:ve,useListCallbackRef:Se,useListRef:Ie},Symbol.toStringTag,{value:"Module"}));export{Ce as R};
