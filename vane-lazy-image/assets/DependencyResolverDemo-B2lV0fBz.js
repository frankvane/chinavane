import{r as y,R as B,j as e}from"./index-CAgh_i44.js";import{D as z}from"./DemoPage-DDy1Lp2W.js";import{w as C,D as j}from"./index-BUiUrMm6.js";import{L as A}from"./LazyLoadImageCore-BXC5ZDAL.js";import{c as b}from"./index-B1oANHbd.js";import{c as D}from"./index-utUPRXeo.js";import"./tomorrow-gtxudeWU.js";import"./GlobalContext-DYUf_pwM.js";const t=(P,p,f)=>({...P==="PluginA"?b({durationMs:300}):D({text:P,position:"top-left",opacity:.3}),name:P,version:p,dependencies:f}),H=()=>{const[P,p]=y.useState([]),[f,h]=y.useState([]),[x,d]=y.useState([]),[v,u]=y.useState(0),l=(n,o="info")=>{const g=o==="success"?"âœ…":o==="error"?"âŒ":o==="warning"?"âš ï¸":"â„¹ï¸";p(a=>[...a.slice(-14),`${g} ${n}`])},w=()=>{const n=new j;p([]),l("åœºæ™¯1ï¼šç®€å•ä¾èµ–é“¾ A â†’ B â†’ C","info");const o=t("PluginA","1.0.0"),g=t("PluginB","1.0.0",["PluginA"]),a=t("PluginC","1.0.0",["PluginB"]);n.addPlugin("PluginC",["PluginB"]),n.addPlugin("PluginA"),n.addPlugin("PluginB",["PluginA"]);const c=[o,g,a];h(c),l(`æ³¨å†Œæ’ä»¶: ${c.map(i=>i.name).join(", ")}`);try{const i=n.detectCycles();if(i.length>0)throw new Error(`æ£€æµ‹åˆ°å¾ªç¯ä¾èµ–: ${i.map(s=>s.join(" â†’ ")).join("; ")}`);const r=n.getTopologicalOrder(["PluginA","PluginB","PluginC"]);if(r.length===0)throw new Error("æ‹“æ‰‘æ’åºå¤±è´¥ï¼ˆå¯èƒ½å­˜åœ¨å¾ªç¯ä¾èµ–ï¼‰");d(r),u(s=>s+1),l(`âœ¨ è§£ææˆåŠŸ! é¡ºåº: ${r.join(" â†’ ")}`,"success")}catch(i){l(`è§£æå¤±è´¥: ${i.message}`,"error"),d([])}},S=()=>{const n=new j;p([]),l("åœºæ™¯2ï¼šå¤æ‚ä¾èµ–å›¾ï¼ˆè±å½¢ä¾èµ–ï¼‰","info");const o=t("PluginA","1.0.0"),g=t("PluginB","1.0.0",["PluginA"]),a=t("PluginC","1.0.0",["PluginA"]),c=t("PluginD","1.0.0",["PluginB","PluginC"]);n.addPlugin("PluginD",["PluginB","PluginC"]),n.addPlugin("PluginB",["PluginA"]),n.addPlugin("PluginC",["PluginA"]),n.addPlugin("PluginA");const i=[o,g,a,c];h(i),l(`æ³¨å†Œæ’ä»¶: ${i.map(r=>r.name).join(", ")}`);try{const r=n.detectCycles();if(r.length>0)throw new Error(`æ£€æµ‹åˆ°å¾ªç¯ä¾èµ–: ${r.map(m=>m.join(" â†’ ")).join("; ")}`);const s=n.getTopologicalOrder(["PluginA","PluginB","PluginC","PluginD"]);if(s.length===0)throw new Error("æ‹“æ‰‘æ’åºå¤±è´¥");d(s),u(m=>m+1),l(`âœ¨ è§£ææˆåŠŸ! é¡ºåº: ${s.join(" â†’ ")}`,"success")}catch(r){l(`è§£æå¤±è´¥: ${r.message}`,"error"),d([])}},$=()=>{const n=new j;p([]),l("åœºæ™¯3ï¼šå¾ªç¯ä¾èµ–æ£€æµ‹","warning");const o=t("PluginA","1.0.0",["PluginC"]),g=t("PluginB","1.0.0",["PluginA"]),a=t("PluginC","1.0.0",["PluginB"]);n.addPlugin("PluginA",["PluginC"]),n.addPlugin("PluginB",["PluginA"]),n.addPlugin("PluginC",["PluginB"]);const c=[o,g,a];h(c),l(`æ³¨å†Œæ’ä»¶: ${c.map(i=>i.name).join(", ")}`);try{const i=n.detectCycles();if(i.length>0){const s=i.map(m=>m.join(" â†’ ")).join("; ");l(`âš ï¸ æ£€æµ‹åˆ°å¾ªç¯ä¾èµ–: ${s}`,"error"),d([]),u(m=>m+1);return}const r=n.getTopologicalOrder(["PluginA","PluginB","PluginC"]);if(r.length===0)throw new Error("æ‹“æ‰‘æ’åºå¤±è´¥ï¼ˆå¾ªç¯ä¾èµ–ï¼‰");d(r),u(s=>s+1),l(`è§£ææˆåŠŸ! é¡ºåº: ${r.join(" â†’ ")}`,"success")}catch(i){l(`âš ï¸ æ£€æµ‹åˆ°å¾ªç¯ä¾èµ–: ${i.message}`,"error"),d([]),u(r=>r+1)}},k=()=>{const n=new j;p([]),l("åœºæ™¯4ï¼šå†²çªæ£€æµ‹","warning");const o=t("PluginA","1.0.0"),g=t("PluginB","1.0.0",["PluginA"]),a=t("PluginC","1.0.0",["PluginA"]);n.addPlugin("PluginA"),n.addPlugin("PluginB",["PluginA"],[],["PluginC"]),n.addPlugin("PluginC",["PluginA"],[],["PluginB"]);const c=[o,g,a];h(c),l(`æ³¨å†Œæ’ä»¶: ${c.map(i=>`${i.name}@${i.version}`).join(", ")}`);try{const i=n.checkConflicts("PluginB",new Set(["PluginA","PluginC"]));if(i.hasConflict){l(`âš ï¸ å†²çªæ£€æµ‹: PluginB ä¸ ${i.conflicts.join(", ")} å†²çª`,"error"),d([]),u(s=>s+1);return}const r=n.getTopologicalOrder(["PluginA","PluginB","PluginC"]);d(r),u(s=>s+1),l(`âœ¨ è§£ææˆåŠŸ! é¡ºåº: ${r.join(" â†’ ")}`,"success")}catch(i){l(`âš ï¸ è§£æå¤±è´¥: ${i.message}`,"error"),d([]),u(r=>r+1)}},R=B.useMemo(()=>x.length===0?C(A,[b({durationMs:300})]):C(A,[b({durationMs:300})]),[x,v]);return e.jsxs(z,{title:"DependencyResolver - ä¾èµ–è§£æå™¨",description:"è‡ªåŠ¨è§£ææ’ä»¶ä¾èµ–å…³ç³»ï¼Œç¡®å®šæ­£ç¡®çš„åŠ è½½é¡ºåº",children:[e.jsx("div",{style:{marginBottom:20},children:e.jsxs("div",{style:{padding:16,background:"#f0f9ff",borderRadius:"8px",border:"1px solid #0ea5e9"},children:[e.jsxs("p",{style:{margin:0,color:"#0369a1",lineHeight:"1.6",marginBottom:8},children:["ğŸ§© ",e.jsx("strong",{children:"ä¾èµ–è§£æåŠŸèƒ½ï¼š"})]}),e.jsxs("ul",{style:{margin:0,color:"#0369a1",lineHeight:"1.8"},children:[e.jsx("li",{children:"è‡ªåŠ¨æ‹“æ‰‘æ’åºï¼ˆTopological Sortï¼‰"}),e.jsx("li",{children:"å¾ªç¯ä¾èµ–æ£€æµ‹"}),e.jsx("li",{children:"ç‰ˆæœ¬å…¼å®¹æ€§æ£€æŸ¥ï¼ˆSemverï¼‰"}),e.jsx("li",{children:"ç¼ºå¤±ä¾èµ–è­¦å‘Š"})]})]})}),e.jsxs("div",{style:{marginBottom:30},children:[e.jsx("h3",{style:{fontSize:"1.1em",marginBottom:12},children:"ğŸ§ª æµ‹è¯•åœºæ™¯"}),e.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:[e.jsx("button",{onClick:w,style:{padding:"10px 16px",background:"#10b981",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"0.9em"},children:"âœ… åœºæ™¯1: ç®€å•ä¾èµ–é“¾"}),e.jsx("button",{onClick:S,style:{padding:"10px 16px",background:"#3b82f6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"0.9em"},children:"ğŸ“Š åœºæ™¯2: å¤æ‚ä¾èµ–å›¾"}),e.jsx("button",{onClick:$,style:{padding:"10px 16px",background:"#f59e0b",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"0.9em"},children:"ğŸ”„ åœºæ™¯3: å¾ªç¯ä¾èµ–"}),e.jsx("button",{onClick:k,style:{padding:"10px 16px",background:"#ef4444",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"0.9em"},children:"âš ï¸ åœºæ™¯4: å†²çªæ£€æµ‹"})]})]}),f.length>0&&e.jsxs("div",{style:{marginBottom:20},children:[e.jsx("h3",{style:{fontSize:"1.1em",marginBottom:12},children:"ğŸ“¦ æ³¨å†Œçš„æ’ä»¶"}),e.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:f.map(n=>e.jsxs("div",{style:{padding:"8px 12px",background:"#f3f4f6",borderRadius:"6px",fontSize:"0.85em",border:"1px solid #d1d5db"},children:[e.jsx("div",{style:{fontWeight:"bold"},children:n.name}),e.jsxs("div",{style:{color:"#6b7280",fontSize:"0.9em"},children:["v",n.version]}),n.dependencies&&e.jsxs("div",{style:{color:"#9ca3af",fontSize:"0.85em",marginTop:4},children:["ä¾èµ–: ",Object.keys(n.dependencies).join(", ")]})]},n.name))})]}),x.length>0&&e.jsxs("div",{style:{marginBottom:20},children:[e.jsx("h3",{style:{fontSize:"1.1em",marginBottom:12},children:"âœ… è§£æåçš„åŠ è½½é¡ºåº"}),e.jsx("div",{style:{padding:16,background:"#f0fdf4",borderRadius:"8px",border:"1px solid #22c55e"},children:e.jsx("div",{style:{display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:x.map((n,o)=>e.jsxs(B.Fragment,{children:[e.jsxs("div",{style:{padding:"8px 16px",background:"#dcfce7",borderRadius:"6px",fontWeight:"bold",color:"#166534"},children:[o+1,". ",n]}),o<x.length-1&&e.jsx("span",{style:{color:"#16a34a",fontSize:"1.2em"},children:"â†’"})]},n))})})]}),e.jsxs("div",{style:{marginBottom:30},children:[e.jsx("h3",{style:{fontSize:"1.1em",marginBottom:12},children:"ğŸ“œ è§£ææ—¥å¿—"}),e.jsx("div",{style:{padding:16,background:"#1f2937",borderRadius:"8px",color:"#d1d5db",fontFamily:"monospace",fontSize:"0.85em",maxHeight:200,overflow:"auto"},children:P.length===0?e.jsx("div",{style:{color:"#6b7280"},children:"ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®å¼€å§‹æµ‹è¯•..."}):P.map((n,o)=>e.jsx("div",{style:{marginBottom:4},children:n},o))})]}),e.jsxs("div",{style:{marginBottom:20},children:[e.jsx("h3",{style:{fontSize:"1.1em",marginBottom:12},children:"ğŸ–¼ï¸ ä½¿ç”¨è§£æåçš„æ’ä»¶"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(250px, 1fr))",gap:16},children:Array.from({length:4},(n,o)=>e.jsx("div",{style:{width:"100%",height:150},children:e.jsx(R,{src:`https://picsum.photos/seed/dep-resolver-${v}-${o}/800/600`,alt:`ä¾èµ–è§£æç¤ºä¾‹ ${o+1}`,loading:"lazy",containerStyle:{width:"100%",height:"100%",background:"#f3f4f6",borderRadius:"8px"},imageStyle:{width:"100%",height:"100%",objectFit:"cover"}})},`${v}-${o}`))})]}),e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:"1.1em",marginBottom:12},children:"ğŸ’» API ä½¿ç”¨ç¤ºä¾‹"}),e.jsx("div",{style:{padding:16,background:"#f9fafb",borderRadius:"8px",border:"1px solid #e5e7eb"},children:e.jsx("pre",{style:{margin:0,fontSize:"0.85em",overflow:"auto"},children:`import { DependencyResolver } from "vane-lazy-image/advanced";

const resolver = new DependencyResolver();

// æ·»åŠ æ’ä»¶ä¾èµ–å…³ç³»ï¼ˆä¹±åºä¹Ÿå¯ä»¥ï¼‰
resolver.addPlugin("PluginB", ["PluginA"]); // B ä¾èµ– A
resolver.addPlugin("PluginC", ["PluginB"]); // C ä¾èµ– B
resolver.addPlugin("PluginA");              // A æ— ä¾èµ–

// æ£€æµ‹å¾ªç¯ä¾èµ–
const cycles = resolver.detectCycles();
if (cycles.length > 0) {
  console.error("å¾ªç¯ä¾èµ–:", cycles);
  throw new Error("å­˜åœ¨å¾ªç¯ä¾èµ–");
}

// æ‹“æ‰‘æ’åºï¼ˆè‡ªåŠ¨ç¡®å®šåŠ è½½é¡ºåºï¼‰
const order = resolver.getTopologicalOrder([
  "PluginA",
  "PluginB",
  "PluginC"
]);
// order: ["PluginA", "PluginB", "PluginC"] - æ­£ç¡®é¡ºåº!

// æ£€æŸ¥ä¾èµ–æ˜¯å¦æ»¡è¶³
const depCheck = resolver.checkDependencies(
  "PluginC",
  new Set(order)
);
console.log("ä¾èµ–æ»¡è¶³:", depCheck.satisfied);`})})]})]})};export{H as default};
