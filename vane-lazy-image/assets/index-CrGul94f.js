function b(a,o="image",s="anonymous"){try{if(typeof document>"u")return;const t=document.createElement("link");return t.setAttribute("rel","preload"),t.setAttribute("as",o||"image"),t.setAttribute("href",a),s&&t.setAttribute("crossorigin",s),document.head.appendChild(t),()=>{try{document.head.removeChild(t)}catch{}}}catch{}}function P(a={}){const{getNextSrc:o,target:s="container",trigger:t="mouseenter",as:l="image",max:p=2,dedupe:v=!0,crossOrigin:g="anonymous",debug:h=!1}=a,u=new Set;async function y(r){try{const e=o?await Promise.resolve(o(r)):void 0;if(!e)return;(Array.isArray(e)?e:[e]).slice(0,Math.max(1,p)).forEach(n=>{if(v&&u.has(n))return;if(b(n,l,g)&&u.add(n),h)try{console.debug("[HoverPrefetch] preload",{href:n,as:l})}catch{}})}catch(e){if(h)try{console.debug("[HoverPrefetch] error",e)}catch{}}}return{name:"hover-prefetch",version:"0.1.0",config:a,hooks:{onMount:r=>{var d,f,m;const e=(d=r.containerRef)==null?void 0:d.current,c=(f=r.imageRef)==null?void 0:f.current,i=s==="container"?e:c;if(!i)return;const n=()=>y(r);i.addEventListener(t,n,{passive:!0}),(m=r.sharedData)==null||m.set("hover-prefetch:cleanup",()=>{try{i.removeEventListener(t,n)}catch{}})},onUnmount:r=>{var c;const e=(c=r.sharedData)==null?void 0:c.get("hover-prefetch:cleanup");if(typeof e=="function")try{e()}catch{}u.clear()}}}}export{P as c};
