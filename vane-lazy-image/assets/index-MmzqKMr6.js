import{j as n,r as c,R as g}from"./index-D8F4DWO3.js";function p({bus:e,loading:s,showWhen:o="loading",height:f=3,color:x="#3b82f6",background:h="rgba(0,0,0,0.15)",showPercentText:v=!0}){const[t,m]=c.useState(null),[w,u]=c.useState(0),r=g.useRef(null);c.useEffect(()=>{const d=e==null?void 0:e.on("progress",a=>{m(a),a.indeterminate?r.current||(r.current=window.setInterval(()=>{u(l=>l<90?l+3:l)},160)):(u(a.percent??0),r.current&&(clearInterval(r.current),r.current=null))});return()=>{d&&d(),r.current&&(clearInterval(r.current),r.current=null)}},[e]);const y=o==="always"?!0:s,i=t!=null&&t.indeterminate?w:(t==null?void 0:t.percent)??0;return y?n.jsxs("div",{style:{position:"absolute",inset:0,pointerEvents:"none",background:h,display:"flex",alignItems:"flex-end",zIndex:10},children:[n.jsx("div",{style:{width:`${i}%`,height:f,background:x,transition:"width 200ms ease"}}),v&&n.jsx("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",fontSize:12,color:"#fff",textShadow:"0 1px 2px rgba(0,0,0,0.5)",textAlign:"center",pointerEvents:"none"},children:t!=null&&t.indeterminate?`加载中… ${i}%`:`${i}%`})]}):null}function j(e={}){return{name:"progress-overlay",version:"1.0.0",config:e,hooks:{renderOverlay:({bus:s,imageState:o})=>n.jsx(p,{bus:s,loading:o.isLoading,showWhen:e.showWhen,height:e.height,color:e.color,background:e.background,showPercentText:e.showPercentText??!0}),onProgress:()=>{}}}}export{j as c};
