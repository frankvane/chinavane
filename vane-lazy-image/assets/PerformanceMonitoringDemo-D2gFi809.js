import{r as n,j as e}from"./index-D8F4DWO3.js";import{D as v}from"./DemoPage-Cm4QH0wv.js";import{w as S}from"./index-B42FZQrT.js";import{c as z}from"./FetchLoaderPlugin-TVanieTR.js";import{L as w}from"./LazyLoadImageCore-CJJrIobl.js";import{c as R}from"./index-BI8EW8U_.js";import"./tomorrow-CQx5l04T.js";import"./GlobalContext-DYUf_pwM.js";const D=()=>{const[i,g]=n.useState([]),[d,x]=n.useState({totalImages:0,avgLoadTime:0}),[r,m]=n.useState(null),h=n.useRef(0),l=n.useRef(new Set),f=Array.from({length:6},(t,o)=>`https://picsum.photos/seed/perf-mon-${o}/800/600`),a=n.useCallback(t=>{if(l.current.has(t.src)){console.log("[æ€§èƒ½ç›‘æŽ§] è·³è¿‡é‡å¤æŠ¥å‘Š:",t.src);return}l.current.add(t.src),console.log("[æ€§èƒ½ç›‘æŽ§] æ–°æŠ¥å‘Š:",t);const o={src:t.src,duration:t.durationMs,timestamp:Date.now(),index:h.current++};g(u=>{const s=[...u,o],c=s.length,y=s.reduce((j,b)=>j+b.duration,0)/c;return x({totalImages:c,avgLoadTime:Math.round(y)}),s.slice(-10)})},[]),p=n.useMemo(()=>S(w,[z({enabled:!0}),R({showOverlay:!0,overlayPosition:"top-right",onReport:a})]),[a]);return e.jsxs(v,{title:"PerformanceMonitoring - æ€§èƒ½ç›‘æŽ§ç³»ç»Ÿ",description:"å®Œæ•´çš„æ€§èƒ½ç›‘æŽ§ç³»ç»Ÿï¼ŒåŒ…å«å®žæ—¶æŠ¥å‘Šã€å…¨å±€ç»Ÿè®¡å’Œæ€§èƒ½åˆ†æž",children:[e.jsx("div",{style:{marginBottom:20},children:e.jsxs("div",{style:{padding:16,background:"#ecfdf5",borderRadius:"8px",border:"1px solid #10b981"},children:[e.jsxs("p",{style:{margin:0,color:"#065f46",lineHeight:"1.6",marginBottom:8},children:["ðŸ“Š ",e.jsx("strong",{children:"ç›‘æŽ§ç³»ç»ŸåŠŸèƒ½ï¼š"})]}),e.jsxs("ul",{style:{margin:0,color:"#065f46",lineHeight:"1.8"},children:[e.jsx("li",{children:"å®žæ—¶æ€§èƒ½æŒ‡æ ‡æ”¶é›†ï¼ˆTTFBã€ä¸‹è½½ã€è§£ç ï¼‰"}),e.jsx("li",{children:"è‡ªåŠ¨æ€§èƒ½æŠ¥å‘Šç”Ÿæˆ"}),e.jsx("li",{children:"å…¨å±€ç›‘æŽ§ç®¡ç†å™¨ï¼ˆè·¨ç»„ä»¶ç»Ÿè®¡ï¼‰"}),e.jsx("li",{children:"æ€§èƒ½é˜ˆå€¼è­¦å‘Š"}),e.jsx("li",{children:"è¯¦ç»†çš„æ€§èƒ½åˆ†æžæŠ¥å‘Š"})]})]})}),e.jsxs("div",{style:{marginBottom:30},children:[e.jsx("h3",{style:{fontSize:"1.1em",marginBottom:12},children:"ðŸ“ˆ å…¨å±€ç»Ÿè®¡"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:16},children:[e.jsxs("div",{style:{padding:16,background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:"8px",color:"white",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"2em",fontWeight:"bold"},children:d.totalImages}),e.jsx("div",{style:{fontSize:"0.9em",opacity:.9},children:"åŠ è½½å›¾ç‰‡æ•°"})]}),e.jsxs("div",{style:{padding:16,background:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",borderRadius:"8px",color:"white",textAlign:"center"},children:[e.jsxs("div",{style:{fontSize:"2em",fontWeight:"bold"},children:[d.avgLoadTime,"ms"]}),e.jsx("div",{style:{fontSize:"0.9em",opacity:.9},children:"å¹³å‡åŠ è½½æ—¶é—´"})]}),e.jsxs("div",{style:{padding:16,background:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)",borderRadius:"8px",color:"white",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"2em",fontWeight:"bold"},children:i.length}),e.jsx("div",{style:{fontSize:"0.9em",opacity:.9},children:"æŠ¥å‘Šæ•°é‡"})]})]})]}),e.jsxs("div",{style:{marginBottom:30},children:[e.jsx("h3",{style:{fontSize:"1.1em",marginBottom:12},children:"ðŸ–¼ï¸ ç›‘æŽ§å›¾ç‰‡"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(250px, 1fr))",gap:16},children:f.map((t,o)=>e.jsxs("div",{children:[e.jsx("div",{style:{width:"100%",height:150,position:"relative"},children:e.jsx(p,{src:t,alt:`æ€§èƒ½ç›‘æŽ§ç¤ºä¾‹ ${o+1}`,loading:"lazy",containerStyle:{width:"100%",height:"100%",background:"#f3f4f6",borderRadius:"8px"},imageStyle:{width:"100%",height:"100%",objectFit:"cover"}})}),e.jsxs("p",{style:{textAlign:"center",marginTop:8,fontSize:"0.85em",color:"#666"},children:["å›¾ç‰‡ ",o+1]})]},t+o))})]}),e.jsxs("div",{style:{marginBottom:30},children:[e.jsx("h3",{style:{fontSize:"1.1em",marginBottom:12},children:"ðŸ“‹ å®žæ—¶æ€§èƒ½æŠ¥å‘Š"}),i.length===0?e.jsx("div",{style:{padding:20,background:"#f9fafb",borderRadius:"8px",textAlign:"center",color:"#6b7280"},children:"ç­‰å¾…æ€§èƒ½æ•°æ®æ”¶é›†ä¸­...ï¼ˆæ»šåŠ¨é¡µé¢ä»¥åŠ è½½å›¾ç‰‡ï¼‰"}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:i.map((t,o)=>e.jsx("div",{onClick:()=>m(o),style:{padding:12,background:r===o?"#eff6ff":"#f9fafb",borderRadius:"8px",border:`1px solid ${r===o?"#3b82f6":"#e5e7eb"}`,cursor:"pointer",transition:"all 0.2s"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsxs("strong",{style:{fontSize:"0.9em"},children:["å›¾ç‰‡ #",t.index+1]}),e.jsx("div",{style:{fontSize:"0.8em",color:"#666",marginTop:4},children:new Date(t.timestamp).toLocaleTimeString()})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsxs("div",{style:{fontSize:"1.1em",fontWeight:"bold",color:t.duration>3e3?"#dc2626":t.duration>1e3?"#f59e0b":"#16a34a"},children:[t.duration,"ms"]}),e.jsx("div",{style:{fontSize:"0.8em",color:"#666"},children:"åŠ è½½æ—¶é•¿"})]})]})},o))})]}),r!==null&&i[r]&&e.jsxs("div",{style:{marginBottom:20},children:[e.jsx("h3",{style:{fontSize:"1.1em",marginBottom:12},children:"ðŸ” è¯¦ç»†æŒ‡æ ‡"}),e.jsx("div",{style:{padding:16,background:"#ffffff",borderRadius:"8px",border:"1px solid #e5e7eb"},children:e.jsx("table",{style:{width:"100%",borderCollapse:"collapse"},children:e.jsxs("tbody",{children:[e.jsxs("tr",{style:{borderBottom:"1px solid #f3f4f6"},children:[e.jsx("td",{style:{padding:"8px 0",fontWeight:500},children:"å›¾ç‰‡ç´¢å¼•"}),e.jsxs("td",{style:{padding:"8px 0",textAlign:"right",color:"#666"},children:["#",i[r].index+1]})]}),e.jsxs("tr",{style:{borderBottom:"1px solid #f3f4f6"},children:[e.jsx("td",{style:{padding:"8px 0",fontWeight:500},children:"åŠ è½½æ—¶é•¿"}),e.jsxs("td",{style:{padding:"8px 0",textAlign:"right",color:"#666"},children:[i[r].duration,"ms"]})]}),e.jsxs("tr",{style:{borderBottom:"1px solid #f3f4f6"},children:[e.jsx("td",{style:{padding:"8px 0",fontWeight:500},children:"åŠ è½½æ—¶é—´"}),e.jsx("td",{style:{padding:"8px 0",textAlign:"right",color:"#666"},children:new Date(i[r].timestamp).toLocaleString()})]}),e.jsxs("tr",{style:{borderBottom:"1px solid #f3f4f6"},children:[e.jsx("td",{style:{padding:"8px 0",fontWeight:500},children:"å›¾ç‰‡URL"}),e.jsxs("td",{style:{padding:"8px 0",textAlign:"right",color:"#666",fontSize:"0.8em"},children:[i[r].src.substring(0,50),"..."]})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"8px 0",fontWeight:500},children:"æ€§èƒ½ç­‰çº§"}),e.jsx("td",{style:{padding:"8px 0",textAlign:"right"},children:e.jsx("span",{style:{padding:"4px 8px",borderRadius:"4px",fontSize:"0.85em",fontWeight:"bold",background:i[r].duration>3e3?"#fee2e2":i[r].duration>1e3?"#fef3c7":"#d1fae5",color:i[r].duration>3e3?"#dc2626":i[r].duration>1e3?"#f59e0b":"#16a34a"},children:i[r].duration>3e3?"æ…¢ (>3s)":i[r].duration>1e3?"ä¸­ç­‰ (>1s)":"å¿« (<1s)"})})]})]})})})]}),e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:"1.1em",marginBottom:12},children:"ðŸ’» API ä½¿ç”¨ç¤ºä¾‹"}),e.jsx("div",{style:{padding:16,background:"#f9fafb",borderRadius:"8px",border:"1px solid #e5e7eb"},children:e.jsx("pre",{style:{margin:0,fontSize:"0.85em",overflow:"auto"},children:`import {
  LazyLoadImageCore,
  createPerformanceMonitorPlugin,
  withPlugins,
} from "vane-lazy-image";

// ä½¿ç”¨æ€§èƒ½ç›‘æŽ§æ’ä»¶
const LazyImage = withPlugins(LazyLoadImageCore, [
  createPerformanceMonitorPlugin({
    showOverlay: true,          // æ˜¾ç¤ºæ€§èƒ½å åŠ å±‚
    overlayPosition: "top-right", // å åŠ å±‚ä½ç½®
    onReport: (data) => {
      // æ€§èƒ½æŠ¥å‘Šå›žè°ƒ
      console.log("å›¾ç‰‡åŠ è½½æ€§èƒ½:", data);
      // {
      //   src: string,
      //   durationMs: number,
      //   network: NetworkInfo,
      //   device: DeviceInfo
      // }
    },
  }),
]);

// ä½¿ç”¨ç»„ä»¶
<LazyImage
  src="https://example.com/image.jpg"
  alt="ç¤ºä¾‹å›¾ç‰‡"
/>`})})]})]})};export{D as default};
