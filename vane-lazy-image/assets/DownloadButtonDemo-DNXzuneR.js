import{j as o,R as S}from"./index-CAgh_i44.js";import{D as H}from"./DemoPage-DDy1Lp2W.js";import{w as t}from"./index-BUiUrMm6.js";import{L as r}from"./LazyLoadImageCore-BXC5ZDAL.js";import"./tomorrow-gtxudeWU.js";import"./GlobalContext-DYUf_pwM.js";const P=({config:s,context:i})=>{const{filename:l,position:h="top-right",size:p="medium",buttonStyle:g={},showOnHover:e=!1,onBeforeDownload:c,onDownloadSuccess:m,onDownloadError:j,customIcon:D,showTooltip:R=!0,tooltipText:z="ä¸‹è½½å›¾ç‰‡"}=s,[u,f]=S.useState(!1),[b,w]=S.useState(!1),C=async I=>{I.stopPropagation();try{w(!0),c&&await c(i.src);const d=l||i.src.split("/").pop()||"download.jpg",L=await(await fetch(i.src)).blob(),v=window.URL.createObjectURL(L),a=document.createElement("a");a.href=v,a.download=d,document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(v),m&&m(d)}catch(d){console.error("[DownloadButtonPlugin] Download failed:",d),j&&j(d)}finally{w(!1)}},k={small:{size:32,iconSize:16},medium:{size:40,iconSize:20},large:{size:48,iconSize:24}},{size:y,iconSize:x}=k[p],B={position:"absolute",...{"top-left":{top:"10px",left:"10px"},"top-right":{top:"10px",right:"10px"},"bottom-left":{bottom:"10px",left:"10px"},"bottom-right":{bottom:"10px",right:"10px"}}[h],width:`${y}px`,height:`${y}px`,borderRadius:"50%",backgroundColor:"rgba(0, 0, 0, 0.6)",border:"2px solid rgba(255, 255, 255, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",cursor:b?"wait":"pointer",zIndex:10,opacity:e&&!u?0:1,transform:u?"scale(1.1)":"scale(1)",transition:"all 0.3s ease",...g};return o.jsxs(o.Fragment,{children:[e&&o.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,zIndex:9,pointerEvents:"auto"},onMouseEnter:()=>f(!0),onMouseLeave:()=>f(!1)}),o.jsxs("div",{style:B,onClick:C,title:R?z:void 0,children:[D||(b?o.jsx("svg",{width:x,height:x,viewBox:"0 0 24 24",fill:"white",style:{animation:"downloadSpin 1s linear infinite"},children:o.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"white",strokeWidth:"2",fill:"none",strokeDasharray:"31.4",strokeDashoffset:"10"})}):o.jsx("svg",{width:x,height:x,viewBox:"0 0 24 24",fill:"white",children:o.jsx("path",{d:"M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"})})),o.jsx("style",{children:`
          @keyframes downloadSpin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
          }
        `})]})]})};function n(s){return{name:"download-button",version:"1.0.0",config:s,hooks:{renderOverlay:i=>{if(!i.imageState.isLoaded)return null;const l=i.config||s;return o.jsx(P,{config:l,context:i})}}}}const $=()=>{const s=t(r,[n({filename:"my-image.jpg",position:"top-right",size:"medium",onDownloadSuccess:e=>{console.log("ä¸‹è½½æˆåŠŸ:",e),alert(`å›¾ç‰‡ ${e} ä¸‹è½½æˆåŠŸï¼`)},onDownloadError:e=>{console.error("ä¸‹è½½å¤±è´¥:",e),alert("ä¸‹è½½å¤±è´¥ï¼Œè¯·é‡è¯•")}})]),i=t(r,[n({position:"top-left",size:"large",showOnHover:!0,tooltipText:"ç‚¹å‡»ä¸‹è½½é«˜æ¸…å›¾ç‰‡"})]),l=t(r,[n({position:"bottom-left",size:"small",buttonStyle:{backgroundColor:"rgba(52, 199, 89, 0.9)"}})]),h=t(r,[n({position:"bottom-right",size:"medium",buttonStyle:{backgroundColor:"rgba(255, 59, 48, 0.9)",borderRadius:"8px",border:"none"},tooltipText:"ä¸‹è½½åŽŸå›¾"})]),p=t(r,[n({filename:"premium-photo.jpg",position:"top-right",size:"large",onBeforeDownload:async e=>{console.log("å‡†å¤‡ä¸‹è½½:",e),await new Promise(c=>setTimeout(c,500))},onDownloadSuccess:e=>{console.log("ä¸‹è½½å®Œæˆ:",e)}})]),g=t(r,[n({position:"top-right",size:"medium",customIcon:o.jsx("div",{style:{fontSize:"20px",fontWeight:"bold",color:"white"},children:"â¬‡"}),buttonStyle:{backgroundColor:"rgba(88, 86, 214, 0.9)"}})]);return o.jsx(H,{title:"DownloadButton Plugin",description:"ä¸‹è½½æŒ‰é’®æ’ä»¶ - ä¸ºå›¾ç‰‡æ·»åŠ ä¸€é”®ä¸‹è½½åŠŸèƒ½",children:o.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"40px"},children:[o.jsxs("div",{style:{padding:"20px",backgroundColor:"#f8f9fa",borderRadius:"8px",borderLeft:"4px solid #17a2b8"},children:[o.jsx("h3",{style:{marginTop:0,color:"#17a2b8"},children:"âœ¨ åŠŸèƒ½ç‰¹æ€§"}),o.jsxs("ul",{style:{marginBottom:0,lineHeight:1.8},children:[o.jsxs("li",{children:["ðŸ“¥ ",o.jsx("strong",{children:"ä¸€é”®ä¸‹è½½"})," - ç‚¹å‡»æŒ‰é’®å³å¯ä¸‹è½½å›¾ç‰‡"]}),o.jsxs("li",{children:["ðŸ“ ",o.jsx("strong",{children:"å¤šä½ç½®æ”¯æŒ"})," - 4ä¸ªè§’è½ä½ç½®å¯é€‰"]}),o.jsxs("li",{children:["ðŸŽ¨ ",o.jsx("strong",{children:"è‡ªå®šä¹‰æ ·å¼"})," - å¤§å°ã€é¢œè‰²ã€å½¢çŠ¶å¯å®šåˆ¶"]}),o.jsxs("li",{children:["ðŸ‘€ ",o.jsx("strong",{children:"æ‚¬åœæ˜¾ç¤º"})," - å¯é€‰æ‹©ä»…æ‚¬åœæ—¶æ˜¾ç¤ºæŒ‰é’®"]}),o.jsxs("li",{children:["ðŸŽ¯ ",o.jsx("strong",{children:"ç”Ÿå‘½å‘¨æœŸå›žè°ƒ"})," - ä¸‹è½½å‰/åŽ/å¤±è´¥å›žè°ƒ"]}),o.jsxs("li",{children:["ðŸ”§ ",o.jsx("strong",{children:"è‡ªå®šä¹‰å›¾æ ‡"})," - æ”¯æŒè‡ªå®šä¹‰ä¸‹è½½å›¾æ ‡"]})]})]}),o.jsxs("div",{children:[o.jsx("h3",{children:"ðŸ“Œ ç¤ºä¾‹ 1: åŸºç¡€ä¸‹è½½åŠŸèƒ½"}),o.jsx("p",{style:{color:"#666",marginBottom:"16px"},children:"ç‚¹å‡»å³ä¸Šè§’çš„ä¸‹è½½æŒ‰é’®ï¼Œä¿å­˜å›¾ç‰‡åˆ°æœ¬åœ°ï¼ˆæ–‡ä»¶åï¼šmy-image.jpgï¼‰"}),o.jsx("div",{style:{maxWidth:"500px"},children:o.jsx(s,{src:"https://picsum.photos/id/1015/500/300",alt:"åŸºç¡€ä¸‹è½½",imageStyle:{width:"100%",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"}})})]}),o.jsxs("div",{children:[o.jsx("h3",{children:"ðŸ“Œ ç¤ºä¾‹ 2: æ‚¬åœæ˜¾ç¤ºæŒ‰é’®"}),o.jsx("p",{style:{color:"#666",marginBottom:"16px"},children:"å°†é¼ æ ‡æ‚¬åœåœ¨å›¾ç‰‡ä¸Šï¼Œå·¦ä¸Šè§’ä¼šå‡ºçŽ°ä¸‹è½½æŒ‰é’®"}),o.jsx("div",{style:{maxWidth:"500px"},children:o.jsx(i,{src:"https://picsum.photos/id/1018/500/300",alt:"æ‚¬åœä¸‹è½½",imageStyle:{width:"100%",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"}})})]}),o.jsxs("div",{children:[o.jsx("h3",{children:"ðŸ“Œ ç¤ºä¾‹ 3: è‡ªå®šä¹‰ä½ç½®å’Œå¤§å°"}),o.jsx("p",{style:{color:"#666",marginBottom:"16px"},children:"å·¦ä¸‹è§’çš„å°å·ç»¿è‰²ä¸‹è½½æŒ‰é’®"}),o.jsx("div",{style:{maxWidth:"500px"},children:o.jsx(l,{src:"https://picsum.photos/id/1019/500/300",alt:"è‡ªå®šä¹‰ä½ç½®",imageStyle:{width:"100%",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"}})})]}),o.jsxs("div",{children:[o.jsx("h3",{children:"ðŸ“Œ ç¤ºä¾‹ 4: è‡ªå®šä¹‰æŒ‰é’®æ ·å¼"}),o.jsx("p",{style:{color:"#666",marginBottom:"16px"},children:"å³ä¸‹è§’çš„çº¢è‰²æ–¹å½¢ä¸‹è½½æŒ‰é’®"}),o.jsx("div",{style:{maxWidth:"500px"},children:o.jsx(h,{src:"https://picsum.photos/id/1020/500/300",alt:"è‡ªå®šä¹‰æ ·å¼",imageStyle:{width:"100%",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"}})})]}),o.jsxs("div",{children:[o.jsx("h3",{children:"ðŸ“Œ ç¤ºä¾‹ 5: ä¸‹è½½ç”Ÿå‘½å‘¨æœŸå›žè°ƒ"}),o.jsx("p",{style:{color:"#666",marginBottom:"16px"},children:"ä¸‹è½½å‰åŽä¼šè§¦å‘å›žè°ƒå‡½æ•°ï¼Œå¯ç”¨äºŽæƒé™æ£€æŸ¥ã€ç»Ÿè®¡ä¸ŠæŠ¥ç­‰"}),o.jsx("div",{style:{padding:"12px",backgroundColor:"#e7f3ff",borderRadius:"4px",marginBottom:"16px",fontSize:"14px"},children:"ðŸ’¡ æ‰“å¼€æµè§ˆå™¨æŽ§åˆ¶å°æŸ¥çœ‹å›žè°ƒæ—¥å¿—"}),o.jsx("div",{style:{maxWidth:"500px"},children:o.jsx(p,{src:"https://picsum.photos/id/1021/500/300",alt:"å›žè°ƒä¸‹è½½",imageStyle:{width:"100%",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"}})})]}),o.jsxs("div",{children:[o.jsx("h3",{children:"ðŸ“Œ ç¤ºä¾‹ 6: è‡ªå®šä¹‰ä¸‹è½½å›¾æ ‡"}),o.jsx("p",{style:{color:"#666",marginBottom:"16px"},children:"ä½¿ç”¨è‡ªå®šä¹‰çš„ä¸‹ç®­å¤´å›¾æ ‡ä»£æ›¿é»˜è®¤å›¾æ ‡"}),o.jsx("div",{style:{maxWidth:"500px"},children:o.jsx(g,{src:"https://picsum.photos/id/1022/500/300",alt:"è‡ªå®šä¹‰å›¾æ ‡",imageStyle:{width:"100%",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"}})})]}),o.jsxs("div",{style:{padding:"20px",backgroundColor:"#e7f3ff",borderRadius:"8px",borderLeft:"4px solid #0066cc"},children:[o.jsx("h3",{style:{marginTop:0,color:"#0066cc"},children:"ðŸ’¡ åº”ç”¨åœºæ™¯"}),o.jsxs("ul",{style:{marginBottom:0,lineHeight:1.8},children:[o.jsxs("li",{children:["ðŸ“· ",o.jsx("strong",{children:"å›¾ç‰‡ç½‘ç«™"})," - ç”¨æˆ·ä¸‹è½½é«˜æ¸…å›¾ç‰‡"]}),o.jsxs("li",{children:["ðŸŽ¨ ",o.jsx("strong",{children:"è®¾è®¡å¹³å°"})," - ä¸‹è½½è®¾è®¡ä½œå“"]}),o.jsxs("li",{children:["ðŸ“° ",o.jsx("strong",{children:"æ–°é—»åª’ä½“"})," - ä¸‹è½½æ–°é—»å›¾ç‰‡"]}),o.jsxs("li",{children:["ðŸ›ï¸ ",o.jsx("strong",{children:"ç”µå•†å¹³å°"})," - ä¸‹è½½å•†å“å›¾ç‰‡"]}),o.jsxs("li",{children:["ðŸ“š ",o.jsx("strong",{children:"åœ¨çº¿æ•™è‚²"})," - ä¸‹è½½æ•™å­¦èµ„æ–™å›¾ç‰‡"]}),o.jsxs("li",{children:["ðŸ¢ ",o.jsx("strong",{children:"ä¼ä¸šå®˜ç½‘"})," - ä¸‹è½½äº§å“æ‰‹å†Œã€å®£ä¼ å›¾"]})]})]}),o.jsxs("div",{children:[o.jsx("h3",{children:"ðŸ“š é…ç½®é¡¹è¯´æ˜Ž"}),o.jsx("div",{style:{backgroundColor:"#f5f5f5",padding:"16px",borderRadius:"8px",fontFamily:"monospace",fontSize:"14px",overflowX:"auto"},children:o.jsx("pre",{style:{margin:0},children:`interface DownloadButtonConfig {
  filename?: string;                   // ä¸‹è½½æ–‡ä»¶åï¼ˆé»˜è®¤ä»ŽURLæå–ï¼‰
  position?: string;                   // 'top-left' | 'top-right' |
                                       // 'bottom-left' | 'bottom-right'
  size?: string;                       // 'small' | 'medium' | 'large'
  buttonStyle?: CSSProperties;         // è‡ªå®šä¹‰æŒ‰é’®æ ·å¼
  showOnHover?: boolean;               // ä»…æ‚¬åœæ—¶æ˜¾ç¤ºï¼ˆé»˜è®¤falseï¼‰
  onBeforeDownload?: (src) => void;    // ä¸‹è½½å‰å›žè°ƒ
  onDownloadSuccess?: (name) => void;  // ä¸‹è½½æˆåŠŸå›žè°ƒ
  onDownloadError?: (error) => void;   // ä¸‹è½½å¤±è´¥å›žè°ƒ
  customIcon?: ReactNode;              // è‡ªå®šä¹‰å›¾æ ‡
  showTooltip?: boolean;               // æ˜¾ç¤ºæç¤ºæ–‡æœ¬ï¼ˆé»˜è®¤trueï¼‰
  tooltipText?: string;                // æç¤ºæ–‡æœ¬ï¼ˆé»˜è®¤"ä¸‹è½½å›¾ç‰‡"ï¼‰
}`})})]}),o.jsxs("div",{style:{padding:"20px",backgroundColor:"#fff3cd",borderRadius:"8px",borderLeft:"4px solid #ffc107"},children:[o.jsx("h3",{style:{marginTop:0,color:"#856404"},children:"âš ï¸ ä½¿ç”¨æç¤º"}),o.jsxs("ul",{style:{marginBottom:0,lineHeight:1.8,color:"#856404"},children:[o.jsx("li",{children:"ä¸‹è½½éœ€è¦å›¾ç‰‡URLæ”¯æŒCORSï¼Œå¦åˆ™å¯èƒ½å¤±è´¥"}),o.jsx("li",{children:"è·¨åŸŸå›¾ç‰‡éœ€è¦æœåŠ¡å™¨è®¾ç½® Access-Control-Allow-Origin"}),o.jsx("li",{children:"filename åº”åŒ…å«åˆé€‚çš„æ–‡ä»¶æ‰©å±•åï¼ˆ.jpg, .pngç­‰ï¼‰"}),o.jsx("li",{children:"å¤§æ–‡ä»¶ä¸‹è½½æ—¶ä¼šæœ‰çŸ­æš‚å»¶è¿Ÿï¼Œå»ºè®®æ˜¾ç¤ºåŠ è½½çŠ¶æ€"}),o.jsx("li",{children:"ç§»åŠ¨ç«¯ä¸‹è½½ä½“éªŒå¯èƒ½å› æµè§ˆå™¨è€Œå¼‚"}),o.jsx("li",{children:"å¯ä»¥åœ¨ onBeforeDownload ä¸­è¿›è¡Œæƒé™æ£€æŸ¥"})]})]}),o.jsxs("div",{style:{padding:"20px",backgroundColor:"#d1ecf1",borderRadius:"8px",borderLeft:"4px solid #17a2b8"},children:[o.jsx("h3",{style:{marginTop:0,color:"#0c5460"},children:"ðŸš€ é«˜çº§ç”¨æ³•"}),o.jsxs("div",{style:{color:"#0c5460",lineHeight:1.8},children:[o.jsx("p",{children:o.jsx("strong",{children:"1. æƒé™æŽ§åˆ¶ï¼š"})}),o.jsx("pre",{style:{backgroundColor:"#f5f5f5",padding:"12px",borderRadius:"4px",overflowX:"auto",color:"#333"},children:`onBeforeDownload: async (src) => {
  const hasPermission = await checkUserPermission();
  if (!hasPermission) {
    throw new Error('éœ€è¦ä¼šå‘˜æƒé™');
  }
}`}),o.jsx("p",{style:{marginTop:"16px"},children:o.jsx("strong",{children:"2. ä¸‹è½½ç»Ÿè®¡ï¼š"})}),o.jsx("pre",{style:{backgroundColor:"#f5f5f5",padding:"12px",borderRadius:"4px",overflowX:"auto",color:"#333"},children:`onDownloadSuccess: (filename) => {
  // ä¸ŠæŠ¥ä¸‹è½½ç»Ÿè®¡
  analytics.track('image_download', {
    filename,
    timestamp: Date.now()
  });
}`})]})]})]})})};export{$ as default};
