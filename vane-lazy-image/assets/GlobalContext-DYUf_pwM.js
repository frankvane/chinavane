var a=Object.defineProperty;var w=(i,e,t)=>e in i?a(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var r=(i,e,t)=>w(i,typeof e!="symbol"?e+"":e,t);const n=class n{constructor(){r(this,"networkInfo");r(this,"deviceInfo");r(this,"listeners",new Set);this.initListeners()}static getInstance(){return n.instance||(n.instance=new n),n.instance}initListeners(){if(typeof window>"u")return;const e=typeof navigator<"u"?navigator:void 0,t=(e==null?void 0:e.connection)||(e==null?void 0:e.mozConnection)||(e==null?void 0:e.webkitConnection);t&&t.addEventListener("change",()=>{this.networkInfo=void 0,this.notifyListeners()});let s;const o=()=>{s&&clearTimeout(s),s=window.setTimeout(()=>{this.deviceInfo=void 0,this.notifyListeners()},300)};window.addEventListener("resize",o)}getNetworkInfo(){return this.networkInfo||(this.networkInfo=this.detectNetwork()),this.networkInfo}getDeviceInfo(){return this.deviceInfo||(this.deviceInfo=this.detectDevice()),this.deviceInfo}detectNetwork(){const e=typeof navigator<"u"?navigator:void 0,t=(e==null?void 0:e.connection)||(e==null?void 0:e.mozConnection)||(e==null?void 0:e.webkitConnection);if(t)return{effectiveType:t.effectiveType||"4g",downlink:Number(t.downlink||10),rtt:Number(t.rtt||50),saveData:!!t.saveData}}detectDevice(){const e=typeof window<"u"?window.innerWidth:1024,t=typeof window<"u"?window.innerHeight:768,s=typeof window<"u"&&window.devicePixelRatio||1,o=typeof navigator<"u"&&navigator.userAgent||"",f=/Mobile|Android|iPhone|iPad/i.test(o);return{type:/iPad|Tablet/i.test(o)?"tablet":f?"mobile":"desktop",os:o,browser:o,devicePixelRatio:s,viewportWidth:e,viewportHeight:t}}addListener(e){return this.listeners.add(e),()=>this.listeners.delete(e)}notifyListeners(){this.listeners.forEach(e=>{try{e()}catch(t){console.error("[GlobalContext] Listener error:",t)}})}refreshNetworkInfo(){this.networkInfo=void 0,this.networkInfo=this.detectNetwork(),this.notifyListeners()}refreshDeviceInfo(){this.deviceInfo=void 0,this.deviceInfo=this.detectDevice(),this.notifyListeners()}getStats(){return{listenersCount:this.listeners.size,hasNetworkInfo:!!this.networkInfo,hasDeviceInfo:!!this.deviceInfo}}};r(n,"instance");let d=n;const c=d.getInstance(),I=()=>c.getNetworkInfo(),u=()=>c.getDeviceInfo(),g=i=>c.addListener(i),k=()=>c.getStats();export{u as a,k as b,g as c,I as g};
