import{j as s}from"./index-CAgh_i44.js";import{D as u}from"./DemoPage-DDy1Lp2W.js";import{w as p}from"./index-BUiUrMm6.js";import{L as g}from"./LazyLoadImageCore-BXC5ZDAL.js";import"./tomorrow-gtxudeWU.js";import"./GlobalContext-DYUf_pwM.js";function m(a,n){try{const t=new URL(a,typeof window<"u"?window.location.origin:"http://localhost"),e=new URL(n);return t.protocol=e.protocol,t.hostname=e.hostname,t.port=e.port,t.toString()}catch{return a}}function f(a){const n=a.cdnBases||[];return{name:"cdn-fallback",version:"1.0.0",config:a,hooks:{transformProps:t=>{var o;if(!n.length)return t;const e={...t};try{const r=Number(((o=e._sharedData)==null?void 0:o.get("cdn-index"))??0)}catch{}return e},onLoadError:t=>{var c,d,l;if(!n.length)return!0;const e="cdn-index",r=(Number(((c=t.sharedData)==null?void 0:c.get(e))??0)+1)%n.length;(d=t.sharedData)==null||d.set(e,r);const i=(l=t.imageRef)==null?void 0:l.current;if(i){const h=m(t.src,n[r]);try{i.src=`${h}${h.includes("?")?"&":"?"}cdnFallback=${Date.now()}`}catch{}}return!0},onLoad:t=>{var r;if(!n.length)return;const e=Number(((r=t.sharedData)==null?void 0:r.get("cdn-index"))??0);return m(t.src,n[e])}}}}const w=p(g,[f({cdnBases:["https://invalid.example.com","https://picsum.photos"]})]);function N(){return s.jsx(u,{title:"CDNFallback 插件示例",description:"当主 CDN 加载失败时自动切换到备用 CDN。",children:s.jsx("div",{style:{width:480,height:300,maxWidth:"100%"},children:s.jsx(w,{src:"https://picsum.photos/seed/cdn-fallback-demo/800/600",loading:"lazy",containerStyle:{width:"100%",height:"100%"},imageStyle:{width:"100%",height:"100%",objectFit:"cover"}})})})}export{N as default};
