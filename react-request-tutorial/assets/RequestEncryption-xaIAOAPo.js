var V=Object.defineProperty;var U=(m,t,a)=>t in m?V(m,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):m[t]=a;var C=(m,t,a)=>U(m,typeof t!="symbol"?t+"":t,a);import{r as u,j as e}from"./index-C7SuDyTR.js";import{C as W}from"./ComponentTemplate-BzrYXZsv.js";class P{constructor(){C(this,"publicKey",null);C(this,"privateKey",null);C(this,"symmetricKey",null);this.initializeKeys()}async initializeKeys(){try{const t=await crypto.subtle.generateKey({name:"RSA-OAEP",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:"SHA-256"},!0,["encrypt","decrypt"]);this.publicKey=t.publicKey,this.privateKey=t.privateKey,this.symmetricKey=await crypto.subtle.generateKey({name:"AES-GCM",length:256},!0,["encrypt","decrypt"])}catch(t){console.error("密钥初始化失败:",t)}}async encryptWithRSA(t){try{this.publicKey||await this.initializeKeys();const c=new TextEncoder().encode(t),l=await crypto.subtle.encrypt({name:"RSA-OAEP"},this.publicKey,c);return{encrypted:Array.from(new Uint8Array(l)).map(r=>r.toString(16).padStart(2,"0")).join(""),success:!0}}catch(a){return console.error("RSA加密失败:",a),{encrypted:"",success:!1}}}async decryptWithRSA(t){try{this.privateKey||await this.initializeKeys();const a=new Uint8Array(t.match(/.{1,2}/g).map(r=>parseInt(r,16))),c=await crypto.subtle.decrypt({name:"RSA-OAEP"},this.privateKey,a);return{decrypted:new TextDecoder().decode(c),success:!0}}catch(a){return console.error("RSA解密失败:",a),{decrypted:"",success:!1}}}async encryptWithAES(t){try{this.symmetricKey||await this.initializeKeys();const c=new TextEncoder().encode(t),l=crypto.getRandomValues(new Uint8Array(12)),r=await crypto.subtle.encrypt({name:"AES-GCM",iv:l},this.symmetricKey,c);return{encrypted:Array.from(new Uint8Array(r)).map(y=>y.toString(16).padStart(2,"0")).join(""),iv:Array.from(l).map(y=>y.toString(16).padStart(2,"0")).join(""),success:!0}}catch(a){return console.error("AES加密失败:",a),{encrypted:"",iv:"",success:!1}}}async decryptWithAES(t,a){try{this.symmetricKey||await this.initializeKeys();const c=new Uint8Array(t.match(/.{1,2}/g).map(d=>parseInt(d,16))),l=new Uint8Array(a.match(/.{1,2}/g).map(d=>parseInt(d,16))),r=await crypto.subtle.decrypt({name:"AES-GCM",iv:l},this.symmetricKey,c);return{decrypted:new TextDecoder().decode(r),success:!0}}catch(c){return console.error("AES解密失败:",c),{decrypted:"",success:!1}}}async hybridEncrypt(t){try{const a=await crypto.subtle.generateKey({name:"AES-GCM",length:256},!0,["encrypt","decrypt"]),l=new TextEncoder().encode(t),r=crypto.getRandomValues(new Uint8Array(12)),y=await crypto.subtle.encrypt({name:"AES-GCM",iv:r},a,l),d=await crypto.subtle.exportKey("raw",a),x=await crypto.subtle.encrypt({name:"RSA-OAEP"},this.publicKey,d);return{encryptedData:Array.from(new Uint8Array(y)).map(p=>p.toString(16).padStart(2,"0")).join(""),encryptedKey:Array.from(new Uint8Array(x)).map(p=>p.toString(16).padStart(2,"0")).join(""),iv:Array.from(r).map(p=>p.toString(16).padStart(2,"0")).join(""),success:!0}}catch(a){return console.error("混合加密失败:",a),{encryptedData:"",encryptedKey:"",iv:"",success:!1}}}async hybridDecrypt(t,a,c){try{const l=new Uint8Array(a.match(/.{1,2}/g).map(h=>parseInt(h,16))),r=await crypto.subtle.decrypt({name:"RSA-OAEP"},this.privateKey,l),y=await crypto.subtle.importKey("raw",r,{name:"AES-GCM"},!1,["decrypt"]),d=new Uint8Array(t.match(/.{1,2}/g).map(h=>parseInt(h,16))),x=new Uint8Array(c.match(/.{1,2}/g).map(h=>parseInt(h,16))),p=await crypto.subtle.decrypt({name:"AES-GCM",iv:x},y,d);return{decrypted:new TextDecoder().decode(p),success:!0}}catch(l){return console.error("混合解密失败:",l),{decrypted:"",success:!1}}}}const $=()=>{const[m]=u.useState(()=>new P),[t,a]=u.useState("Hello, World! 这是一个测试消息。"),[c,l]=u.useState("aes"),[r,y]=u.useState(null),[d,x]=u.useState(null),[p,g]=u.useState(!1),h=async()=>{g(!0);try{if(c==="rsa"){const i=await m.encryptWithRSA(t);y(i)}else{const i=await m.encryptWithAES(t);y(i)}}catch(i){console.error("加密失败:",i)}finally{g(!1)}},S=async()=>{if(!(!r||!r.success)){g(!0);try{if(c==="rsa"){const i=await m.decryptWithRSA(r.encrypted);x(i)}else{const i=await m.decryptWithAES(r.encrypted,r.iv);x(i)}}catch(i){console.error("解密失败:",i)}finally{g(!1)}}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"基础加密演示"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"输入文本"}),e.jsx("textarea",{value:t,onChange:i=>a(i.target.value),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3,placeholder:"请输入要加密的文本"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"加密算法"}),e.jsxs("select",{value:c,onChange:i=>l(i.target.value),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"aes",children:"AES-256-GCM (对称加密)"}),e.jsx("option",{value:"rsa",children:"RSA-OAEP (非对称加密)"})]})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("button",{onClick:h,disabled:p||!t.trim(),className:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:p?"加密中...":"加密"}),e.jsx("button",{onClick:S,disabled:p||!(r!=null&&r.success),className:"px-6 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:p?"解密中...":"解密"})]})]})]}),r&&e.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg border",children:[e.jsx("h4",{className:"text-md font-semibold mb-3",children:"加密结果"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"状态"}),e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${r.success?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:r.success?"加密成功":"加密失败"})]}),r.success&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"加密数据 (Hex)"}),e.jsx("div",{className:"p-3 bg-white border rounded-md font-mono text-sm break-all",children:r.encrypted})]}),r.iv&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"初始化向量 (IV)"}),e.jsx("div",{className:"p-3 bg-white border rounded-md font-mono text-sm break-all",children:r.iv})]})]})]})]}),d&&e.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg border",children:[e.jsx("h4",{className:"text-md font-semibold mb-3",children:"解密结果"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"状态"}),e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${d.success?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:d.success?"解密成功":"解密失败"})]}),d.success&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"解密文本"}),e.jsx("div",{className:"p-3 bg-white border rounded-md",children:d.decrypted})]})]})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[e.jsx("h4",{className:"text-sm font-semibold text-blue-800 mb-2",children:"算法说明"}),e.jsx("div",{className:"text-sm text-blue-700 space-y-1",children:c==="aes"?e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"• AES-256-GCM: 对称加密算法，加密和解密使用相同密钥"}),e.jsx("p",{children:"• 适用于大量数据加密，性能优秀"}),e.jsx("p",{children:"• 需要安全传输密钥和初始化向量(IV)"})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"• RSA-OAEP: 非对称加密算法，使用公钥加密，私钥解密"}),e.jsx("p",{children:"• 适用于小量数据和密钥交换"}),e.jsx("p",{children:"• 无需预共享密钥，但性能较慢"})]})})]})]})},q=()=>{const[m]=u.useState(()=>new P),[t,a]=u.useState(1e3),[c,l]=u.useState([]),[r,y]=u.useState(!1),[d,x]=u.useState(""),p=n=>{const b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789中文测试数据";let j="";for(let T=0;T<n;T++)j+=b.charAt(Math.floor(Math.random()*b.length));return j},g=async()=>{y(!0),l([]);const n=p(t),b=[];try{x("AES-256-GCM");const j=performance.now(),T=performance.now(),R=await m.encryptWithAES(n),K=performance.now()-T;if(R.success){const w=performance.now(),f=await m.decryptWithAES(R.encrypted,R.iv),v=performance.now()-w,E=performance.now()-j;b.push({algorithm:"AES-256-GCM",dataSize:t,encryptTime:K,decryptTime:v,totalTime:E,success:f.success})}if(t<=200){x("RSA-OAEP");const w=performance.now(),f=performance.now(),v=await m.encryptWithRSA(n),E=performance.now()-f;if(v.success){const k=performance.now(),D=await m.decryptWithRSA(v.encrypted),I=performance.now()-k,M=performance.now()-w;b.push({algorithm:"RSA-OAEP",dataSize:t,encryptTime:E,decryptTime:I,totalTime:M,success:D.success})}}x("混合加密 (RSA + AES)");const s=performance.now(),o=performance.now(),A=await m.hybridEncrypt(n),N=performance.now()-o;if(A.success){const w=performance.now(),f=await m.hybridDecrypt(A.encryptedData,A.encryptedKey,A.iv),v=performance.now()-w,E=performance.now()-s;b.push({algorithm:"混合加密 (RSA + AES)",dataSize:t,encryptTime:N,decryptTime:v,totalTime:E,success:f.success})}l(b)}catch(j){console.error("性能测试失败:",j)}finally{y(!1),x("")}},h=n=>n<1?`${(n*1e3).toFixed(2)} μs`:n<1e3?`${n.toFixed(2)} ms`:`${(n/1e3).toFixed(2)} s`,S=(n,b)=>{const j=n/b;return j<.3?"text-green-600":j<.7?"text-yellow-600":"text-red-600"},i=Math.max(...c.map(n=>n.totalTime));return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"加密算法性能对比"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"测试数据大小 (字符数)"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("input",{type:"range",min:"100",max:"10000",step:"100",value:t,onChange:n=>a(Number(n.target.value)),className:"flex-1"}),e.jsxs("span",{className:"text-sm font-medium text-gray-600 min-w-[80px]",children:[t," 字符"]})]}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"注意：RSA加密仅支持小于200字符的数据"})]}),e.jsx("button",{onClick:g,disabled:r,className:"w-full px-6 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:r?`正在测试: ${d}`:"开始性能测试"})]})]}),c.length>0&&e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[e.jsx("h4",{className:"text-md font-semibold mb-4",children:"测试结果"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left py-2 px-3 font-medium text-gray-700",children:"算法"}),e.jsx("th",{className:"text-left py-2 px-3 font-medium text-gray-700",children:"数据大小"}),e.jsx("th",{className:"text-left py-2 px-3 font-medium text-gray-700",children:"加密时间"}),e.jsx("th",{className:"text-left py-2 px-3 font-medium text-gray-700",children:"解密时间"}),e.jsx("th",{className:"text-left py-2 px-3 font-medium text-gray-700",children:"总时间"}),e.jsx("th",{className:"text-left py-2 px-3 font-medium text-gray-700",children:"状态"})]})}),e.jsx("tbody",{children:c.map((n,b)=>e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"py-2 px-3 font-medium",children:n.algorithm}),e.jsxs("td",{className:"py-2 px-3",children:[n.dataSize," 字符"]}),e.jsx("td",{className:`py-2 px-3 font-mono ${S(n.encryptTime,i)}`,children:h(n.encryptTime)}),e.jsx("td",{className:`py-2 px-3 font-mono ${S(n.decryptTime,i)}`,children:h(n.decryptTime)}),e.jsx("td",{className:`py-2 px-3 font-mono font-semibold ${S(n.totalTime,i)}`,children:h(n.totalTime)}),e.jsx("td",{className:"py-2 px-3",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${n.success?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:n.success?"成功":"失败"})})]},b))})]})})]}),e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200",children:[e.jsx("h4",{className:"text-sm font-semibold text-yellow-800 mb-2",children:"性能分析"}),e.jsxs("div",{className:"text-sm text-yellow-700 space-y-1",children:[e.jsxs("p",{children:["• ",e.jsx("strong",{children:"AES-256-GCM"}),": 对称加密，性能最佳，适合大数据量"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"RSA-OAEP"}),": 非对称加密，性能较慢，仅适合小数据量（<200字符）"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"混合加密"}),": 结合两者优势，适合需要密钥交换的场景"]}),e.jsx("p",{children:"• 实际应用中应根据数据大小和安全需求选择合适的算法"})]})]})]})},z=()=>{const[m]=u.useState(()=>new P),[t,a]=u.useState("payment"),[c,l]=u.useState(!1),[r,y]=u.useState([]),[d,x]=u.useState({cardNumber:"4532-1234-5678-9012",expiryDate:"12/25",cvv:"123",amount:299.99,currency:"USD"}),[p,g]=u.useState({ssn:"123-45-6789",phone:"+1-555-0123",email:"user@example.com",address:"123 Main St, City, State 12345"}),[h,S]=u.useState({recipient:"john.doe@example.com",subject:"机密文档",content:"这是一份包含敏感信息的机密文档内容..."}),i=async(s,o)=>{l(!0);const A=performance.now();try{const N=`req_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,w=JSON.stringify(s),f=await m.hybridEncrypt(w);if(f.success){const v={encryptedData:f.encryptedData,encryptedKey:f.encryptedKey,iv:f.iv,timestamp:Date.now(),requestId:N};await new Promise(D=>setTimeout(D,500+Math.random()*1e3));const E=performance.now()-A,k={id:N,timestamp:Date.now(),type:o,status:"success",encryptionTime:E,dataSize:w.length};return y(D=>[k,...D.slice(0,9)]),{success:!0,requestId:N,encryptedRequest:v}}else throw new Error("加密失败")}catch(N){const w=performance.now()-A,f={id:`failed_${Date.now()}`,timestamp:Date.now(),type:o,status:"failed",encryptionTime:w,dataSize:JSON.stringify(s).length};return y(v=>[f,...v.slice(0,9)]),{success:!1,error:N instanceof Error?N.message:"Unknown error"}}finally{l(!1)}},n=()=>{i(d,"payment")},b=()=>{i(p,"profile")},j=()=>{i(h,"message")},T=s=>`${s.toFixed(2)} ms`,R=s=>{switch(s){case"payment":return"💳";case"profile":return"👤";case"message":return"📧";default:return"📄"}},K=s=>{switch(s){case"payment":return"支付请求";case"profile":return"资料更新";case"message":return"私密消息";default:return"未知类型"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"真实场景加密演示"}),e.jsxs("div",{className:"flex space-x-1 mb-6 bg-gray-100 p-1 rounded-lg",children:[e.jsx("button",{onClick:()=>a("payment"),className:`flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors ${t==="payment"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-800"}`,children:"💳 支付加密"}),e.jsx("button",{onClick:()=>a("profile"),className:`flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors ${t==="profile"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-800"}`,children:"👤 资料加密"}),e.jsx("button",{onClick:()=>a("message"),className:`flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors ${t==="message"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-800"}`,children:"📧 消息加密"})]}),t==="payment"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium text-gray-800",children:"信用卡支付信息"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"卡号"}),e.jsx("input",{type:"text",value:d.cardNumber,onChange:s=>x(o=>({...o,cardNumber:s.target.value})),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"有效期"}),e.jsx("input",{type:"text",value:d.expiryDate,onChange:s=>x(o=>({...o,expiryDate:s.target.value})),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"CVV"}),e.jsx("input",{type:"text",value:d.cvv,onChange:s=>x(o=>({...o,cvv:s.target.value})),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"金额"}),e.jsx("input",{type:"number",value:d.amount,onChange:s=>x(o=>({...o,amount:Number(s.target.value)})),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsx("button",{onClick:n,disabled:c,className:"w-full px-6 py-3 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:c?"处理中...":"发送加密支付请求"})]}),t==="profile"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium text-gray-800",children:"敏感个人资料"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"社会安全号码"}),e.jsx("input",{type:"text",value:p.ssn,onChange:s=>g(o=>({...o,ssn:s.target.value})),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"电话号码"}),e.jsx("input",{type:"text",value:p.phone,onChange:s=>g(o=>({...o,phone:s.target.value})),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"邮箱地址"}),e.jsx("input",{type:"email",value:p.email,onChange:s=>g(o=>({...o,email:s.target.value})),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"家庭地址"}),e.jsx("input",{type:"text",value:p.address,onChange:s=>g(o=>({...o,address:s.target.value})),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsx("button",{onClick:b,disabled:c,className:"w-full px-6 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:c?"处理中...":"发送加密资料更新"})]}),t==="message"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium text-gray-800",children:"私密消息"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"收件人"}),e.jsx("input",{type:"email",value:h.recipient,onChange:s=>S(o=>({...o,recipient:s.target.value})),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"主题"}),e.jsx("input",{type:"text",value:h.subject,onChange:s=>S(o=>({...o,subject:s.target.value})),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"消息内容"}),e.jsx("textarea",{value:h.content,onChange:s=>S(o=>({...o,content:s.target.value})),rows:4,className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsx("button",{onClick:j,disabled:c,className:"w-full px-6 py-3 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed",children:c?"处理中...":"发送加密消息"})]})]}),r.length>0&&e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[e.jsx("h4",{className:"text-md font-semibold mb-4",children:"加密请求日志"}),e.jsx("div",{className:"space-y-3",children:r.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-lg",children:R(s.type)}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-800",children:K(s.type)}),e.jsx("div",{className:"text-sm text-gray-500",children:new Date(s.timestamp).toLocaleTimeString()})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:s.dataSize})," 字节"]}),e.jsx("div",{className:"text-sm text-gray-600",children:T(s.encryptionTime)}),e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${s.status==="success"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.status==="success"?"成功":"失败"})]})]},s.id))})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[e.jsx("h4",{className:"text-sm font-semibold text-green-800 mb-2",children:"安全提示"}),e.jsxs("div",{className:"text-sm text-green-700 space-y-1",children:[e.jsx("p",{children:"• 所有敏感数据都使用混合加密（RSA + AES）进行端到端加密"}),e.jsx("p",{children:"• 每次请求都生成新的AES密钥和初始化向量，确保前向安全性"}),e.jsx("p",{children:"• 加密密钥通过RSA公钥加密传输，只有服务器私钥能解密"}),e.jsx("p",{children:"• 实际生产环境中应配合HTTPS、证书固定等额外安全措施"})]})]})]})},L=()=>e.jsx(W,{title:"请求加密",description:"学习如何在HTTP请求中实现数据加密，保护敏感信息在传输过程中的安全性，包括对称加密、非对称加密和混合加密等方案。",overview:[{title:"核心概念",items:["对称加密：使用相同密钥进行加密和解密，常见算法如 AES。","非对称加密：使用公钥加密、私钥解密，常见算法如 RSA。","混合加密：结合对称和非对称加密，兼顾安全性和性能。","初始化向量(IV)：确保相同明文每次加密结果不同，提高安全性。"]},{title:"主要优势",items:["保护敏感数据在传输过程中的安全性","防止中间人攻击和数据泄露","满足合规和隐私保护要求","支持多种加密场景和算法灵活切换"]},{title:"适用场景",items:["支付、个人信息等敏感数据的传输","API 通信加密，防止数据被窃听","前后端分离架构下的数据保护","需要满足法规要求的数据加密场景"]},{title:"注意事项",items:["密钥和 IV 必须安全存储，避免泄露","不要在客户端存储敏感密钥","加密算法和密钥长度需符合安全标准","定期轮换密钥，防止长期被破解"]}],examples:[{title:"基础加密演示",component:e.jsx($,{}),description:"演示RSA、AES和混合加密的基本使用方法",observationPoints:["观察不同加密算法的加密结果格式","注意RSA加密有数据长度限制","AES加密需要初始化向量(IV)","混合加密结合了两种算法的优势"],keyPoints:["RSA适合小数据量，有长度限制","AES适合大数据量，性能优秀","混合加密兼顾安全性和性能","密钥和IV的安全管理至关重要"],commonTraps:["RSA加密数据过长导致失败","AES密钥或IV泄露导致安全风险","忘记处理加密解密异常","在客户端存储敏感密钥"],solutions:["大数据使用AES或混合加密","密钥通过安全通道传输","添加完整的错误处理机制","密钥存储在安全环境中"],importantTips:["选择合适的加密算法很重要","密钥管理是加密系统的核心","加密会影响性能，需要权衡","定期更新密钥提高安全性"]},{title:"性能对比测试",component:e.jsx(q,{}),description:"对比不同加密算法的性能表现",observationPoints:["观察不同算法的加密速度差异","注意数据量对性能的影响","RSA性能随数据量急剧下降","AES性能相对稳定"],keyPoints:["RSA加密速度慢，适合小数据","AES加密速度快，适合大数据","混合加密平衡了安全性和性能","数据量是选择算法的重要因素"],commonTraps:["对大数据使用RSA加密","忽略加密对用户体验的影响","没有根据场景选择合适算法","过度加密影响系统性能"],solutions:["根据数据大小选择算法","使用异步加密避免阻塞UI","建立性能测试基准","优化加密流程和算法参数"],importantTips:["性能测试应在真实环境进行","考虑加密对整体系统的影响","平衡安全性和用户体验","监控加密操作的性能指标"]},{title:"真实场景应用",component:e.jsx(z,{}),description:"模拟支付、个人信息等真实场景的加密应用",observationPoints:["观察不同场景的加密策略","注意敏感数据的处理方式","支付信息使用混合加密","个人资料使用AES加密"],keyPoints:["不同场景需要不同的加密策略","支付数据需要最高级别保护","个人信息加密要考虑性能","加密策略要符合法规要求"],commonTraps:["所有数据使用相同加密方式","忽略法规对加密的要求","加密密钥管理不当","没有考虑数据恢复机制"],solutions:["根据数据敏感度分级加密","遵循相关法规和标准","建立完善的密钥管理体系","设计数据恢复和备份机制"],importantTips:["了解相关法规对加密的要求","建立数据分类和加密标准","定期审计加密实施情况","准备应急响应和恢复方案"]}],tutorial:{concepts:["对称加密：同一密钥加密解密，适合大数据量，性能高。","非对称加密：公钥加密私钥解密，适合密钥交换和小数据量。","混合加密：用非对称加密传输对称密钥，数据用对称加密。","初始化向量(IV)：每次加密都应使用新的随机IV，防止密文分析。"],steps:["选择合适的加密算法（根据数据大小和安全要求）","生成安全的密钥和初始化向量","实现加密函数（处理数据转换和编码）","实现解密函数（确保能正确还原数据）","添加错误处理和安全检查","测试加密解密的正确性和性能"],tips:["使用Web Crypto API确保加密实现的安全性和标准化","密钥长度要符合当前安全标准（AES-256, RSA-2048+）","加密前后要进行数据完整性验证","定期更新加密算法和密钥以应对新的安全威胁"]},interview:{questions:[{question:"什么是对称加密和非对称加密？它们各有什么优缺点？",answer:"对称加密使用相同密钥进行加密解密，优点是速度快、效率高，缺点是密钥分发困难、安全风险高。非对称加密使用公私钥对，优点是密钥分发安全、不需要预共享密钥，缺点是速度慢、计算开销大。"},{question:"什么是混合加密？为什么在实际应用中经常使用？",answer:"混合加密结合了对称和非对称加密的优势，用非对称加密传输对称密钥，用对称加密传输实际数据。这样既解决了密钥分发问题，又保证了加密性能，是实际应用中的最佳选择。"},{question:"初始化向量(IV)的作用是什么？为什么重要？",answer:"IV是加密算法的输入参数，确保相同明文产生不同密文。它防止攻击者通过分析密文模式来推断明文信息，是确保加密安全性的重要机制。每次加密都应使用随机生成的IV。"},{question:"在前端实现加密时需要注意哪些安全问题？",answer:"主要注意：1)不要在客户端存储敏感密钥；2)使用HTTPS确保传输安全；3)使用标准加密库而非自实现；4)正确处理密钥生命周期；5)防止密钥泄露到日志或错误信息中。"},{question:"如何选择合适的加密算法和密钥长度？",answer:"根据数据大小、安全要求和性能需求选择。小数据(<200字节)可用RSA-2048，大数据用AES-256，通用场景用混合加密。密钥长度要符合当前安全标准，定期评估和更新。"}],keyPoints:["理解对称加密、非对称加密和混合加密的原理和应用场景","掌握Web Crypto API的使用方法和最佳实践","了解密钥管理的重要性和实现方法","知道如何根据需求选择合适的加密方案"]},bestPractices:{dos:["使用标准加密库和算法，如 Web Crypto API、AES、RSA 等","每次加密都生成新的随机 IV","密钥和 IV 通过安全通道分发和存储","定期轮换密钥，提升整体安全性","为不同数据类型选择合适的加密方案"],donts:["不要在客户端明文存储密钥或 IV","不要重复使用 IV，避免降低安全性","不要自实现加密算法，避免安全漏洞","不要在日志或前端暴露密钥信息","不要使用过时或弱加密算法"],patterns:["混合加密模式：用 RSA 加密 AES 密钥，AES 加密数据","信封加密模式：主密钥加密数据密钥，数据密钥加密数据","密钥轮换模式：定期更换密钥，支持向前/向后兼容","分层加密模式：不同敏感级别数据采用不同加密强度"]}});export{L as default};
