var M=Object.defineProperty;var D=(o,e,r)=>e in o?M(o,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[e]=r;var x=(o,e,r)=>D(o,typeof e!="symbol"?e+"":e,r);import{r as h,j as t}from"./index-C7SuDyTR.js";import{C as P}from"./ComponentTemplate-BzrYXZsv.js";class F{constructor(e={}){x(this,"config");x(this,"entries",[]);x(this,"buffer",[]);x(this,"flushTimer");x(this,"listeners",new Set);x(this,"stats");x(this,"levelPriority",{debug:0,info:1,warn:2,error:3,fatal:4});this.config={enabled:!0,level:"info",maxEntries:1e3,bufferSize:50,flushInterval:5e3,includeStack:!1,includeMetadata:!0,sensitiveFields:["password","token","secret","key"],formatters:[],transports:[],filters:[],...e},this.stats=this.initializeStats(),this.config.formatters.length===0&&this.config.formatters.push(this.createDefaultFormatter()),this.config.transports.length===0&&this.config.transports.push(this.createConsoleTransport()),this.startFlushTimer()}debug(e,r,s="general"){this.log("debug",e,r,s)}info(e,r,s="general"){this.log("info",e,r,s)}warn(e,r,s="general"){this.log("warn",e,r,s)}error(e,r,s,i="general"){this.log("error",e,{...s,error:r},i)}fatal(e,r,s,i="general"){this.log("fatal",e,{...s,error:r},i)}logRequestStart(e,r,s,i){this.info(`Request started: ${s} ${r}`,{...i,requestId:e,url:r,method:s,phase:"start"},"request")}logRequestSuccess(e,r,s,i,n,d){this.info(`Request completed: ${s} ${r} - ${i} (${n}ms)`,{...d,requestId:e,url:r,method:s,statusCode:i,duration:n,phase:"success"},"request")}logRequestError(e,r,s,i,n,d){this.error(`Request failed: ${s} ${r}`,i,{...d,requestId:e,url:r,method:s,duration:n,phase:"error"},"request")}logRequestRetry(e,r,s,i,n,d){this.warn(`Request retry ${i}: ${s} ${r} - ${n}`,{...d,requestId:e,url:r,method:s,retryCount:i,reason:n,phase:"retry"},"request")}logCacheOperation(e,r,s){this.debug(`Cache ${e}: ${r}`,{...s,operation:e,key:r},"cache")}logPerformance(e,r,s="ms",i){this.info(`Performance metric: ${e} = ${r}${s}`,{...i,metric:e,value:r,unit:s},"performance")}logSecurity(e,r,s){const i={low:"info",medium:"warn",high:"error",critical:"fatal"}[r];this.log(i,`Security event: ${e}`,{...s,event:e,severity:r},"security")}log(e,r,s,i="general"){if(!this.config.enabled||!this.shouldLog(e))return;const n={id:this.generateId(),timestamp:Date.now(),level:e,message:r,category:i,...this.extractRequestInfo(s),...this.extractTraceInfo(s),tags:this.extractTags(s),metadata:this.config.includeMetadata?this.sanitizeMetadata(s):void 0};this.applyFilters(n)&&this.addEntry(n)}addEntry(e){this.buffer.push(e),this.updateStats(e),this.buffer.length>=this.config.bufferSize&&this.flush()}async flush(){if(this.buffer.length===0)return;const e=[...this.buffer];this.buffer=[],this.entries.push(...e),this.entries.length>this.config.maxEntries&&(this.entries=this.entries.slice(-this.config.maxEntries)),this.notifyListeners(e),await this.sendToTransports(e)}async sendToTransports(e){const r=this.config.transports.filter(s=>s.enabled).map(async s=>{try{const i=e.filter(n=>this.levelPriority[n.level]>=this.levelPriority[s.level]);i.length>0&&await s.send(i)}catch(i){console.error(`Transport ${s.name} failed:`,i)}});await Promise.allSettled(r)}shouldLog(e){return this.levelPriority[e]>=this.levelPriority[this.config.level]}applyFilters(e){return this.config.filters.every(r=>r.filter(e))}extractRequestInfo(e){return e?{requestId:e.requestId,url:e.url,method:e.method,statusCode:e.statusCode,duration:e.duration,userId:e.userId,sessionId:e.sessionId}:{}}extractTraceInfo(e){return e?{traceId:e.traceId,spanId:e.spanId}:{}}extractTags(e){return e==null?void 0:e.tags}sanitizeMetadata(e){if(!e)return;const r={...e};for(const s of this.config.sensitiveFields)s in r&&(r[s]="[REDACTED]");return r}updateStats(e){if(this.stats.total++,this.stats.byLevel[e.level]=(this.stats.byLevel[e.level]||0)+1,this.stats.byCategory[e.category]=(this.stats.byCategory[e.category]||0)+1,(e.level==="error"||e.level==="fatal")&&(this.stats.recentErrors.push(e),this.stats.recentErrors.length>10&&(this.stats.recentErrors=this.stats.recentErrors.slice(-10))),this.stats.errorRate=((this.stats.byLevel.error||0)+(this.stats.byLevel.fatal||0))/this.stats.total*100,e.duration){const n=this.entries.filter(l=>l.duration).reduce((l,g)=>l+(g.duration||0),0)+e.duration,d=this.entries.filter(l=>l.duration).length+1;this.stats.avgDuration=n/d}this.stats.topCategories=Object.entries(this.stats.byCategory).map(([n,d])=>({category:n,count:d})).sort((n,d)=>d.count-n.count).slice(0,10);const r=Date.now(),s=Math.floor(r/(60*1e3))*(60*1e3),i=this.stats.timeline.find(n=>n.timestamp===s);i?i.count++:(this.stats.timeline.push({timestamp:s,count:1,level:e.level}),this.stats.timeline.length>100&&(this.stats.timeline=this.stats.timeline.slice(-100)))}initializeStats(){return{total:0,byLevel:{debug:0,info:0,warn:0,error:0,fatal:0},byCategory:{},errorRate:0,avgDuration:0,recentErrors:[],topCategories:[],timeline:[]}}startFlushTimer(){this.flushTimer=setInterval(()=>{this.flush()},this.config.flushInterval)}notifyListeners(e){for(const r of this.listeners)try{r(e)}catch(s){console.error("Log listener error:",s)}}generateId(){return`${Date.now()}_${Math.random().toString(36).substr(2,9)}`}createDefaultFormatter(){return{name:"default",format:e=>{const r=new Date(e.timestamp).toISOString(),s=e.level.toUpperCase().padEnd(5),i=e.category.padEnd(12);let n=`[${r}] ${s} [${i}] ${e.message}`;return e.requestId&&(n+=` [${e.requestId}]`),e.duration&&(n+=` (${e.duration}ms)`),n}}}createConsoleTransport(){return{name:"console",level:"debug",enabled:!0,send:async e=>{const r=this.config.formatters[0];for(const s of e){const i=r.format(s);switch(s.level){case"debug":console.debug(i);break;case"info":console.info(i);break;case"warn":console.warn(i);break;case"error":case"fatal":console.error(i);break}}}}}getEntries(e,r,s){let i=this.entries;return r&&(i=i.filter(n=>n.level===r)),s&&(i=i.filter(n=>n.category===s)),e&&(i=i.slice(-e)),i}getStats(){return{...this.stats}}search(e,r={}){const{level:s,category:i,startTime:n,endTime:d,limit:l=100}=r,g=e.toLowerCase();return this.entries.filter(u=>!(!(u.message.toLowerCase().includes(g)||u.category.toLowerCase().includes(g)||u.requestId&&u.requestId.toLowerCase().includes(g)||u.url&&u.url.toLowerCase().includes(g))||s&&u.level!==s||i&&u.category!==i||n&&u.timestamp<n||d&&u.timestamp>d)).slice(-l)}export(e="json"){var r,s;switch(e){case"json":return JSON.stringify(this.entries,null,2);case"csv":const n=[["timestamp","level","category","message","requestId","url","method","statusCode","duration"].join(",")];for(const l of this.entries){const g=[new Date(l.timestamp).toISOString(),l.level,l.category,`"${l.message.replace(/"/g,'""')}"`,l.requestId||"",l.url||"",l.method||"",((r=l.statusCode)==null?void 0:r.toString())||"",((s=l.duration)==null?void 0:s.toString())||""];n.push(g.join(","))}return n.join(`
`);case"txt":const d=this.config.formatters[0];return this.entries.map(l=>d.format(l)).join(`
`);default:throw new Error(`Unsupported export format: ${e}`)}}clear(){this.entries=[],this.buffer=[],this.stats=this.initializeStats(),this.notifyListeners([])}addListener(e){this.listeners.add(e)}removeListener(e){this.listeners.delete(e)}addTransport(e){this.config.transports.push(e)}removeTransport(e){const r=this.config.transports.findIndex(s=>s.name===e);return r>=0?(this.config.transports.splice(r,1),!0):!1}addFilter(e){this.config.filters.push(e)}removeFilter(e){const r=this.config.filters.findIndex(s=>s.name===e);return r>=0?(this.config.filters.splice(r,1),!0):!1}updateConfig(e){this.config={...this.config,...e},this.flushTimer&&(clearInterval(this.flushTimer),this.startFlushTimer())}destroy(){this.flushTimer&&clearInterval(this.flushTimer),this.flush(),this.listeners.clear()}}const O=()=>{const[o]=h.useState(()=>new F({enabled:!0,level:"debug",maxEntries:500,bufferSize:10,flushInterval:2e3,includeStack:!0,includeMetadata:!0})),[e,r]=h.useState([]),[s,i]=h.useState(o.getStats()),[n,d]=h.useState({level:"",category:"",search:""}),[l,g]=h.useState(!1),p=h.useRef(),u=h.useCallback(()=>{const a=o.getEntries(50,n.level||void 0,n.category||void 0);r(a),i(o.getStats())},[o,n]);h.useEffect(()=>{const a=()=>{u()};return o.addListener(a),u(),()=>{o.removeListener(a)}},[o,u]);const S=h.useCallback(()=>{const a=["/api/users","/api/posts","/api/comments","/api/products"],c=["GET","POST","PUT","DELETE"],m=["request","cache","performance","security","general"],b=["debug","info","warn","error"],f=a[Math.floor(Math.random()*a.length)],v=c[Math.floor(Math.random()*c.length)],y=m[Math.floor(Math.random()*m.length)],w=b[Math.floor(Math.random()*b.length)],R=`req_${Date.now()}_${Math.random().toString(36).substr(2,6)}`,k={debug:[`Debug info for ${v} ${f}`,"Cache lookup performed","Validation passed"],info:[`${v} ${f} completed successfully`,"Cache hit for key","User authenticated"],warn:[`Slow response for ${v} ${f}`,"Cache miss for key","Rate limit approaching"],error:[`${v} ${f} failed`,"Database connection error","Authentication failed"]},N=k[w][Math.floor(Math.random()*k[w].length)],C={requestId:R,url:f,method:v,userId:Math.floor(Math.random()*1e3),sessionId:`sess_${Math.random().toString(36).substr(2,8)}`,duration:Math.floor(Math.random()*2e3)+50,statusCode:w==="error"?500:200};switch(w){case"debug":o.debug(N,C,y);break;case"info":o.info(N,C,y);break;case"warn":o.warn(N,C,y);break;case"error":o.error(N,new Error("Simulated error"),C,y);break}},[o]),E=h.useCallback(()=>{l?(p.current&&clearInterval(p.current),g(!1)):(p.current=setInterval(S,1e3),g(!0))},[l,S]),j=h.useCallback(a=>{const c=`req_${Date.now()}_${Math.random().toString(36).substr(2,6)}`;switch(a){case"request":o.logRequestStart(c,"/api/test","GET",{userId:123}),setTimeout(()=>{o.logRequestSuccess(c,"/api/test","GET",200,150,{responseSize:1024})},150);break;case"error":o.logRequestError(c,"/api/error","POST",new Error("Network timeout"),5e3,{retry:3});break;case"cache":o.logCacheOperation("hit","user:123",{ttl:3600});break;case"performance":o.logPerformance("response_time",Math.floor(Math.random()*1e3)+100,"ms",{endpoint:"/api/slow"});break;case"security":o.logSecurity("Failed login attempt","medium",{ip:"192.168.1.100",userAgent:"Mozilla/5.0"});break}},[o]),T=h.useCallback(()=>{o.clear(),u()},[o,u]),q=h.useCallback(a=>{const c=o.export(a),m=new Blob([c],{type:"text/plain"}),b=URL.createObjectURL(m),f=document.createElement("a");f.href=b,f.download=`logs.${a}`,f.click(),URL.revokeObjectURL(b)},[o]);h.useEffect(()=>()=>{p.current&&clearInterval(p.current),o.destroy()},[o]);const $=a=>{switch(a){case"debug":return"text-gray-600 bg-gray-100";case"info":return"text-blue-600 bg-blue-100";case"warn":return"text-yellow-600 bg-yellow-100";case"error":return"text-red-600 bg-red-100";case"fatal":return"text-red-800 bg-red-200";default:return"text-gray-600 bg-gray-100"}},L=a=>{switch(a){case"request":return"text-green-600 bg-green-100";case"cache":return"text-purple-600 bg-purple-100";case"performance":return"text-orange-600 bg-orange-100";case"security":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},I=h.useMemo(()=>{let a=e;if(n.search){const c=n.search.toLowerCase();a=a.filter(m=>m.message.toLowerCase().includes(c)||m.category.toLowerCase().includes(c)||m.requestId&&m.requestId.toLowerCase().includes(c))}return a},[e,n.search]);return t.jsx("div",{className:"space-y-4",children:t.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"请求日志演示"}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"操作控制"}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("button",{onClick:E,className:`w-full px-4 py-2 rounded-md text-white ${l?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"}`,children:l?"停止日志":"开始日志"}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsx("button",{onClick:()=>j("request"),className:"px-3 py-2 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"请求日志"}),t.jsx("button",{onClick:()=>j("error"),className:"px-3 py-2 text-sm bg-red-600 text-white rounded-md hover:bg-red-700",children:"错误日志"}),t.jsx("button",{onClick:()=>j("cache"),className:"px-3 py-2 text-sm bg-purple-600 text-white rounded-md hover:bg-purple-700",children:"缓存日志"}),t.jsx("button",{onClick:()=>j("security"),className:"px-3 py-2 text-sm bg-orange-600 text-white rounded-md hover:bg-orange-700",children:"安全日志"})]}),t.jsx("button",{onClick:T,className:"w-full px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700",children:"清空日志"})]})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"过滤器"}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"日志级别"}),t.jsxs("select",{value:n.level,onChange:a=>d(c=>({...c,level:a.target.value})),className:"w-full p-2 border border-gray-300 rounded-md text-sm",children:[t.jsx("option",{value:"",children:"全部"}),t.jsx("option",{value:"debug",children:"Debug"}),t.jsx("option",{value:"info",children:"Info"}),t.jsx("option",{value:"warn",children:"Warn"}),t.jsx("option",{value:"error",children:"Error"}),t.jsx("option",{value:"fatal",children:"Fatal"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"分类"}),t.jsxs("select",{value:n.category,onChange:a=>d(c=>({...c,category:a.target.value})),className:"w-full p-2 border border-gray-300 rounded-md text-sm",children:[t.jsx("option",{value:"",children:"全部"}),t.jsx("option",{value:"request",children:"Request"}),t.jsx("option",{value:"cache",children:"Cache"}),t.jsx("option",{value:"performance",children:"Performance"}),t.jsx("option",{value:"security",children:"Security"}),t.jsx("option",{value:"general",children:"General"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"搜索"}),t.jsx("input",{type:"text",value:n.search,onChange:a=>d(c=>({...c,search:a.target.value})),placeholder:"搜索日志内容...",className:"w-full p-2 border border-gray-300 rounded-md text-sm"})]})]})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"导出"}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("button",{onClick:()=>q("json"),className:"w-full px-3 py-2 text-sm bg-indigo-600 text-white rounded-md hover:bg-indigo-700",children:"导出 JSON"}),t.jsx("button",{onClick:()=>q("csv"),className:"w-full px-3 py-2 text-sm bg-indigo-600 text-white rounded-md hover:bg-indigo-700",children:"导出 CSV"}),t.jsx("button",{onClick:()=>q("txt"),className:"w-full px-3 py-2 text-sm bg-indigo-600 text-white rounded-md hover:bg-indigo-700",children:"导出 TXT"})]})]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"统计信息"}),t.jsxs("div",{className:"bg-gray-50 p-4 rounded-md space-y-2",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"总计:"}),t.jsx("span",{className:"font-medium",children:s.total})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"错误率:"}),t.jsxs("span",{className:"font-medium text-red-600",children:[s.errorRate.toFixed(1),"%"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"平均耗时:"}),t.jsxs("span",{className:"font-medium",children:[Math.round(s.avgDuration),"ms"]})]})]}),t.jsxs("div",{className:"border-t pt-2",children:[t.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"按级别统计:"}),t.jsx("div",{className:"space-y-1",children:Object.entries(s.byLevel).map(([a,c])=>t.jsxs("div",{className:"flex justify-between text-xs",children:[t.jsx("span",{className:`px-2 py-1 rounded ${$(a)}`,children:a}),t.jsx("span",{className:"font-medium",children:c})]},a))})]}),t.jsxs("div",{className:"border-t pt-2",children:[t.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"热门分类:"}),t.jsx("div",{className:"space-y-1",children:s.topCategories.slice(0,5).map(({category:a,count:c})=>t.jsxs("div",{className:"flex justify-between text-xs",children:[t.jsx("span",{className:`px-2 py-1 rounded ${L(a)}`,children:a}),t.jsx("span",{className:"font-medium",children:c})]},a))})]})]})]}),t.jsxs("div",{children:[t.jsxs("h4",{className:"font-medium text-gray-900 mb-2",children:["最近错误 (",s.recentErrors.length,")"]}),t.jsx("div",{className:"bg-red-50 p-4 rounded-md max-h-40 overflow-y-auto",children:s.recentErrors.length===0?t.jsx("div",{className:"text-sm text-gray-500 text-center py-2",children:"暂无错误"}):t.jsx("div",{className:"space-y-2",children:s.recentErrors.slice().reverse().map(a=>t.jsxs("div",{className:"bg-white p-2 rounded border text-xs",children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsx("span",{className:`px-2 py-1 rounded ${$(a.level)}`,children:a.level}),t.jsx("span",{className:"text-gray-500",children:new Date(a.timestamp).toLocaleTimeString()})]}),t.jsx("div",{className:"text-gray-700 truncate",children:a.message}),a.url&&t.jsxs("div",{className:"text-gray-500",children:[a.method," ",a.url]})]},a.id))})})]})]}),t.jsx("div",{className:"lg:col-span-2 space-y-4",children:t.jsxs("div",{children:[t.jsxs("h4",{className:"font-medium text-gray-900 mb-2",children:["日志条目 (",I.length,")"]}),t.jsx("div",{className:"bg-gray-50 p-4 rounded-md max-h-96 overflow-y-auto",children:I.length===0?t.jsx("div",{className:"text-sm text-gray-500 text-center py-4",children:"暂无日志条目"}):t.jsx("div",{className:"space-y-2",children:I.slice().reverse().map(a=>t.jsxs("div",{className:"bg-white p-3 rounded border",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("span",{className:`px-2 py-1 text-xs rounded ${$(a.level)}`,children:a.level}),t.jsx("span",{className:`px-2 py-1 text-xs rounded ${L(a.category)}`,children:a.category}),a.requestId&&t.jsx("span",{className:"px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded font-mono",children:a.requestId})]}),t.jsx("span",{className:"text-xs text-gray-500",children:new Date(a.timestamp).toLocaleTimeString()})]}),t.jsx("div",{className:"text-sm text-gray-800 mb-2",children:a.message}),(a.url||a.duration)&&t.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-600",children:[a.url&&t.jsxs("span",{children:[a.method," ",a.url]}),a.statusCode&&t.jsx("span",{className:a.statusCode>=400?"text-red-600":"text-green-600",children:a.statusCode}),a.duration&&t.jsxs("span",{children:[a.duration,"ms"]})]}),a.metadata&&Object.keys(a.metadata).length>0&&t.jsxs("details",{className:"mt-2",children:[t.jsx("summary",{className:"text-xs text-gray-500 cursor-pointer hover:text-gray-700",children:"元数据"}),t.jsx("pre",{className:"mt-1 text-xs bg-gray-100 p-2 rounded overflow-x-auto",children:JSON.stringify(a.metadata,null,2)})]})]},a.id))})})]})})]})]})})},A=()=>{const o=[{title:"核心概念",items:["结构化日志：支持多级别、多分类的结构化日志记录，便于分析和追踪","实时监控：日志流和统计信息实时更新，支持性能分析和错误追踪","灵活过滤：支持按级别、分类、时间等多维度过滤和搜索","数据导出：支持多种格式的日志导出和备份"]},{title:"主要优势",items:["结构化记录，便于组织和查找日志信息","实时监控和统计，快速定位问题","性能分析和错误追踪，提升系统可靠性","灵活过滤和导出，支持多场景运维分析"]},{title:"适用场景",items:["API 请求监控和调试","应用程序错误追踪","性能瓶颈分析","安全事件记录","用户行为分析","系统运维监控"]},{title:"注意事项",items:["合理设置日志级别，避免过度记录影响性能","注意敏感信息保护，避免记录密码等敏感数据","定期清理历史日志，防止存储空间不足","生产环境谨慎使用 debug 级别日志"]}],e=[{title:"基础日志记录",component:t.jsx(O,{}),description:"演示请求日志的基本功能，包括不同级别的日志记录、分类管理和实时显示。",observationPoints:["观察不同日志级别（debug、info、warn、error）的颜色区分","注意日志的分类标签（request、cache、performance、security）","查看实时统计信息的更新，包括总数、错误率和平均耗时","观察过滤器的即时效果，支持按级别、分类和关键词搜索"],keyPoints:["支持多种日志级别，便于区分重要程度","提供分类管理，方便按功能模块组织日志","实时统计功能帮助快速了解系统状态","灵活的过滤和搜索功能提高问题定位效率"],commonTraps:["在生产环境中开启过多的 debug 日志","记录敏感信息如密码、token 等","不设置日志数量限制导致内存溢出","忽略日志的性能影响"],solutions:["根据环境动态调整日志级别","使用数据脱敏技术处理敏感信息","设置合理的日志缓冲区和清理策略","使用异步日志记录减少性能影响"],importantTips:["点击不同的日志生成按钮观察各种类型的日志格式","使用过滤器快速定位特定类型的日志条目","查看错误统计区域了解系统健康状况","尝试导出功能体验不同格式的日志文件"]}],r={concepts:["日志级别：debug < info < warn < error < fatal，级别越高越重要","日志分类：按功能模块分类，如 request、cache、performance、security","元数据：附加的结构化信息，便于后续分析和查询","缓冲机制：批量写入日志，提高性能","过滤器：支持多维度的日志筛选和搜索","统计分析：实时计算各种指标，如错误率、平均耗时等"],steps:["创建 RequestLogger 实例并配置参数","在应用程序中集成日志记录点","使用不同的日志方法记录各种事件","配置日志级别和分类策略","实现日志的过滤和搜索功能","添加统计分析和监控功能","实现日志的导出和备份机制"],tips:["合理设置日志级别，生产环境通常使用 info 或 warn 级别","使用有意义的分类名称，便于后续维护","在关键业务节点添加日志记录","定期分析日志统计信息，发现潜在问题","使用结构化的元数据，便于自动化分析","实现日志轮转和清理机制，避免存储问题"]},s={questions:[{question:"什么是日志级别？如何选择合适的日志级别？",answer:"日志级别用于区分日志的重要程度，常见的级别有 debug、info、warn、error、fatal。选择原则：debug 用于开发调试，info 记录正常业务流程，warn 记录潜在问题，error 记录错误信息，fatal 记录致命错误。生产环境通常设置为 info 或 warn 级别。"},{question:"如何设计高性能的日志系统？",answer:"高性能日志系统的关键：1) 使用异步写入避免阻塞主线程；2) 实现缓冲机制批量写入；3) 合理设置日志级别减少不必要的记录；4) 使用结构化日志格式便于解析；5) 实现日志轮转和压缩；6) 考虑使用专业的日志收集系统如 ELK。"},{question:"日志记录中需要注意哪些安全问题？",answer:"安全注意事项：1) 不记录敏感信息如密码、token、个人隐私数据；2) 对敏感字段进行脱敏处理；3) 控制日志访问权限；4) 定期清理历史日志；5) 注意日志注入攻击；6) 在分布式环境中保护日志传输安全。"},{question:"如何进行日志分析和监控？",answer:"日志分析方法：1) 实时统计关键指标如错误率、响应时间；2) 设置阈值告警机制；3) 使用可视化工具展示趋势；4) 实现日志聚合和关联分析；5) 建立日志检索和查询系统；6) 定期生成分析报告；7) 结合业务指标进行综合分析。"}],keyPoints:["理解不同日志级别的使用场景和选择原则","掌握高性能日志系统的设计要点","了解日志安全和隐私保护的重要性","熟悉日志分析和监控的方法和工具","理解结构化日志的优势和实现方式"]},i={dos:["使用结构化的日志格式，便于自动化处理","在关键业务节点添加日志记录","使用有意义的日志消息和分类","实现日志的异步写入和缓冲机制","定期分析日志统计信息","建立完善的日志监控和告警机制","实现日志的备份和恢复策略"],donts:["不要记录敏感信息如密码、token","不要在循环中大量记录日志","不要忽略日志的性能影响","不要在生产环境开启过多的 debug 日志","不要让日志文件无限增长","不要忽略日志的安全和权限控制"],patterns:["请求追踪模式：为每个请求分配唯一 ID，便于追踪完整流程","分层日志模式：按应用层次分别记录，如业务层、服务层、数据层","事件驱动模式：基于事件触发日志记录，便于事件溯源","采样日志模式：对高频事件进行采样记录，平衡性能和监控需求","聚合统计模式：实时聚合关键指标，减少存储和提高查询效率"]};return t.jsx(P,{title:"请求日志",description:"学习如何实现和使用请求日志系统，包括日志记录、分类管理、统计分析和监控功能。",overview:o,examples:e,tutorial:r,interview:s,bestPractices:i})};export{A as default};
