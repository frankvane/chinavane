var f=Object.defineProperty;var N=(o,s,t)=>s in o?f(o,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[s]=t;var k=(o,s,t)=>N(o,typeof s!="symbol"?s+"":s,t);import{r as i,j as e}from"./index-C7SuDyTR.js";import{C as A}from"./ComponentTemplate-BzrYXZsv.js";class P{constructor(){k(this,"apiKeys",new Map)}generateAPIKey(s,t=[]){const a=this.generateRandomKey();return this.apiKeys.set(a,{key:a,permissions:t,createdAt:new Date}),a}validateAPIKey(s,t){const a=this.apiKeys.get(s);return a?t&&!a.permissions.includes(t)?{valid:!1,error:"Insufficient permissions"}:(a.lastUsed=new Date,{valid:!0,permissions:a.permissions}):{valid:!1,error:"Invalid API key"}}revokeAPIKey(s){return this.apiKeys.delete(s)}getAllAPIKeys(){return Array.from(this.apiKeys.values())}generateRandomKey(){const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let t="ak_";for(let a=0;a<32;a++)t+=s.charAt(Math.floor(Math.random()*s.length));return t}}const K=()=>{const[o]=i.useState(()=>new P),[s,t]=i.useState([]),[a,n]=i.useState([]),[l,u]=i.useState(""),[d,b]=i.useState(""),[m,g]=i.useState(null),p=["read","write","delete","admin"],c=i.useCallback(()=>{o.generateAPIKey("user123",a),t(o.getAllAPIKeys()),n([])},[o,a]),h=i.useCallback(()=>{if(!l)return;const r=o.validateAPIKey(l,d||void 0);g(r),t(o.getAllAPIKeys())},[o,l,d]),v=i.useCallback(r=>{o.revokeAPIKey(r),t(o.getAllAPIKeys()),l===r&&(u(""),g(null))},[o,l]),j=(r,x)=>{n(x?y=>[...y,r]:y=>y.filter(T=>T!==r))};return e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"API Key 认证管理"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"生成新的API Key"}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"权限设置"}),e.jsx("div",{className:"flex flex-wrap gap-3",children:p.map(r=>e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:a.includes(r),onChange:x=>j(r,x.target.checked),className:"mr-2"}),e.jsx("span",{className:"text-sm",children:r})]},r))})]}),e.jsx("button",{onClick:c,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"生成API Key"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"验证API Key"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"API Key"}),e.jsx("input",{type:"text",value:l,onChange:r=>u(r.target.value),placeholder:"输入要验证的API Key",className:"w-full p-2 border border-gray-300 rounded-md font-mono text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"所需权限 (可选)"}),e.jsxs("select",{value:d,onChange:r=>b(r.target.value),className:"w-full p-2 border border-gray-300 rounded-md",children:[e.jsx("option",{value:"",children:"无特定权限要求"}),p.map(r=>e.jsx("option",{value:r,children:r},r))]})]})]}),e.jsx("button",{onClick:h,disabled:!l,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50",children:"验证API Key"}),m&&e.jsxs("div",{className:`mt-3 p-3 rounded-md ${m.valid?"bg-green-100 text-green-800 border border-green-200":"bg-red-100 text-red-800 border border-red-200"}`,children:[e.jsxs("div",{className:"font-medium",children:["验证结果: ",m.valid?"✅ 有效":"❌ 无效"]}),m.error&&e.jsxs("div",{className:"text-sm mt-1",children:["错误: ",m.error]}),m.permissions&&e.jsxs("div",{className:"text-sm mt-1",children:["权限: ",m.permissions.join(", ")||"无"]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"已生成的API Keys"}),s.length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"暂无API Key"}):e.jsx("div",{className:"space-y-3",children:s.map((r,x)=>e.jsx("div",{className:"p-3 border border-gray-200 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-mono text-sm bg-gray-100 p-2 rounded mb-2",children:r.key}),e.jsxs("div",{className:"text-sm text-gray-600",children:["权限: ",r.permissions.join(", ")||"无"]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["创建时间: ",r.createdAt.toLocaleString(),r.lastUsed&&e.jsxs("span",{className:"ml-4",children:["最后使用: ",r.lastUsed.toLocaleString()]})]})]}),e.jsx("button",{onClick:()=>v(r.key),className:"px-3 py-1 bg-red-600 text-white text-sm rounded-md hover:bg-red-700",children:"撤销"})]})},x))})]})]})})};class I{constructor(s="my-jwt-secret-key"){k(this,"secretKey");this.secretKey=s}generateToken(s,t=3600){const a={alg:"HS256",typ:"JWT"},n=Math.floor(Date.now()/1e3),l={...s,iat:n,exp:n+t},u=this.base64UrlEncode(JSON.stringify(a)),d=this.base64UrlEncode(JSON.stringify(l)),b=this.generateSignature(`${u}.${d}`);return`${u}.${d}.${b}`}verifyToken(s){try{const t=s.split(".");if(t.length!==3)return{valid:!1,error:"Invalid token format"};const[a,n,l]=t,u=this.generateSignature(`${a}.${n}`);if(l!==u)return{valid:!1,error:"Invalid signature"};const d=JSON.parse(this.base64UrlDecode(n)),b=Math.floor(Date.now()/1e3);return d.exp&&d.exp<b?{valid:!1,error:"Token expired"}:{valid:!0,payload:d}}catch{return{valid:!1,error:"Token parsing failed"}}}refreshToken(s,t=3600){const a=this.verifyToken(s);if(!a.valid||!a.payload)return null;const n={...a.payload};return delete n.iat,delete n.exp,this.generateToken(n,t)}base64UrlEncode(s){return btoa(s).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}base64UrlDecode(s){return s+="=".repeat((4-s.length%4)%4),atob(s.replace(/-/g,"+").replace(/_/g,"/"))}generateSignature(s){let t=0;const a=s+this.secretKey;for(let n=0;n<a.length;n++){const l=a.charCodeAt(n);t=(t<<5)-t+l,t=t&t}return Math.abs(t).toString(36)}}const w=()=>{const[o]=i.useState(()=>new I),[s,t]=i.useState({userId:"12345",username:"john_doe",email:"john@example.com",role:"user"}),[a,n]=i.useState(""),[l,u]=i.useState(null),[d,b]=i.useState(3600),m=i.useCallback(()=>{const c=o.generateToken(s,d);n(c),u(null)},[o,s,d]),g=i.useCallback(()=>{if(!a)return;const c=o.verifyToken(a);u(c)},[o,a]),p=i.useCallback(()=>{if(!a)return;const c=o.refreshToken(a,d);c&&(n(c),u(null))},[o,a,d]);return e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"JWT Token 认证"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"用户ID"}),e.jsx("input",{type:"text",value:s.userId,onChange:c=>t(h=>({...h,userId:c.target.value})),className:"w-full p-2 border border-gray-300 rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"用户名"}),e.jsx("input",{type:"text",value:s.username,onChange:c=>t(h=>({...h,username:c.target.value})),className:"w-full p-2 border border-gray-300 rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"邮箱"}),e.jsx("input",{type:"email",value:s.email,onChange:c=>t(h=>({...h,email:c.target.value})),className:"w-full p-2 border border-gray-300 rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"角色"}),e.jsxs("select",{value:s.role,onChange:c=>t(h=>({...h,role:c.target.value})),className:"w-full p-2 border border-gray-300 rounded-md",children:[e.jsx("option",{value:"user",children:"普通用户"}),e.jsx("option",{value:"admin",children:"管理员"}),e.jsx("option",{value:"moderator",children:"版主"})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"过期时间 (秒)"}),e.jsx("input",{type:"number",value:d,onChange:c=>b(parseInt(c.target.value)||3600),min:"60",max:"86400",className:"w-32 p-2 border border-gray-300 rounded-md"})]}),e.jsxs("div",{className:"flex space-x-4 mb-4",children:[e.jsx("button",{onClick:m,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"生成Token"}),a&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:g,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:"验证Token"}),e.jsx("button",{onClick:p,className:"px-4 py-2 bg-yellow-600 text-white rounded-md hover:bg-yellow-700",children:"刷新Token"})]})]}),a&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"生成的JWT Token:"}),e.jsx("textarea",{value:a,readOnly:!0,className:"w-full p-2 border border-gray-300 rounded-md font-mono text-xs",rows:3})]}),l&&e.jsxs("div",{className:`p-4 rounded-md ${l.valid?"bg-green-100 text-green-800 border border-green-200":"bg-red-100 text-red-800 border border-red-200"}`,children:[e.jsxs("div",{className:"font-medium mb-2",children:["验证结果: ",l.valid?"✅ 有效":"❌ 无效"]}),l.error&&e.jsxs("div",{className:"text-sm mb-2",children:["错误信息: ",l.error]}),l.payload&&e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium mb-1",children:"Token内容:"}),e.jsx("pre",{className:"bg-white p-2 rounded text-xs overflow-x-auto",children:JSON.stringify(l.payload,null,2)})]})]})]})})};class C{constructor(){k(this,"authorizationCodes",new Map);k(this,"accessTokens",new Map)}generateAuthorizationCode(s,t,a=[]){const n=this.generateRandomString(32),l=new Date(Date.now()+10*60*1e3);return this.authorizationCodes.set(n,{code:n,clientId:s,redirectUri:t,scope:a,expiresAt:l}),n}exchangeCodeForToken(s,t,a){const n=this.authorizationCodes.get(s);if(!n)return{success:!1,error:"Invalid authorization code"};if(n.expiresAt<new Date)return this.authorizationCodes.delete(s),{success:!1,error:"Authorization code expired"};if(n.clientId!==t||n.redirectUri!==a)return{success:!1,error:"Client ID or redirect URI mismatch"};const l=this.generateRandomString(64),u=new Date(Date.now()+60*60*1e3);return this.accessTokens.set(l,{token:l,clientId:t,scope:n.scope,expiresAt:u}),this.authorizationCodes.delete(s),{success:!0,accessToken:l}}validateAccessToken(s,t){const a=this.accessTokens.get(s);return a?a.expiresAt<new Date?(this.accessTokens.delete(s),{valid:!1,error:"Access token expired"}):t&&!a.scope.includes(t)?{valid:!1,error:"Insufficient scope"}:{valid:!0,scope:a.scope}:{valid:!1,error:"Invalid access token"}}generateRandomString(s){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let a="";for(let n=0;n<s;n++)a+=t.charAt(Math.floor(Math.random()*t.length));return a}}const S=()=>{const[o]=i.useState(()=>new C),[s]=i.useState("client_123456"),[t]=i.useState("https://example.com/callback"),[a,n]=i.useState(["read"]),[l,u]=i.useState(""),[d,b]=i.useState(""),[m,g]=i.useState(null),p=["read","write","profile","email"],c=i.useCallback(()=>{const r=o.generateAuthorizationCode(s,t,a);u(r),b(""),g(null)},[o,s,t,a]),h=i.useCallback(()=>{if(!l)return;const r=o.exchangeCodeForToken(l,s,t);r.success&&r.accessToken?(b(r.accessToken),u("")):alert(`Token交换失败: ${r.error}`)},[o,l,s,t]),v=i.useCallback(r=>{if(!d)return;const x=o.validateAccessToken(d,r);g({...x,testedScope:r})},[o,d]),j=(r,x)=>{n(x?y=>[...y,r]:y=>y.filter(T=>T!==r))};return e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"OAuth 2.0 认证流程"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-3",children:"步骤1: 用户授权"}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["客户端ID:"," ",e.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded",children:s})]}),e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["重定向URI:"," ",e.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded",children:t})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"请求的权限范围"}),e.jsx("div",{className:"flex flex-wrap gap-3",children:p.map(r=>e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:a.includes(r),onChange:x=>j(r,x.target.checked),className:"mr-2"}),e.jsx("span",{className:"text-sm",children:r})]},r))})]}),e.jsx("button",{onClick:c,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"授权并生成授权码"}),l&&e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"授权码 (10分钟有效):"}),e.jsx("code",{className:"bg-gray-100 p-2 rounded block text-sm font-mono",children:l})]})]}),e.jsxs("div",{className:"p-4 bg-green-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-green-900 mb-3",children:"步骤2: 交换访问令牌"}),e.jsx("button",{onClick:h,disabled:!l,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50",children:"使用授权码获取访问令牌"}),d&&e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"访问令牌 (1小时有效):"}),e.jsx("code",{className:"bg-gray-100 p-2 rounded block text-sm font-mono break-all",children:d})]})]}),e.jsxs("div",{className:"p-4 bg-purple-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-purple-900 mb-3",children:"步骤3: 使用访问令牌"}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[e.jsx("button",{onClick:()=>v(),disabled:!d,className:"px-3 py-2 bg-purple-600 text-white text-sm rounded-md hover:bg-purple-700 disabled:opacity-50",children:"验证令牌"}),p.map(r=>e.jsxs("button",{onClick:()=>v(r),disabled:!d,className:"px-3 py-2 bg-purple-600 text-white text-sm rounded-md hover:bg-purple-700 disabled:opacity-50",children:["验证 ",r," 权限"]},r))]}),m&&e.jsxs("div",{className:`p-3 rounded-md ${m.valid?"bg-green-100 text-green-800 border border-green-200":"bg-red-100 text-red-800 border border-red-200"}`,children:[e.jsxs("div",{className:"font-medium",children:["令牌验证: ",m.valid?"✅ 有效":"❌ 无效"]}),m.testedScope&&e.jsxs("div",{className:"text-sm mt-1",children:["测试权限: ",m.testedScope]}),m.error&&e.jsxs("div",{className:"text-sm mt-1",children:["错误: ",m.error]}),m.scope&&e.jsxs("div",{className:"text-sm mt-1",children:["令牌权限: ",m.scope.join(", ")]})]})]})]})]})})},H=()=>{const o=[{title:"认证机制概览",items:["JWT认证 - 基于JSON Web Token的无状态认证机制，适用于分布式系统和微服务架构","API Key认证 - 简单直接的API访问控制方式，通过预分配的密钥进行身份验证和权限控制","OAuth 2.0 - 标准的授权框架，支持第三方应用安全访问用户资源，广泛用于社交登录等场景"]},{title:"主要优势",items:["无状态认证，易于扩展和集成","支持细粒度权限控制和多种认证场景","提升安全性，防止未授权访问","便于第三方应用集成和授权"]},{title:"适用场景",items:["用户登录与会话管理","API服务间的安全通信","第三方应用授权接入","高安全性要求的业务系统"]},{title:"注意事项",items:["Token/Key应安全存储，避免泄露","定期轮换密钥和Token，提升安全性","认证信息传输必须使用HTTPS","权限控制应遵循最小权限原则"]}],s={concepts:["认证 vs 授权：认证(Authentication)验证用户身份，授权(Authorization)控制用户权限。","JWT Token结构：JWT由Header、Payload、Signature三部分组成，用点号分隔。","API Key管理：API Key是预分配的密钥，用于识别和认证API调用者。","OAuth 2.0流程：标准的授权流程：授权请求 → 授权码 → 访问令牌 → 资源访问。"],steps:["选择认证方式：根据应用场景选择合适的认证机制，如JWT、API Key、OAuth等。","实现认证逻辑：实现Token生成、验证、刷新，API Key生成与权限控制，OAuth授权流程。","集成到请求中：将认证信息添加到HTTP请求Header或参数中，确保使用HTTPS。","处理认证失败：优雅地处理Token过期、Key无效、授权失败等情况，提供重试和降级策略。"],tips:["始终使用HTTPS传输认证信息","定期轮换密钥和Token以提高安全性","实现详细的认证日志和监控","遵循最小权限原则设置权限","为不同环境使用不同的认证配置"]},t={dos:["选择合适的认证方式，如Web应用用JWT，微服务用API Key，第三方集成用OAuth","实现安全的Token管理，设置合理过期时间并支持刷新和撤销","所有认证相关通信都必须使用HTTPS加密","只授予用户或应用完成任务所需的最小权限"],donts:["避免在URL中传递敏感信息，使用Header传递Token","不要忽视Token的安全存储，客户端应使用HttpOnly Cookie或安全本地存储","不要使用弱密钥或不安全的加密算法","不要在日志中记录完整的认证凭据"],patterns:["双Token模式：访问Token+刷新Token分离，提高安全性","权限缓存模式：缓存用户权限信息，减少数据库查询","联合认证模式：支持多种认证方式的统一认证入口","审计模式：完整记录所有认证和授权操作，便于合规和追踪"]};return e.jsx(A,{title:"请求认证",description:"学习如何在HTTP请求中实现各种认证机制，包括JWT、API Key和OAuth等认证方式，确保API访问的安全性。",overview:o,examples:[{title:"JWT Token认证",component:e.jsx(w,{}),description:"演示JWT Token的生成、验证和刷新流程",observationPoints:["观察Token的结构和内容","注意Token的过期时间处理","查看验证失败的错误信息","体验Token刷新机制"],keyPoints:["JWT由Header、Payload和Signature三部分组成","Token包含用户信息和过期时间","签名确保Token的完整性和真实性","过期Token需要刷新或重新登录"],commonTraps:["在客户端存储敏感信息","使用过长的过期时间","忽略Token的安全传输","不验证Token的签名"],solutions:["只在Token中存储必要的非敏感信息","设置合理的过期时间并实现刷新机制","始终使用HTTPS传输Token","严格验证Token的签名和过期时间"],importantTips:["定期轮换签名密钥","实现Token黑名单机制","监控异常的Token使用","提供安全的Token存储方案"]},{title:"API Key认证",component:e.jsx(K,{}),description:"演示API Key的生成、验证和权限管理",observationPoints:["观察API Key的生成过程","注意权限的细粒度控制","查看Key的使用记录","体验Key的撤销机制"],keyPoints:["API Key是简单有效的认证方式","支持基于权限的访问控制","可以追踪Key的使用情况","支持Key的生命周期管理"],commonTraps:["在URL中传递API Key","使用过于宽泛的权限","不定期轮换API Key","缺乏使用监控"],solutions:["在Header中传递API Key","遵循最小权限原则","定期轮换和更新Key","实现详细的使用日志"],importantTips:["为不同用途生成不同的Key","实现Key的自动过期机制","提供Key使用的统计报告","建立Key泄露的应急响应流程"]},{title:"OAuth 2.0认证",component:e.jsx(S,{}),description:"演示OAuth 2.0的完整授权流程",observationPoints:["观察授权码的生成和使用","注意访问令牌的获取过程","查看权限范围的控制","体验令牌的验证机制"],keyPoints:["OAuth 2.0是标准的授权框架","支持多种授权流程","提供细粒度的权限控制","适合第三方应用集成"],commonTraps:["混淆认证和授权的概念","使用不安全的授权流程","权限范围设置过于宽泛","忽略状态参数的验证"],solutions:["明确区分认证和授权","选择适合的授权流程","实施最小权限原则","严格验证所有参数"],importantTips:["使用PKCE增强安全性","实现proper的错误处理","定期审查授权的应用","提供用户友好的授权界面"]}],tutorial:s,interview:{questions:[{question:"JWT Token的结构是什么，各部分的作用是什么？",answer:"JWT由三部分组成，用点号分隔：1) Header：包含算法类型和Token类型；2) Payload：包含声明信息，如用户ID、过期时间等；3) Signature：使用Header中指定的算法和密钥对前两部分进行签名，确保Token未被篡改。"},{question:"OAuth 2.0的授权码模式流程是什么？",answer:"授权码模式流程：1) 客户端引导用户到授权服务器；2) 用户同意授权后，授权服务器返回授权码到重定向URI；3) 客户端使用授权码向授权服务器请求访问令牌；4) 授权服务器验证授权码后返回访问令牌；5) 客户端使用访问令牌访问受保护的资源。"},{question:"API Key和JWT Token的区别是什么？",answer:"主要区别：1) 复杂度：API Key简单，JWT结构化；2) 信息量：API Key只是标识符，JWT包含用户信息；3) 状态：API Key通常需要服务端存储，JWT无状态；4) 过期：API Key通常长期有效，JWT有明确过期时间；5) 用途：API Key适合服务间调用，JWT适合用户认证。"},{question:"如何防止Token被盗用？",answer:"防止Token盗用的方法：1) 使用HTTPS传输；2) 设置合理的过期时间；3) 实现Token刷新机制；4) 绑定IP地址或设备指纹；5) 使用HttpOnly Cookie存储；6) 实现异常登录检测；7) 支持Token撤销；8) 监控Token使用情况。"},{question:"什么是PKCE，为什么在OAuth中使用它？",answer:"PKCE(Proof Key for Code Exchange)是OAuth 2.0的安全扩展，通过code_verifier和code_challenge防止授权码拦截攻击。客户端生成随机字符串作为code_verifier，计算其哈希值作为code_challenge发送给授权服务器，交换令牌时提供原始verifier进行验证。"}],keyPoints:["选择合适的认证方式需要考虑安全性、性能和复杂度","JWT提供无状态认证，但需要注意Token大小和安全性","API Key适合长期的服务间认证，管理相对简单","OAuth 2.0是标准的第三方授权协议，安全性高但实现复杂","权限控制应该遵循最小权限原则","Token的安全存储和传输至关重要","需要建立完善的监控和审计机制"]},bestPractices:t})};export{H as default};
