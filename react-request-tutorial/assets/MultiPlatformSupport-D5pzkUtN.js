var k=Object.defineProperty;var R=(n,s,a)=>s in n?k(n,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[s]=a;var w=(n,s,a)=>R(n,typeof s!="symbol"?s+"":s,a);import{r as d,j as e}from"./index-C7SuDyTR.js";import{a as q}from"./index-NIGUFBhG.js";import{C as L}from"./ComponentTemplate-BzrYXZsv.js";class D{constructor(){w(this,"deviceInfo");w(this,"platformConfig");w(this,"adapters",new Map);w(this,"activeAdapter",null);w(this,"performanceMetrics",new Map);w(this,"listeners",new Set);this.deviceInfo=this.detectDevice(),this.platformConfig=this.getPlatformConfig(this.deviceInfo.platform),this.initializeAdapters(),this.selectBestAdapter(),this.setupEventListeners()}detectDevice(){var v;const s=navigator.userAgent,a=window.screen;let i="web";/Mobile|Android|iPhone|iPad/.test(s)?/iPad/.test(s)||a.width>=768&&a.height>=1024?i="tablet":i="mobile":/Electron/.test(s)?i="desktop":/TV|SmartTV/.test(s)?i="tv":/Watch/.test(s)&&(i="watch");const m="ontouchstart"in window||navigator.maxTouchPoints>0,h=a.width>a.height?"landscape":"portrait";let u;"connection"in navigator&&(u=(v=navigator.connection)==null?void 0:v.effectiveType);let g;"deviceMemory"in navigator&&(g=navigator.deviceMemory);let f;return"hardwareConcurrency"in navigator&&(f=navigator.hardwareConcurrency),{platform:i,userAgent:s,screenWidth:a.width,screenHeight:a.height,pixelRatio:window.devicePixelRatio||1,touchSupport:m,orientation:h,connectionType:u,memory:g,cores:f}}getPlatformConfig(s){return{web:{platform:"web",maxConcurrentRequests:6,timeout:3e4,retryAttempts:3,cacheSize:52428800,compressionEnabled:!0,batchingEnabled:!0,prefetchEnabled:!0,headers:{"User-Agent":navigator.userAgent,Accept:"application/json, text/plain, */*"}},mobile:{platform:"mobile",maxConcurrentRequests:3,timeout:15e3,retryAttempts:2,cacheSize:20971520,compressionEnabled:!0,batchingEnabled:!0,prefetchEnabled:!1,headers:{"User-Agent":navigator.userAgent,Accept:"application/json","Cache-Control":"max-age=300"}},tablet:{platform:"tablet",maxConcurrentRequests:4,timeout:2e4,retryAttempts:3,cacheSize:31457280,compressionEnabled:!0,batchingEnabled:!0,prefetchEnabled:!0,headers:{"User-Agent":navigator.userAgent,Accept:"application/json, text/plain, */*"}},desktop:{platform:"desktop",maxConcurrentRequests:8,timeout:45e3,retryAttempts:3,cacheSize:104857600,compressionEnabled:!0,batchingEnabled:!0,prefetchEnabled:!0,headers:{"User-Agent":navigator.userAgent,Accept:"application/json, text/plain, */*","X-Platform":"desktop"}},tv:{platform:"tv",maxConcurrentRequests:2,timeout:1e4,retryAttempts:1,cacheSize:10485760,compressionEnabled:!1,batchingEnabled:!1,prefetchEnabled:!1,headers:{"User-Agent":navigator.userAgent,Accept:"application/json","X-Platform":"tv"}},watch:{platform:"watch",maxConcurrentRequests:1,timeout:5e3,retryAttempts:1,cacheSize:5242880,compressionEnabled:!1,batchingEnabled:!1,prefetchEnabled:!1,headers:{"User-Agent":navigator.userAgent,Accept:"application/json","X-Platform":"watch"}}}[s]}getMockData(s){return{users:{data:[{id:1,name:"张三",email:"zhangsan@example.com",role:"admin"},{id:2,name:"李四",email:"lisi@example.com",role:"user"},{id:3,name:"王五",email:"wangwu@example.com",role:"user"}],total:3,page:1},posts:{data:[{id:1,title:"React多端支持最佳实践",author:"张三",views:1250},{id:2,title:"移动端性能优化指南",author:"李四",views:890},{id:3,title:"跨平台开发经验分享",author:"王五",views:2100}],total:3,page:1},profile:{id:1,name:"当前用户",email:"user@example.com",avatar:"/avatar.jpg",settings:{theme:"light",language:"zh-CN",notifications:!0}}}[s]||{error:"未找到数据"}}initializeAdapters(){this.registerAdapter({name:"axios",platform:["web","mobile","tablet","desktop"],execute:async s=>{const a=s.url.replace("/api/","");return await new Promise(i=>setTimeout(i,Math.random()*500+100)),this.getMockData(a)},isSupported:()=>typeof q<"u"}),this.registerAdapter({name:"fetch",platform:["web","mobile","tablet","desktop"],execute:async s=>{const a=s.url.replace("/api/","");return await new Promise(i=>setTimeout(i,Math.random()*300+50)),this.getMockData(a)},isSupported:()=>typeof fetch<"u"}),this.registerAdapter({name:"xhr",platform:["web","mobile","tablet","desktop","tv"],execute:async s=>{const a=s.url.replace("/api/","");return await new Promise(i=>setTimeout(i,Math.random()*800+200)),this.getMockData(a)},isSupported:()=>typeof XMLHttpRequest<"u"}),this.registerAdapter({name:"simple",platform:["tv","watch"],execute:async s=>{const a=s.url.replace("/api/","");return await new Promise(i=>setTimeout(i,Math.random()*1e3+500)),this.getMockData(a)},isSupported:()=>!0})}registerAdapter(s){this.adapters.set(s.name,s)}selectBestAdapter(){const s=Array.from(this.adapters.values()).filter(a=>a.platform.includes(this.deviceInfo.platform)&&a.isSupported());if(s.length>0){const a=["fetch","axios","xhr","simple"];for(const i of a){const m=s.find(h=>h.name===i);if(m){this.activeAdapter=m;break}}}}setupEventListeners(){window.addEventListener("orientationchange",()=>{setTimeout(()=>{this.deviceInfo=this.detectDevice(),this.notifyListeners()},100)}),window.addEventListener("resize",()=>{this.deviceInfo=this.detectDevice(),this.notifyListeners()})}notifyListeners(){this.listeners.forEach(s=>s(this.deviceInfo))}addDeviceInfoListener(s){this.listeners.add(s)}removeDeviceInfoListener(s){this.listeners.delete(s)}async executeRequest(s){if(!this.activeAdapter)throw new Error("没有可用的适配器");const a=performance.now();try{const i=await this.activeAdapter.execute(s),h=performance.now()-a;return this.recordPerformance(this.activeAdapter.name,h),i}catch(i){throw i}}recordPerformance(s,a){this.performanceMetrics.has(s)||this.performanceMetrics.set(s,[]);const i=this.performanceMetrics.get(s);i.push(a),i.length>100&&i.shift()}getDeviceInfo(){return{...this.deviceInfo}}getPlatformConfiguration(){return{...this.platformConfig}}getAvailableAdapters(){return Array.from(this.adapters.values()).filter(s=>s.platform.includes(this.deviceInfo.platform)&&s.isSupported())}getCurrentAdapter(){return this.activeAdapter}switchAdapter(s){const a=this.adapters.get(s);return a&&a.platform.includes(this.deviceInfo.platform)&&a.isSupported()?(this.activeAdapter=a,!0):!1}getPerformanceMetrics(s){const a=this.performanceMetrics.get(s)||[];if(a.length===0)return{requestCount:0,averageTime:0,minTime:0,maxTime:0,successRate:0,errorCount:0};const i=a.reduce((m,h)=>m+h,0);return{requestCount:a.length,averageTime:Math.round(i/a.length),minTime:Math.round(Math.min(...a)),maxTime:Math.round(Math.max(...a)),successRate:100,errorCount:0}}clearPerformanceData(){this.performanceMetrics.clear()}}const U=()=>{const[n]=d.useState(()=>new D),[s,a]=d.useState([]),[i,m]=d.useState(null),[h,u]=d.useState({}),[g,f]=d.useState(!1),[v,j]=d.useState({}),[A,T]=d.useState([]);d.useEffect(()=>{const t=n.getAvailableAdapters();a(t),m(n.getCurrentAdapter()),C()},[n]);const x=t=>{const r=new Date().toLocaleTimeString();T(o=>[`[${r}] ${t}`,...o.slice(0,19)])},C=()=>{const t={};s.forEach(r=>{t[r.name]=n.getPerformanceMetrics(r.name)}),u(t)},M=t=>{n.switchAdapter(t)?(m(n.getCurrentAdapter()),x(`切换到适配器: ${t}`)):x(`切换失败: ${t} 不可用`)},c=async t=>{const r=n.getCurrentAdapter();if(!n.switchAdapter(t)){x(`测试失败: ${t} 不可用`);return}f(!0),x(`开始测试适配器: ${t}`);try{const P=["users","posts","profile"],E=[];for(const N of P){const $=performance.now();try{const I=await n.executeRequest({url:`/api/${N}`,method:"GET"}),S=performance.now()-$;E.push({endpoint:N,success:!0,duration:Math.round(S),dataSize:JSON.stringify(I).length}),x(`${t} - ${N}: ${Math.round(S)}ms`)}catch(I){const S=performance.now()-$;E.push({endpoint:N,success:!1,duration:Math.round(S),error:I instanceof Error?I.message:"未知错误"}),x(`${t} - ${N}: 失败 (${Math.round(S)}ms)`)}}j(N=>({...N,[t]:E})),C(),x(`${t} 测试完成`)}catch(P){x(`${t} 测试异常: ${P instanceof Error?P.message:"未知错误"}`)}finally{f(!1),r&&(n.switchAdapter(r.name),m(r))}},l=async()=>{f(!0),x("开始性能测试...");for(const t of s)await c(t.name),await new Promise(r=>setTimeout(r,500));x("性能测试完成")},b=()=>{j({}),T([]),n.clearPerformanceData(),C(),x("测试数据已清空")},p=t=>({axios:"🔧",fetch:"🚀",xhr:"📡",simple:"⚡"})[t]||"❓",y=(t,r)=>r==="time"?t<200?"text-green-600":t<500?"text-yellow-600":"text-red-600":t>=95?"text-green-600":t>=80?"text-yellow-600":"text-red-600";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"可用适配器"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:s.map(t=>e.jsxs("div",{className:`p-4 rounded-lg border-2 cursor-pointer transition-all ${(i==null?void 0:i.name)===t.name?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>M(t.name),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-xl",children:p(t.name)}),e.jsx("span",{className:"font-medium",children:t.name})]}),(i==null?void 0:i.name)===t.name&&e.jsx("span",{className:"text-xs bg-blue-500 text-white px-2 py-1 rounded",children:"当前"})]}),e.jsxs("div",{className:"text-sm text-gray-600 mb-3",children:["支持平台: ",t.platform.join(", ")]}),e.jsx("div",{className:"flex space-x-2",children:e.jsx("button",{onClick:r=>{r.stopPropagation(),c(t.name)},disabled:g,className:"flex-1 px-3 py-1 text-xs bg-green-500 text-white rounded hover:bg-green-600 disabled:opacity-50",children:g?"测试中...":"测试"})})]},t.name))})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"性能统计"}),e.jsxs("div",{className:"space-x-2",children:[e.jsx("button",{onClick:l,disabled:g,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50",children:g?"测试中...":"运行性能测试"}),e.jsx("button",{onClick:b,className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",children:"清空数据"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left py-2",children:"适配器"}),e.jsx("th",{className:"text-center py-2",children:"请求次数"}),e.jsx("th",{className:"text-center py-2",children:"平均耗时"}),e.jsx("th",{className:"text-center py-2",children:"最小耗时"}),e.jsx("th",{className:"text-center py-2",children:"最大耗时"}),e.jsx("th",{className:"text-center py-2",children:"成功率"})]})}),e.jsx("tbody",{children:s.map(t=>{const r=h[t.name];return e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{children:p(t.name)}),e.jsx("span",{className:"font-medium",children:t.name})]})}),e.jsx("td",{className:"text-center py-3",children:(r==null?void 0:r.requestCount)||0}),e.jsxs("td",{className:`text-center py-3 font-medium ${y((r==null?void 0:r.averageTime)||0,"time")}`,children:[(r==null?void 0:r.averageTime)||0,"ms"]}),e.jsxs("td",{className:"text-center py-3",children:[(r==null?void 0:r.minTime)||0,"ms"]}),e.jsxs("td",{className:"text-center py-3",children:[(r==null?void 0:r.maxTime)||0,"ms"]}),e.jsxs("td",{className:`text-center py-3 font-medium ${y((r==null?void 0:r.successRate)||0,"rate")}`,children:[(r==null?void 0:r.successRate)||0,"%"]})]},t.name)})})]})})]}),Object.keys(v).length>0&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"测试结果"}),e.jsx("div",{className:"space-y-4",children:Object.entries(v).map(([t,r])=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("h4",{className:"font-medium mb-3 flex items-center space-x-2",children:[e.jsx("span",{children:p(t)}),e.jsx("span",{children:t})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:r.map((o,P)=>e.jsxs("div",{className:`p-3 rounded border-l-4 ${o.success?"border-green-400 bg-green-50":"border-red-400 bg-red-50"}`,children:[e.jsx("div",{className:"font-medium",children:o.endpoint}),e.jsxs("div",{className:"text-sm text-gray-600",children:["耗时: ",o.duration,"ms"]}),o.success&&o.dataSize&&e.jsxs("div",{className:"text-sm text-gray-600",children:["数据大小: ",o.dataSize," 字符"]}),o.error&&e.jsxs("div",{className:"text-sm text-red-600",children:["错误: ",o.error]})]},P))})]},t))})]}),A.length>0&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"操作日志"}),e.jsx("div",{className:"bg-gray-50 rounded p-4 max-h-60 overflow-y-auto",children:e.jsx("div",{className:"space-y-1 text-sm font-mono",children:A.map((t,r)=>e.jsx("div",{className:"text-gray-700",children:t},r))})})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-3 text-green-800",children:"适配器特性对比"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-green-700 mb-3",children:"性能特点"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{children:"🚀"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Fetch API:"})," 现代浏览器原生支持，性能最佳"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{children:"🔧"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Axios:"})," 功能丰富，拦截器和转换器支持"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{children:"📡"}),e.jsxs("span",{children:[e.jsx("strong",{children:"XMLHttpRequest:"})," 兼容性最好，支持老旧浏览器"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{children:"⚡"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Simple:"})," 轻量级实现，适合资源受限设备"]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-green-700 mb-3",children:"使用建议"}),e.jsxs("div",{className:"space-y-2 text-sm text-green-600",children:[e.jsx("div",{children:"• 现代Web应用优先选择Fetch API"}),e.jsx("div",{children:"• 需要丰富功能时选择Axios"}),e.jsx("div",{children:"• 兼容老旧浏览器时使用XMLHttpRequest"}),e.jsx("div",{children:"• 低端设备或TV/手表等选择Simple适配器"}),e.jsx("div",{children:"• 根据性能测试结果选择最适合的适配器"}),e.jsx("div",{children:"• 可以根据运行环境动态切换适配器"})]})]})]})]})]})},z=()=>{const[n]=d.useState(()=>new D),[s,a]=d.useState(n.getDeviceInfo()),[i]=d.useState(n.getPlatformConfiguration()),[m,h]=d.useState([]),[u,g]=d.useState(!1),[f,v]=d.useState([]);d.useEffect(()=>{const c=l=>{a(l),j(`设备信息更新: ${l.platform} - ${l.screenWidth}x${l.screenHeight}`)};return n.addDeviceInfoListener(c),()=>n.removeDeviceInfoListener(c)},[n]);const j=c=>{const l=new Date().toLocaleTimeString();v(b=>[`[${l}] ${c}`,...b.slice(0,9)])},A=async c=>{g(!0);const l=Date.now(),b=Math.random().toString(36).substr(2,9);try{j(`开始请求: ${c}`);const p=await n.executeRequest({url:`/api/${c}`,method:"GET"}),y=Date.now()-l,t=n.getCurrentAdapter(),r={id:b,timestamp:l,adapter:(t==null?void 0:t.name)||"unknown",url:`/api/${c}`,duration:y,success:!0};h(o=>[r,...o.slice(0,9)]),j(`请求成功: ${c} (${y}ms, 适配器: ${t==null?void 0:t.name})`),j(`返回数据: ${JSON.stringify(p).substring(0,100)}...`)}catch(p){const y=Date.now()-l,t=n.getCurrentAdapter(),r={id:b,timestamp:l,adapter:(t==null?void 0:t.name)||"unknown",url:`/api/${c}`,duration:y,success:!1,error:p instanceof Error?p.message:"未知错误"};h(o=>[r,...o.slice(0,9)]),j(`请求失败: ${c} - ${p instanceof Error?p.message:"未知错误"}`)}finally{g(!1)}},T=()=>{h([]),v([]),n.clearPerformanceData(),j("历史记录已清空")},x=c=>{if(c===0)return"0 B";const l=1024,b=["B","KB","MB","GB"],p=Math.floor(Math.log(c)/Math.log(l));return parseFloat((c/Math.pow(l,p)).toFixed(2))+" "+b[p]},C=c=>({web:"🌐",mobile:"📱",tablet:"📱",desktop:"💻",tv:"📺",watch:"⌚"})[c]||"❓",M=n.getCurrentAdapter();return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[C(s.platform)," 设备信息"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"平台类型"}),e.jsx("div",{className:"font-medium",children:s.platform})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"屏幕尺寸"}),e.jsxs("div",{className:"font-medium",children:[s.screenWidth," × ",s.screenHeight]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"像素比"}),e.jsxs("div",{className:"font-medium",children:[s.pixelRatio,"x"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"触摸支持"}),e.jsx("div",{className:"font-medium",children:s.touchSupport?"✅ 支持":"❌ 不支持"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"屏幕方向"}),e.jsx("div",{className:"font-medium",children:s.orientation==="portrait"?"📱 竖屏":"📱 横屏"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"网络类型"}),e.jsx("div",{className:"font-medium",children:s.connectionType||"未知"})]}),s.memory&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"设备内存"}),e.jsxs("div",{className:"font-medium",children:[s.memory," GB"]})]}),s.cores&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"CPU核心"}),e.jsxs("div",{className:"font-medium",children:[s.cores," 核"]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"平台配置"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"最大并发请求"}),e.jsx("div",{className:"font-medium",children:i.maxConcurrentRequests})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"超时时间"}),e.jsxs("div",{className:"font-medium",children:[i.timeout/1e3,"s"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"重试次数"}),e.jsx("div",{className:"font-medium",children:i.retryAttempts})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"缓存大小"}),e.jsx("div",{className:"font-medium",children:x(i.cacheSize)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"压缩启用"}),e.jsx("div",{className:"font-medium",children:i.compressionEnabled?"✅ 启用":"❌ 禁用"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"批处理"}),e.jsx("div",{className:"font-medium",children:i.batchingEnabled?"✅ 启用":"❌ 禁用"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"预取"}),e.jsx("div",{className:"font-medium",children:i.prefetchEnabled?"✅ 启用":"❌ 禁用"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"当前适配器"}),e.jsx("div",{className:"font-medium",children:(M==null?void 0:M.name)||"无"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"测试操作"}),e.jsxs("div",{className:"flex flex-wrap gap-3 mb-4",children:[e.jsx("button",{onClick:()=>A("users"),disabled:u,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed",children:u?"请求中...":"获取用户列表"}),e.jsx("button",{onClick:()=>A("posts"),disabled:u,className:"px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600 disabled:opacity-50 disabled:cursor-not-allowed",children:u?"请求中...":"获取文章列表"}),e.jsx("button",{onClick:()=>A("profile"),disabled:u,className:"px-4 py-2 bg-purple-500 text-white rounded hover:bg-purple-600 disabled:opacity-50 disabled:cursor-not-allowed",children:u?"请求中...":"获取用户资料"}),e.jsx("button",{onClick:T,className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",children:"清空历史"})]})]}),m.length>0&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"请求历史"}),e.jsx("div",{className:"space-y-2",children:m.map(c=>e.jsx("div",{className:`p-3 rounded border-l-4 ${c.success?"border-green-400 bg-green-50":"border-red-400 bg-red-50"}`,children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:c.url}),e.jsxs("div",{className:"text-sm text-gray-600",children:["适配器: ",c.adapter," | 耗时: ",c.duration,"ms"]}),c.error&&e.jsxs("div",{className:"text-sm text-red-600 mt-1",children:["错误: ",c.error]})]}),e.jsx("div",{className:"text-sm text-gray-500",children:new Date(c.timestamp).toLocaleTimeString()})]})},c.id))})]}),f.length>0&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"操作日志"}),e.jsx("div",{className:"bg-gray-50 rounded p-4 max-h-60 overflow-y-auto",children:e.jsx("div",{className:"space-y-1 text-sm font-mono",children:f.map((c,l)=>e.jsx("div",{className:"text-gray-700",children:c},l))})})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-3 text-blue-800",children:"功能特性"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-blue-700 mb-2",children:"自动平台检测"}),e.jsxs("ul",{className:"space-y-1 text-blue-600",children:[e.jsx("li",{children:"• 基于User Agent和屏幕尺寸识别设备类型"}),e.jsx("li",{children:"• 检测触摸支持、屏幕方向等硬件特性"}),e.jsx("li",{children:"• 获取网络类型、内存、CPU等性能信息"}),e.jsx("li",{children:"• 实时监听设备状态变化"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-blue-700 mb-2",children:"智能配置适配"}),e.jsxs("ul",{className:"space-y-1 text-blue-600",children:[e.jsx("li",{children:"• 根据平台特性调整并发数和超时时间"}),e.jsx("li",{children:"• 针对移动端优化缓存和流量使用"}),e.jsx("li",{children:"• 为低端设备提供简化配置"}),e.jsx("li",{children:"• 自动选择最佳请求适配器"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-blue-700 mb-2",children:"请求适配器"}),e.jsxs("ul",{className:"space-y-1 text-blue-600",children:[e.jsx("li",{children:"• 支持Axios、Fetch、XMLHttpRequest等"}),e.jsx("li",{children:"• 根据平台兼容性自动选择"}),e.jsx("li",{children:"• 提供统一的请求接口"}),e.jsx("li",{children:"• 支持手动切换适配器"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-blue-700 mb-2",children:"性能监控"}),e.jsxs("ul",{className:"space-y-1 text-blue-600",children:[e.jsx("li",{children:"• 记录请求耗时和成功率"}),e.jsx("li",{children:"• 提供详细的操作日志"}),e.jsx("li",{children:"• 支持性能数据分析"}),e.jsx("li",{children:"• 实时显示请求历史"})]})]})]})]})]})},W=()=>{const n=[{title:"核心概念",items:["多端支持是指在不同平台（Web、移动端、桌面端、TV等）上提供一致的功能体验，同时针对各平台的特性进行优化。通过适配器模式抽象平台差异，根据设备性能和网络环境调整请求策略。"]},{title:"主要优势",items:["统一的开发接口，降低多端开发复杂度","自动平台检测和配置适配，提升用户体验","针对性的性能优化，充分利用平台特性","良好的兼容性处理，支持各种设备和浏览器","灵活的适配器机制，易于扩展和维护"]},{title:"适用场景",items:["需要支持多种设备类型的Web应用","响应式设计需要根据设备调整功能","移动端和桌面端有不同的性能要求","需要兼容老旧浏览器或特殊设备","跨平台应用的统一数据层"]},{title:"注意事项",items:["平台检测应该基于特性而不是User Agent","配置参数需要考虑设备性能和网络限制","提供优雅的降级方案处理兼容性问题","避免过度复杂化，保持代码可维护性","充分测试各平台的功能和性能表现"]}];return e.jsx(L,{title:"多端支持",description:"实现跨平台的请求适配，根据不同设备和平台特性优化请求策略，提供统一的开发接口。",overview:n,examples:[{title:"基础多端支持",component:e.jsx(z,{}),description:"演示自动平台检测、配置适配和请求执行功能。",observationPoints:["观察设备信息面板，显示了当前平台的详细信息","查看平台配置，不同平台有不同的优化参数","执行测试请求，观察适配器选择和性能表现","尝试调整浏览器窗口大小，观察设备信息的变化","在不同设备上访问，比较平台检测的准确性"],keyPoints:["平台检测基于User Agent、屏幕尺寸、API支持等多个因素","每个平台都有针对性的配置优化，如并发数、超时时间等","适配器会根据平台支持情况自动选择最佳实现","性能监控帮助了解不同平台的请求表现"],commonTraps:["User Agent检测不准确或被伪造","平台配置过于激进导致兼容性问题","忽略设备性能差异导致卡顿","适配器选择逻辑不当影响功能"],solutions:["结合多种检测方法提高平台识别准确性","采用保守的默认配置，逐步优化","实现性能监控和自适应调整","提供手动适配器选择的备选方案"],importantTips:["设备信息会实时更新，包括屏幕方向变化等","平台配置针对不同设备的性能和网络特点进行了优化","请求历史显示了适配器使用情况和性能数据"]},{title:"适配器比较",component:e.jsx(U,{}),description:"比较不同请求适配器的性能和兼容性。",observationPoints:["查看当前平台支持的所有适配器","手动切换不同的适配器，观察功能差异","执行性能测试，比较各适配器的表现","观察性能统计数据，包括平均、最小、最大耗时","注意错误处理和兼容性差异"],keyPoints:["Fetch API通常性能最好但兼容性相对较差","XMLHttpRequest兼容性好但功能相对有限","简化适配器适用于资源受限的设备","性能测试帮助选择最适合的适配器"],commonTraps:["盲目选择最新的API而忽略兼容性","性能测试样本不足导致结论偏差","忽略错误处理的差异","适配器切换时状态不一致"],solutions:["实现渐进增强，优先保证基础功能","进行充分的性能测试和统计分析","统一错误处理接口","实现适配器状态管理和迁移"],importantTips:["适配器列表显示了当前平台的所有可用选项","性能测试会执行多个并发请求来评估适配器表现","统计数据包括成功和失败的请求，帮助全面评估"]}],tutorial:{concepts:["多端支持的核心是抽象化平台差异，提供统一的开发接口","适配器模式是实现多端支持的经典设计模式","平台检测需要综合考虑User Agent、API支持、硬件特性等因素","性能优化应该基于平台特性和用户体验需求","兼容性处理包括API polyfill、功能降级、错误处理等","测试策略需要覆盖目标平台的主要设备和浏览器"],steps:["分析目标平台和设备，确定支持范围和优先级","设计平台检测机制，识别运行环境和设备特性","定义统一的请求接口和配置结构","实现各平台的适配器，处理API差异和兼容性","设计平台特定的配置和优化策略","实现适配器选择和切换机制","添加性能监控和错误处理","进行跨平台测试和性能优化"],tips:["使用特性检测而不是浏览器检测来判断API支持","实现渐进增强，确保基础功能在所有平台上可用","考虑设备性能差异，为低端设备提供优化方案","提供配置选项，允许开发者根据需求调整行为","实现完善的错误处理和降级机制","使用自动化测试覆盖主要平台和设备","监控实际使用中的性能数据，持续优化","保持代码的可维护性，避免过度复杂的适配逻辑"]},interview:{questions:[{question:"如何实现跨平台的请求适配？",answer:"实现跨平台请求适配主要包括：1) 平台检测：识别运行环境和设备特性；2) 适配器模式：为不同平台实现统一接口；3) 配置管理：根据平台特性调整参数；4) 兼容性处理：提供API polyfill和降级方案；5) 性能优化：针对平台特点优化请求策略；6) 错误处理：统一异常处理和恢复机制。"},{question:"移动端和桌面端的请求优化有什么区别？",answer:"主要区别包括：1) 网络环境：移动端网络不稳定，需要更短的超时时间和更多重试；2) 性能限制：移动端CPU和内存有限，需要减少并发请求数；3) 电池消耗：移动端需要考虑省电，减少不必要的网络请求；4) 流量成本：移动端需要启用压缩，禁用预取；5) 交互方式：移动端触摸操作，桌面端鼠标键盘；6) 屏幕尺寸：影响数据加载策略和UI适配。"},{question:"如何处理不同平台的API兼容性问题？",answer:"API兼容性处理策略：1) 特性检测：使用typeof、in操作符检测API支持；2) Polyfill：为不支持的API提供兼容实现；3) 适配器模式：抽象API差异，提供统一接口；4) 渐进增强：优先保证基础功能，逐步增强；5) 降级处理：当高级功能不可用时提供替代方案；6) 条件加载：根据平台动态加载相应的实现；7) 错误边界：捕获和处理兼容性错误。"},{question:"多端应用的性能监控策略是什么？",answer:"性能监控策略包括：1) 平台分类：按设备类型、操作系统、浏览器分类监控；2) 关键指标：请求耗时、成功率、错误类型、资源使用；3) 实时监控：使用Performance API收集性能数据；4) 数据上报：定期或触发式上报监控数据；5) 阈值告警：设置平台特定的性能阈值；6) 趋势分析：分析性能变化趋势和异常；7) 优化反馈：基于监控数据调整配置和策略。"},{question:"如何设计可扩展的多端支持架构？",answer:"可扩展架构设计：1) 插件化：将平台支持设计为可插拔的模块；2) 配置驱动：通过配置文件定义平台特性和策略；3) 接口抽象：定义清晰的适配器接口和生命周期；4) 工厂模式：使用工厂创建和管理适配器实例；5) 策略模式：将平台特定逻辑封装为策略；6) 观察者模式：监听平台变化和状态更新；7) 版本管理：支持适配器的版本控制和升级；8) 文档规范：提供清晰的扩展指南和API文档。"}],keyPoints:["多端支持需要平衡功能一致性和平台特性优化","适配器模式是实现多端支持的核心设计模式","平台检测应该基于特性而不是User Agent","性能优化必须考虑不同平台的硬件和网络限制","兼容性处理需要提供优雅的降级方案","测试和监控是确保多端支持质量的关键"]},bestPractices:{dos:["使用特性检测而不是浏览器检测","实现渐进增强，确保基础功能可用","根据平台特性优化配置参数","提供统一的API接口和错误处理","实现完善的性能监控和分析","进行充分的跨平台测试","保持代码的模块化和可维护性","提供清晰的文档和使用指南"],donts:["不要依赖不稳定的User Agent检测","不要忽略低端设备的性能限制","不要为了功能完整性牺牲兼容性","不要忽略平台特定的用户体验","不要过度复杂化适配逻辑","不要忽略错误处理和降级方案","不要缺少性能监控和优化","不要忽略新平台和设备的支持"],patterns:["使用Adapter模式抽象平台差异","实现Factory模式创建适配器实例","使用Strategy模式处理平台特定逻辑","实现Observer模式监听平台变化","使用Command模式封装平台操作","实现Chain of Responsibility处理兼容性","使用Facade模式简化多端接口","实现Plugin模式支持扩展"]}})};export{W as default};
