import{r as reactExports,e as commonjsGlobal,g as getDefaultExportFromCjs,R as React,c as reactDomExports}from"./react-dRafwyeL.js";import{p as produce}from"./immer-B7fdkLVi.js";import{c as create}from"./zustand-DvNNt4Qg.js";import{R as RefIcon,I as Image$1,a as RefIcon$1,d as dayjs,b as RefIcon$2,Q as QRCode,c as RefIcon$3,F as ForwardTable,T as Tooltip,B as Button,e as RefIcon$4,f as RefIcon$5,g as RefIcon$6,h as RefIcon$7,i as RefIcon$8,j as RefIcon$9,D as Divider,k as RefIcon$a,l as RefIcon$b,m as RefIcon$c,n as RefIcon$d,o as RefIcon$e,p as RefIcon$f,q as RefIcon$g,r as RefIcon$h,S as Switch,s as TypedInputNumber,t as Dropdown,u as Input,v as Select,w as Space,x as Drawer,y as Tabs,M as Modal,z as RefIcon$i,A as RefIcon$j,C as RefIcon$k,E as RefIcon$l,G as RefIcon$m,H as RefIcon$n,L as List,J as staticMethods,K as Layout}from"./antd-xknMu7qQ.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const d of a.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&r(d)}).observe(document,{childList:!0,subtree:!0});function o(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=o(s);fetch(s.href,a)}})();var jsxRuntime={exports:{}},reactJsxRuntime_production_min={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f=reactExports,k=Symbol.for("react.element"),l=Symbol.for("react.fragment"),m$1=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p={key:!0,ref:!0,__self:!0,__source:!0};function q(e,t,o){var r,s={},a=null,d=null;o!==void 0&&(a=""+o),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(d=t.ref);for(r in t)m$1.call(t,r)&&!p.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)s[r]===void 0&&(s[r]=t[r]);return{$$typeof:k,type:e,key:a,ref:d,props:s,_owner:n.current}}reactJsxRuntime_production_min.Fragment=l;reactJsxRuntime_production_min.jsx=q;reactJsxRuntime_production_min.jsxs=q;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports;const __vite_import_meta_env__={BASE_URL:"./",DEV:!1,MODE:"production",PROD:!0,SSR:!1},trackedConnections=new Map,getTrackedConnectionState=e=>{const t=trackedConnections.get(e);return t?Object.fromEntries(Object.entries(t.stores).map(([o,r])=>[o,r.getState()])):{}},extractConnectionInformation=(e,t,o)=>{if(e===void 0)return{type:"untracked",connection:t.connect(o)};const r=trackedConnections.get(o.name);if(r)return{type:"tracked",store:e,...r};const s={connection:t.connect(o),stores:{}};return trackedConnections.set(o.name,s),{type:"tracked",store:e,...s}},devtoolsImpl=(e,t={})=>(o,r,s)=>{const{enabled:a,anonymousActionType:d,store:g,...v}=t;let i;try{i=(a??(__vite_import_meta_env__?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!i)return e(o,r,s);const{connection:c,...h}=extractConnectionInformation(g,i,v);let x=!0;s.setState=(R,S,b)=>{const y=o(R,S);if(!x)return y;const j=b===void 0?{type:d||"anonymous"}:typeof b=="string"?{type:b}:b;return g===void 0?(c?.send(j,r()),y):(c?.send({...j,type:`${g}/${j.type}`},{...getTrackedConnectionState(v.name),[g]:s.getState()}),y)};const u=(...R)=>{const S=x;x=!1,o(...R),x=S},E=e(s.setState,r,s);if(h.type==="untracked"?c?.init(E):(h.stores[h.store]=s,c?.init(Object.fromEntries(Object.entries(h.stores).map(([R,S])=>[R,R===h.store?E:S.getState()])))),s.dispatchFromDevtools&&typeof s.dispatch=="function"){let R=!1;const S=s.dispatch;s.dispatch=(...b)=>{(__vite_import_meta_env__?"production":void 0)!=="production"&&b[0].type==="__setState"&&!R&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),R=!0),S(...b)}}return c.subscribe(R=>{var S;switch(R.type){case"ACTION":if(typeof R.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return parseJsonThen(R.payload,b=>{if(b.type==="__setState"){if(g===void 0){u(b.state);return}Object.keys(b.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format.
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const y=b.state[g];if(y==null)return;JSON.stringify(s.getState())!==JSON.stringify(y)&&u(y);return}s.dispatchFromDevtools&&typeof s.dispatch=="function"&&s.dispatch(b)});case"DISPATCH":switch(R.payload.type){case"RESET":return u(E),g===void 0?c?.init(s.getState()):c?.init(getTrackedConnectionState(v.name));case"COMMIT":if(g===void 0){c?.init(s.getState());return}return c?.init(getTrackedConnectionState(v.name));case"ROLLBACK":return parseJsonThen(R.state,b=>{if(g===void 0){u(b),c?.init(s.getState());return}u(b[g]),c?.init(getTrackedConnectionState(v.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return parseJsonThen(R.state,b=>{if(g===void 0){u(b);return}JSON.stringify(s.getState())!==JSON.stringify(b[g])&&u(b[g])});case"IMPORT_STATE":{const{nextLiftedState:b}=R.payload,y=(S=b.computedStates.slice(-1)[0])==null?void 0:S.state;if(!y)return;u(g===void 0?y:y[g]),c?.send(null,b);return}case"PAUSE_RECORDING":return x=!x}return}}),E},devtools=devtoolsImpl,parseJsonThen=(e,t)=>{let o;try{o=JSON.parse(e)}catch(r){console.error("[zustand devtools middleware] Could not parse the received json",r)}o!==void 0&&t(o)};function createJSONStorage(e,t){let o;try{o=e()}catch{return}return{getItem:s=>{var a;const d=v=>v===null?null:JSON.parse(v,void 0),g=(a=o.getItem(s))!=null?a:null;return g instanceof Promise?g.then(d):d(g)},setItem:(s,a)=>o.setItem(s,JSON.stringify(a,void 0)),removeItem:s=>o.removeItem(s)}}const toThenable=e=>t=>{try{const o=e(t);return o instanceof Promise?o:{then(r){return toThenable(r)(o)},catch(r){return this}}}catch(o){return{then(r){return this},catch(r){return toThenable(r)(o)}}}},persistImpl=(e,t)=>(o,r,s)=>{let a={storage:createJSONStorage(()=>localStorage),partialize:R=>R,version:0,merge:(R,S)=>({...S,...R}),...t},d=!1;const g=new Set,v=new Set;let i=a.storage;if(!i)return e((...R)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),o(...R)},r,s);const c=()=>{const R=a.partialize({...r()});return i.setItem(a.name,{state:R,version:a.version})},h=s.setState;s.setState=(R,S)=>{h(R,S),c()};const x=e((...R)=>{o(...R),c()},r,s);s.getInitialState=()=>x;let u;const E=()=>{var R,S;if(!i)return;d=!1,g.forEach(y=>{var j;return y((j=r())!=null?j:x)});const b=((S=a.onRehydrateStorage)==null?void 0:S.call(a,(R=r())!=null?R:x))||void 0;return toThenable(i.getItem.bind(i))(a.name).then(y=>{if(y)if(typeof y.version=="number"&&y.version!==a.version){if(a.migrate){const j=a.migrate(y.state,y.version);return j instanceof Promise?j.then(M=>[!0,M]):[!0,j]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,y.state];return[!1,void 0]}).then(y=>{var j;const[M,D]=y;if(u=a.merge(D,(j=r())!=null?j:x),o(u,!0),M)return c()}).then(()=>{b?.(u,void 0),u=r(),d=!0,v.forEach(y=>y(u))}).catch(y=>{b?.(void 0,y)})};return s.persist={setOptions:R=>{a={...a,...R},R.storage&&(i=R.storage)},clearStorage:()=>{i?.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>E(),hasHydrated:()=>d,onHydrate:R=>(g.add(R),()=>{g.delete(R)}),onFinishHydration:R=>(v.add(R),()=>{v.delete(R)})},a.skipHydration||E(),u||x},persist=persistImpl,immerImpl=e=>(t,o,r)=>(r.setState=(s,a,...d)=>{const g=typeof s=="function"?produce(s):s;return t(g,a,...d)},e(r.setState,o,r)),immer=immerImpl,useComponentsStore=create()(persist(devtools(immer((e,t)=>({components:[],history:{undoStack:[],redoStack:[]},takeSnapshot:()=>{const{components:o}=t(),r=JSON.parse(JSON.stringify(o));e(s=>{s.history.undoStack.push(r),s.history.redoStack=[]})},undo:()=>{const{history:o}=t();o.undoStack.length!==0&&e(r=>{const s=r.history.undoStack.pop();s&&(r.history.redoStack.push(JSON.parse(JSON.stringify(r.components))),r.components=s)})},redo:()=>{const{history:o}=t();o.redoStack.length!==0&&e(r=>{const s=r.history.redoStack.pop();s&&(r.history.undoStack.push(JSON.parse(JSON.stringify(r.components))),r.components=s)})},setComponents:o=>{t().takeSnapshot(),e({components:o})},addComponent:o=>{t().takeSnapshot(),e(r=>{if(!o.name){const a=o.type||"Component",g=r.components.filter(v=>v.type===a).reduce((v,i)=>{const c=i.name&&i.name.match(new RegExp(`^${a}(\\d+)$`));return c?Math.max(v,parseInt(c[1],10)):v},0);o.name=`${a}${g+1}`}const s=r.components.length>0?Math.max(...r.components.map(a=>a.zindex??1)):0;o.zindex=s+1,r.components.push(o)})},updateComponent:(o,r)=>{t().takeSnapshot(),e(s=>{const a=s.components.findIndex(d=>d.id===o);a!==-1&&(s.components[a]={...s.components[a],...r})})},removeComponent:o=>{t().takeSnapshot(),e(r=>{r.components=r.components.filter(s=>s.id!==o)})},batchUpdateComponent:(o,r)=>{t().takeSnapshot(),e(s=>{s.components.forEach(a=>{o.includes(a.id)&&Object.assign(a,r)})})},batchRemoveComponent:o=>{t().takeSnapshot(),e(r=>{r.components=r.components.filter(s=>!o.includes(s.id))})},batchLockComponent:(o,r)=>{t().takeSnapshot(),e(s=>{s.components.forEach(a=>{o.includes(a.id)&&(a.locked=r)})})},batchVisibleComponent:(o,r)=>{t().takeSnapshot(),e(s=>{s.components.forEach(a=>{o.includes(a.id)&&(a.visible=r)})})},copyComponent:o=>{t().takeSnapshot(),e(r=>{const s=r.components.find(d=>d.id===o);if(!s)return;const a={...s,id:`${s.id}_copy_${Date.now()}`};r.components.push(a)})},moveComponentZIndex:(o,r)=>{t().takeSnapshot(),e(s=>{const a=s.components,d=a.findIndex(x=>x.id===o);if(d===-1)return;const g=a[d],v=a.slice().sort((x,u)=>(x.zindex??1)-(u.zindex??1)),i=v.map(x=>x.zindex??1);let c=g.zindex??1;if(r==="top")c=Math.max(...i)+1;else if(r==="bottom")c=Math.min(...i)-1;else if(r==="up"){const x=v.find(u=>(u.zindex??1)>(g.zindex??1));if(x){const u=x.zindex;x.zindex=g.zindex,c=u}}else if(r==="down"){const x=[...v].reverse().find(u=>(u.zindex??1)<(g.zindex??1));if(x){const u=x.zindex;x.zindex=g.zindex,c=u}}g.zindex=c,Array.from(new Set(a.map(x=>x.zindex??1))).sort((x,u)=>x-u).forEach((x,u)=>{a.filter(E=>E.zindex===x).forEach(E=>E.zindex=u+1)})})}}))),{name:"components-storage"})),useSelectionStore=create()(devtools(immer(e=>({selectedIds:[],setSelectedIds:t=>e({selectedIds:t})})))),defaultConfig={gridSize:20,showGrid:!0,showRuler:!0,rulerUnit:"px",allowSnapToGrid:!0,snapToGrid:!0,width:1123,height:794,sizeType:"A4-landscape"},useCanvasStore=create()(persist(devtools(immer(e=>({canvasConfig:defaultConfig,setCanvasConfig:t=>e(o=>{o.canvasConfig={...o.canvasConfig,...t}})}))),{name:"canvas-storage"})),mockUsers=[{id:1,name:"张三",phone:"123456",address:"北京市朝阳区",photo:"https://img10.360buyimg.com/n5/s720x720_jfs/t1/264853/36/29513/79746/67cab1a8Fdb73c2a0/79a1ef61d6914813.jpg.avif",orders:[{id:"order-1-0",orderId:"A001",product:"苹果",amount:5,date:"2024-06-01"},{id:"order-1-1",orderId:"A002",product:"香蕉",amount:2,date:"2024-06-02"},{id:"order-1-2",orderId:"A003",product:"梨",amount:1,date:"2024-06-03"},{id:"order-1-3",orderId:"A004",product:"葡萄",amount:8,date:"2024-06-04"},{id:"order-1-4",orderId:"A005",product:"西瓜",amount:3,date:"2024-06-05"},{id:"order-1-5",orderId:"A006",product:"橙子",amount:4,date:"2024-06-06"},{id:"order-1-6",orderId:"A007",product:"柚子",amount:2,date:"2024-06-07"},{id:"order-1-7",orderId:"A008",product:"草莓",amount:6,date:"2024-06-08"},{id:"order-1-8",orderId:"A009",product:"蓝莓",amount:1,date:"2024-06-09"},{id:"order-1-9",orderId:"A010",product:"樱桃",amount:7,date:"2024-06-10"}],favoritesList:[{id:"favorite-1-0",listName:"水果清单",createdAt:"2024-05-20"},{id:"favorite-1-1",listName:"零食清单",createdAt:"2024-05-25"},{id:"favorite-1-2",listName:"饮料清单",createdAt:"2024-05-30"},{id:"favorite-1-3",listName:"酒水清单",createdAt:"2024-05-31"},{id:"favorite-1-4",listName:"电子产品收藏",createdAt:"2024-06-01"},{id:"favorite-1-5",listName:"服装配饰收藏",createdAt:"2024-06-02"},{id:"favorite-1-6",listName:"家居用品收藏",createdAt:"2024-06-03"},{id:"favorite-1-7",listName:"美妆护肤收藏",createdAt:"2024-06-04"},{id:"favorite-1-8",listName:"图书音像收藏",createdAt:"2024-06-05"},{id:"favorite-1-9",listName:"母婴用品收藏",createdAt:"2024-06-06"},{id:"favorite-1-10",listName:"运动户外收藏",createdAt:"2024-06-07"},{id:"favorite-1-11",listName:"数码家电收藏",createdAt:"2024-06-08"},{id:"favorite-1-12",listName:"个护清洁收藏",createdAt:"2024-06-09"}]},{id:2,name:"李四",phone:"654321",address:"上海市浦东新区",photo:"https://img13.360buyimg.com/n5/s720x720_jfs/t1/261011/19/4060/78338/676e6932F64cf6e0e/fc5d7a4011a6e23c.jpg.avif",orders:[{id:"order-2-0",orderId:"B001",product:"橙子",amount:3,date:"2024-06-03"},{id:"order-2-1",orderId:"B002",product:"柠檬",amount:2,date:"2024-06-04"},{id:"order-2-2",orderId:"B003",product:"猕猴桃",amount:5,date:"2024-06-05"},{id:"order-2-3",orderId:"B004",product:"火龙果",amount:1,date:"2024-06-06"},{id:"order-2-4",orderId:"B005",product:"哈密瓜",amount:4,date:"2024-06-07"},{id:"order-2-5",orderId:"B006",product:"榴莲",amount:1,date:"2024-06-08"},{id:"order-2-6",orderId:"B007",product:"山竹",amount:2,date:"2024-06-09"},{id:"order-2-7",orderId:"B008",product:"荔枝",amount:6,date:"2024-06-10"},{id:"order-2-8",orderId:"B009",product:"龙眼",amount:1,date:"2024-06-11"},{id:"order-2-9",orderId:"B010",product:"苹果",amount:7,date:"2024-06-12"},{id:"order-2-10",orderId:"B011",product:"香蕉",amount:2,date:"2024-06-13"},{id:"order-2-11",orderId:"B012",product:"葡萄",amount:3,date:"2024-06-14"}],favoritesList:[{id:"favorite-2-0",listName:"家用电器收藏",createdAt:"2024-05-18"},{id:"favorite-2-1",listName:"图书收藏",createdAt:"2024-05-22"}]},{id:3,name:"王五",phone:"111222",address:"广州市天河区",photo:"https://img11.360buyimg.com/n1/s720x720_jfs/t1/165202/15/38236/30673/64b77e10F1467aed7/2d9958b25e62abfd.jpg",orders:[],favoritesList:[{id:"favorite-3-0",listName:"运动装备收藏",createdAt:"2024-05-10"}]},{id:4,name:"赵六",phone:"333444",address:"深圳市南山区",photo:"https://img12.360buyimg.com/n5/s720x720_jfs/t1/268364/37/24768/64411/67bebad4F75899c42/311cacde83b9424d.jpg",orders:[{id:"order-4-0",orderId:"C001",product:"橙子",amount:3,date:"2024-06-03"}],favoritesList:[{id:"favorite-4-0",listName:"美妆收藏",createdAt:"2024-05-28"}]}],mockProducts=[{id:1,name:"苹果",price:5.99,stock:100,category:"水果",image:"https://img10.360buyimg.com/n5/s720x720_jfs/t1/264853/36/29513/79746/67cab1a8Fdb73c2a0/79a1ef61d6914813.jpg.avif",relatedProducts:[{id:"related-1-0",name:"香蕉",price:3.49},{id:"related-1-1",name:"橙子",price:6.49}]},{id:2,name:"香蕉",price:3.49,stock:150,category:"水果",image:"https://img13.360buyimg.com/n5/s720x720_jfs/t1/261011/19/4060/78338/676e6932F64cf6e0e/fc5d7a4011a6e23c.jpg.avif",relatedProducts:[{id:"related-2-0",name:"苹果",price:5.99},{id:"related-2-1",name:"猕猴桃",price:7.49}]},{id:3,name:"梨",price:4.29,stock:80,category:"水果",image:"https://img11.360buyimg.com/n1/s720x720_jfs/t1/165202/15/38236/30673/64b77e10F1467aed7/2d9958b25e62abfd.jpg",relatedProducts:[{id:"related-3-0",name:"柚子",price:9.99}]},{id:4,name:"葡萄",price:8.99,stock:60,category:"水果",image:"https://img12.360buyimg.com/n5/s720x720_jfs/t1/268364/37/24768/64411/67bebad4F75899c42/311cacde83b9424d.jpg",relatedProducts:[{id:"related-4-0",name:"草莓",price:15.99},{id:"related-4-1",name:"蓝莓",price:19.99}]},{id:5,name:"西瓜",price:12.99,stock:30,category:"水果",image:"https://img10.360buyimg.com/n5/s720x720_jfs/t1/264853/36/29513/79746/67cab1a8Fdb73c2a0/79a1ef61d6914813.jpg.avif",relatedProducts:[{id:"related-5-0",name:"哈密瓜",price:14.99}]},{id:6,name:"橙子",price:6.49,stock:90,category:"水果",image:"https://img13.360buyimg.com/n5/s720x720_jfs/t1/261011/19/4060/78338/676e6932F64cf6e0e/fc5d7a4011a6e23c.jpg.avif",relatedProducts:[{id:"related-6-0",name:"柠檬",price:4.99},{id:"related-6-1",name:"苹果",price:5.99}]},{id:7,name:"柚子",price:9.99,stock:40,category:"水果",image:"https://img11.360buyimg.com/n1/s720x720_jfs/t1/165202/15/38236/30673/64b77e10F1467aed7/2d9958b25e62abfd.jpg",relatedProducts:[{id:"related-7-0",name:"梨",price:4.29}]},{id:8,name:"草莓",price:15.99,stock:50,category:"水果",image:"https://img12.360buyimg.com/n5/s720x720_jfs/t1/268364/37/24768/64411/67bebad4F75899c42/311cacde83b9424d.jpg",relatedProducts:[{id:"related-8-0",name:"草莓",price:15.99},{id:"related-8-1",name:"樱桃",price:22.99}]},{id:9,name:"蓝莓",price:19.99,stock:20,category:"水果",image:"https://img10.360buyimg.com/n5/s720x720_jfs/t1/264853/36/29513/79746/67cab1a8Fdb73c2a0/79a1ef61d6914813.jpg.avif",relatedProducts:[{id:"related-9-0",name:"草莓",price:15.99},{id:"related-9-1",name:"葡萄",price:8.99}]},{id:10,name:"樱桃",price:22.99,stock:25,category:"水果",image:"https://img13.360buyimg.com/n5/s720x720_jfs/t1/261011/19/4060/78338/676e6932F64cf6e0e/fc5d7a4011a6e23c.jpg.avif",relatedProducts:[{id:"related-10-0",name:"草莓",price:15.99}]},{id:11,name:"柠檬",price:4.99,stock:70,category:"水果",image:"https://img11.360buyimg.com/n1/s720x720_jfs/t1/165202/15/38236/30673/64b77e10F1467aed7/2d9958b25e62abfd.jpg",relatedProducts:[{id:"related-11-0",name:"橙子",price:6.49}]},{id:12,name:"猕猴桃",price:7.49,stock:85,category:"水果",image:"https://img12.360buyimg.com/n5/s720x720_jfs/t1/268364/37/24768/64411/67bebad4F75899c42/311cacde83b9424d.jpg",relatedProducts:[{id:"related-12-0",name:"香蕉",price:3.49}]},{id:13,name:"火龙果",price:11.99,stock:35,category:"水果",image:"https://img10.360buyimg.com/n5/s720x720_jfs/t1/264853/36/29513/79746/67cab1a8Fdb73c2a0/79a1ef61d6914813.jpg.avif",relatedProducts:[{id:"related-13-0",name:"榴莲",price:29.99}]},{id:14,name:"哈密瓜",price:14.99,stock:20,category:"水果",image:"https://img13.360buyimg.com/n5/s720x720_jfs/t1/261011/19/4060/78338/676e6932F64cf6e0e/fc5d7a4011a6e23c.jpg.avif",relatedProducts:[{id:"related-14-0",name:"西瓜",price:12.99}]},{id:15,name:"榴莲",price:29.99,stock:10,category:"水果",image:"https://img11.360buyimg.com/n1/s720x1080_jfs/t1/165202/15/38236/30673/64b77e10F1467aed7/2d9958b25e62abfd.jpg",relatedProducts:[{id:"related-15-0",name:"火龙果",price:11.99}]},{id:16,name:"山竹",price:18.99,stock:15,category:"水果",image:"https://img12.360buyimg.com/n5/s720x720_jfs/t1/268364/37/24768/64411/67bebad4F75899c42/311cacde83b9424d.jpg",relatedProducts:[{id:"related-16-0",name:"荔枝",price:16.99}]},{id:17,name:"荔枝",price:16.99,stock:30,category:"水果",image:"https://img10.360buyimg.com/n5/s720x720_jfs/t1/264853/36/29513/79746/67cab1a8Fdb73c2a0/79a1ef61d6914813.jpg.avif",relatedProducts:[{id:"related-17-0",name:"山竹",price:18.99},{id:"related-17-1",name:"龙眼",price:13.99}]},{id:18,name:"龙眼",price:13.99,stock:40,category:"水果",image:"https://img13.360buyimg.com/n5/s720x720_jfs/t1/261011/19/4060/78338/676e6932F64cf6e0e/fc5d7a4011a6e23c.jpg.avif",relatedProducts:[{id:"related-18-0",name:"荔枝",price:16.99}]}],initialDataSources=[{key:"users",name:"用户",fields:["id","name","phone","address","photo","favoritesList"],dataNodes:["orders","favoritesList"],dataNodeFields:{orders:["orderId","product","amount","date"],favoritesList:["listName","createdAt"]},sample:mockUsers[0],data:mockUsers},{key:"products",name:"产品",fields:["id","name","price","stock","category","image"],dataNodes:["relatedProducts"],dataNodeFields:{relatedProducts:["id","name","price"]},sample:mockProducts[0],data:mockProducts}],useDataSourceStore=create()(persist(devtools(immer(e=>({dataSources:initialDataSources,addDataSource:t=>e(o=>({dataSources:[...o.dataSources,t]})),removeDataSource:t=>e(o=>({dataSources:o.dataSources.filter(r=>r.key!==t)}))}))),{name:"dataSource-storage"})),svgPlaceholder="data:image/svg+xml;utf8,"+encodeURIComponent(`
    <svg width='120' height='40' xmlns='http://www.w3.org/2000/svg'>
      <rect width='120' height='40' fill='#c8c8c8' stroke='#c8c8c8'/>
      <text x='50%' y='50%' dominant-baseline='middle' text-anchor='middle' fill='#767676' font-size='16'>图片</text>
    </svg>
  `),ImageWidget=e=>{const t=useComponentsStore(h=>h.components),o=e.componentId?t.find(h=>h.id===e.componentId):void 0,r=o?{...e,...o.props}:e,{width:s=120,height:a=40,alt:d="图片",style:g={},dataBinding:v}=r,i=useDataSourceStore(h=>h.dataSources);let c=svgPlaceholder;if(e.bindingData)typeof e.bindingData=="string"&&e.bindingData.trim()&&(c=e.bindingData);else if(v?.dataSource&&v?.field){const h=i.find(x=>x.key===v.dataSource);if(h&&h.sample){const x=h.sample[v.field];typeof x=="string"&&x.trim()&&(c=x)}}return jsxRuntimeExports.jsx(Image$1,{src:c,width:s,height:a,alt:d,style:{...g,objectFit:"contain",borderRadius:4},preview:!1,fallback:svgPlaceholder})},ImageWidgetMeta={type:"image",displayName:"图片",Component:ImageWidget,icon:jsxRuntimeExports.jsx(RefIcon,{})},__vite_glob_0_0=Object.freeze(Object.defineProperty({__proto__:null,ImageWidgetMeta,default:ImageWidget},Symbol.toStringTag,{value:"Module"}));function formatLabelValue(value,dataBinding,numeral,dayjs){let displayText=value;const format=dataBinding?.format,pattern=dataBinding?.formatPattern;if(displayText!=null){if(format==="number"&&pattern&&!isNaN(Number(displayText)))displayText=numeral(displayText).format(pattern);else if(format==="percent")if(pattern&&pattern.includes("%"))displayText=numeral(displayText).format(pattern);else{const e=Number(displayText);isNaN(e)||(displayText=(e*100).toFixed(pattern?parseInt(pattern.replace(/[^0-9]/g,""))||0:2)+"%")}else if(format==="currency"){const e=pattern&&pattern.includes("$")?"$":"￥";pattern?displayText=e+numeral(displayText).format(pattern.replace(/^[￥$]/,"")):displayText=e+numeral(displayText).format("0,0.00")}else if(format==="date"&&pattern)displayText=dayjs(displayText).format(pattern);else if(format==="custom"&&dataBinding?.customFormat)try{const custom=dataBinding.customFormat.trim();let fn;custom.startsWith("function")||custom.startsWith("value =>")?fn=eval("("+custom+")"):fn=new Function("value","return "+custom+";"),displayText=fn(displayText)}catch{}}return displayText}function getJustifyContent(e="left"){return e==="center"?"center":e==="right"?"flex-end":"flex-start"}function getAlignUpdates(e,t,o){const r=e.filter(a=>t.includes(a.id));if(r.length<2)return{};const s={};if(["left","right","top","bottom"].includes(o)){if(o==="left"){const a=Math.min(...r.map(d=>d.x));r.forEach(d=>s[d.id]={x:a})}else if(o==="right"){const a=Math.max(...r.map(d=>d.x+d.width));r.forEach(d=>s[d.id]={x:a-d.width})}else if(o==="top"){const a=Math.min(...r.map(d=>d.y));r.forEach(d=>s[d.id]={y:a})}else if(o==="bottom"){const a=Math.max(...r.map(d=>d.y+d.height));r.forEach(d=>s[d.id]={y:a-d.height})}}else if(o==="hcenter"){const a=Math.min(...r.map(v=>v.x)),d=Math.max(...r.map(v=>v.x+v.width)),g=(a+d)/2;r.forEach(v=>s[v.id]={x:g-v.width/2})}else if(o==="vcenter"){const a=Math.min(...r.map(v=>v.y)),d=Math.max(...r.map(v=>v.y+v.height)),g=(a+d)/2;r.forEach(v=>s[v.id]={y:g-v.height/2})}return s}function getDistributeUpdates(e,t,o){const r=e.filter(a=>t.includes(a.id));if(r.length<3)return{};const s={};if(o==="horizontal"){const a=[...r].sort((h,x)=>h.x-x.x),d=a[0].x,g=a[a.length-1].x+a[a.length-1].width,v=a.reduce((h,x)=>h+x.width,0),i=(g-d-v)/(a.length-1);let c=d;a.forEach(h=>{s[h.id]={x:c},c+=h.width+i})}else if(o==="vertical"){const a=[...r].sort((h,x)=>h.y-x.y),d=a[0].y,g=a[a.length-1].y+a[a.length-1].height,v=a.reduce((h,x)=>h+x.height,0),i=(g-d-v)/(a.length-1);let c=d;a.forEach(h=>{s[h.id]={y:c},c+=h.height+i})}return s}var numeral$1={exports:{}};/*! @preserve
 * numeral.js
 * version : 2.0.6
 * author : Adam Draper
 * license : MIT
 * http://adamwdraper.github.com/Numeral-js/
 */(function(e){(function(t,o){e.exports?e.exports=o():t.numeral=o()})(commonjsGlobal,function(){var t,o,r="2.0.6",s={},a={},d={currentLocale:"en",zeroFormat:null,nullFormat:null,defaultFormat:"0,0",scalePercentBy100:!0},g={currentLocale:d.currentLocale,zeroFormat:d.zeroFormat,nullFormat:d.nullFormat,defaultFormat:d.defaultFormat,scalePercentBy100:d.scalePercentBy100};function v(i,c){this._input=i,this._value=c}return t=function(i){var c,h,x,u;if(t.isNumeral(i))c=i.value();else if(i===0||typeof i>"u")c=0;else if(i===null||o.isNaN(i))c=null;else if(typeof i=="string")if(g.zeroFormat&&i===g.zeroFormat)c=0;else if(g.nullFormat&&i===g.nullFormat||!i.replace(/[^0-9]+/g,"").length)c=null;else{for(h in s)if(u=typeof s[h].regexps.unformat=="function"?s[h].regexps.unformat():s[h].regexps.unformat,u&&i.match(u)){x=s[h].unformat;break}x=x||t._.stringToNumber,c=x(i)}else c=Number(i)||null;return new v(i,c)},t.version=r,t.isNumeral=function(i){return i instanceof v},t._=o={numberToFormat:function(i,c,h){var x=a[t.options.currentLocale],u=!1,E=!1,R=0,S="",b=1e12,y=1e9,j=1e6,M=1e3,D="",_=!1,w,C,T,A,I,B,P;if(i=i||0,C=Math.abs(i),t._.includes(c,"(")?(u=!0,c=c.replace(/[\(|\)]/g,"")):(t._.includes(c,"+")||t._.includes(c,"-"))&&(I=t._.includes(c,"+")?c.indexOf("+"):i<0?c.indexOf("-"):-1,c=c.replace(/[\+|\-]/g,"")),t._.includes(c,"a")&&(w=c.match(/a(k|m|b|t)?/),w=w?w[1]:!1,t._.includes(c," a")&&(S=" "),c=c.replace(new RegExp(S+"a[kmbt]?"),""),C>=b&&!w||w==="t"?(S+=x.abbreviations.trillion,i=i/b):C<b&&C>=y&&!w||w==="b"?(S+=x.abbreviations.billion,i=i/y):C<y&&C>=j&&!w||w==="m"?(S+=x.abbreviations.million,i=i/j):(C<j&&C>=M&&!w||w==="k")&&(S+=x.abbreviations.thousand,i=i/M)),t._.includes(c,"[.]")&&(E=!0,c=c.replace("[.]",".")),T=i.toString().split(".")[0],A=c.split(".")[1],B=c.indexOf(","),R=(c.split(".")[0].split(",")[0].match(/0/g)||[]).length,A?(t._.includes(A,"[")?(A=A.replace("]",""),A=A.split("["),D=t._.toFixed(i,A[0].length+A[1].length,h,A[1].length)):D=t._.toFixed(i,A.length,h),T=D.split(".")[0],t._.includes(D,".")?D=x.delimiters.decimal+D.split(".")[1]:D="",E&&Number(D.slice(1))===0&&(D="")):T=t._.toFixed(i,0,h),S&&!w&&Number(T)>=1e3&&S!==x.abbreviations.trillion)switch(T=String(Number(T)/1e3),S){case x.abbreviations.thousand:S=x.abbreviations.million;break;case x.abbreviations.million:S=x.abbreviations.billion;break;case x.abbreviations.billion:S=x.abbreviations.trillion;break}if(t._.includes(T,"-")&&(T=T.slice(1),_=!0),T.length<R)for(var F=R-T.length;F>0;F--)T="0"+T;return B>-1&&(T=T.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+x.delimiters.thousands)),c.indexOf(".")===0&&(T=""),P=T+D+(S||""),u?P=(u&&_?"(":"")+P+(u&&_?")":""):I>=0?P=I===0?(_?"-":"+")+P:P+(_?"-":"+"):_&&(P="-"+P),P},stringToNumber:function(i){var c=a[g.currentLocale],h=i,x={thousand:3,million:6,billion:9,trillion:12},u,E,R;if(g.zeroFormat&&i===g.zeroFormat)E=0;else if(g.nullFormat&&i===g.nullFormat||!i.replace(/[^0-9]+/g,"").length)E=null;else{E=1,c.delimiters.decimal!=="."&&(i=i.replace(/\./g,"").replace(c.delimiters.decimal,"."));for(u in x)if(R=new RegExp("[^a-zA-Z]"+c.abbreviations[u]+"(?:\\)|(\\"+c.currency.symbol+")?(?:\\))?)?$"),h.match(R)){E*=Math.pow(10,x[u]);break}E*=(i.split("-").length+Math.min(i.split("(").length-1,i.split(")").length-1))%2?1:-1,i=i.replace(/[^0-9\.]+/g,""),E*=Number(i)}return E},isNaN:function(i){return typeof i=="number"&&isNaN(i)},includes:function(i,c){return i.indexOf(c)!==-1},insert:function(i,c,h){return i.slice(0,h)+c+i.slice(h)},reduce:function(i,c){if(this===null)throw new TypeError("Array.prototype.reduce called on null or undefined");if(typeof c!="function")throw new TypeError(c+" is not a function");var h=Object(i),x=h.length>>>0,u=0,E;if(arguments.length===3)E=arguments[2];else{for(;u<x&&!(u in h);)u++;if(u>=x)throw new TypeError("Reduce of empty array with no initial value");E=h[u++]}for(;u<x;u++)u in h&&(E=c(E,h[u],u,h));return E},multiplier:function(i){var c=i.toString().split(".");return c.length<2?1:Math.pow(10,c[1].length)},correctionFactor:function(){var i=Array.prototype.slice.call(arguments);return i.reduce(function(c,h){var x=o.multiplier(h);return c>x?c:x},1)},toFixed:function(i,c,h,x){var u=i.toString().split("."),E=c-(x||0),R,S,b,y;return u.length===2?R=Math.min(Math.max(u[1].length,E),c):R=E,b=Math.pow(10,R),y=(h(i+"e+"+R)/b).toFixed(R),x>c-R&&(S=new RegExp("\\.?0{1,"+(x-(c-R))+"}$"),y=y.replace(S,"")),y}},t.options=g,t.formats=s,t.locales=a,t.locale=function(i){return i&&(g.currentLocale=i.toLowerCase()),g.currentLocale},t.localeData=function(i){if(!i)return a[g.currentLocale];if(i=i.toLowerCase(),!a[i])throw new Error("Unknown locale : "+i);return a[i]},t.reset=function(){for(var i in d)g[i]=d[i]},t.zeroFormat=function(i){g.zeroFormat=typeof i=="string"?i:null},t.nullFormat=function(i){g.nullFormat=typeof i=="string"?i:null},t.defaultFormat=function(i){g.defaultFormat=typeof i=="string"?i:"0.0"},t.register=function(i,c,h){if(c=c.toLowerCase(),this[i+"s"][c])throw new TypeError(c+" "+i+" already registered.");return this[i+"s"][c]=h,h},t.validate=function(i,c){var h,x,u,E,R,S,b,y;if(typeof i!="string"&&(i+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",i)),i=i.trim(),i.match(/^\d+$/))return!0;if(i==="")return!1;try{b=t.localeData(c)}catch{b=t.localeData(t.locale())}return u=b.currency.symbol,R=b.abbreviations,h=b.delimiters.decimal,b.delimiters.thousands==="."?x="\\.":x=b.delimiters.thousands,y=i.match(/^[^\d]+/),y!==null&&(i=i.substr(1),y[0]!==u)||(y=i.match(/[^\d]+$/),y!==null&&(i=i.slice(0,-1),y[0]!==R.thousand&&y[0]!==R.million&&y[0]!==R.billion&&y[0]!==R.trillion))?!1:(S=new RegExp(x+"{2}"),i.match(/[^\d.,]/g)?!1:(E=i.split(h),E.length>2?!1:E.length<2?!!E[0].match(/^\d+.*\d$/)&&!E[0].match(S):E[0].length===1?!!E[0].match(/^\d+$/)&&!E[0].match(S)&&!!E[1].match(/^\d+$/):!!E[0].match(/^\d+.*\d$/)&&!E[0].match(S)&&!!E[1].match(/^\d+$/)))},t.fn=v.prototype={clone:function(){return t(this)},format:function(i,c){var h=this._value,x=i||g.defaultFormat,u,E,R;if(c=c||Math.round,h===0&&g.zeroFormat!==null)E=g.zeroFormat;else if(h===null&&g.nullFormat!==null)E=g.nullFormat;else{for(u in s)if(x.match(s[u].regexps.format)){R=s[u].format;break}R=R||t._.numberToFormat,E=R(h,x,c)}return E},value:function(){return this._value},input:function(){return this._input},set:function(i){return this._value=Number(i),this},add:function(i){var c=o.correctionFactor.call(null,this._value,i);function h(x,u,E,R){return x+Math.round(c*u)}return this._value=o.reduce([this._value,i],h,0)/c,this},subtract:function(i){var c=o.correctionFactor.call(null,this._value,i);function h(x,u,E,R){return x-Math.round(c*u)}return this._value=o.reduce([i],h,Math.round(this._value*c))/c,this},multiply:function(i){function c(h,x,u,E){var R=o.correctionFactor(h,x);return Math.round(h*R)*Math.round(x*R)/Math.round(R*R)}return this._value=o.reduce([this._value,i],c,1),this},divide:function(i){function c(h,x,u,E){var R=o.correctionFactor(h,x);return Math.round(h*R)/Math.round(x*R)}return this._value=o.reduce([this._value,i],c),this},difference:function(i){return Math.abs(t(this._value).subtract(i).value())}},t.register("locale","en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(i){var c=i%10;return~~(i%100/10)===1?"th":c===1?"st":c===2?"nd":c===3?"rd":"th"},currency:{symbol:"$"}}),function(){t.register("format","bps",{regexps:{format:/(BPS)/,unformat:/(BPS)/},format:function(i,c,h){var x=t._.includes(c," BPS")?" ":"",u;return i=i*1e4,c=c.replace(/\s?BPS/,""),u=t._.numberToFormat(i,c,h),t._.includes(u,")")?(u=u.split(""),u.splice(-1,0,x+"BPS"),u=u.join("")):u=u+x+"BPS",u},unformat:function(i){return+(t._.stringToNumber(i)*1e-4).toFixed(15)}})}(),function(){var i={base:1e3,suffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},c={base:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},h=i.suffixes.concat(c.suffixes.filter(function(u){return i.suffixes.indexOf(u)<0})),x=h.join("|");x="("+x.replace("B","B(?!PS)")+")",t.register("format","bytes",{regexps:{format:/([0\s]i?b)/,unformat:new RegExp(x)},format:function(u,E,R){var S,b=t._.includes(E,"ib")?c:i,y=t._.includes(E," b")||t._.includes(E," ib")?" ":"",j,M,D;for(E=E.replace(/\s?i?b/,""),j=0;j<=b.suffixes.length;j++)if(M=Math.pow(b.base,j),D=Math.pow(b.base,j+1),u===null||u===0||u>=M&&u<D){y+=b.suffixes[j],M>0&&(u=u/M);break}return S=t._.numberToFormat(u,E,R),S+y},unformat:function(u){var E=t._.stringToNumber(u),R,S;if(E){for(R=i.suffixes.length-1;R>=0;R--){if(t._.includes(u,i.suffixes[R])){S=Math.pow(i.base,R);break}if(t._.includes(u,c.suffixes[R])){S=Math.pow(c.base,R);break}}E*=S||1}return E}})}(),function(){t.register("format","currency",{regexps:{format:/(\$)/},format:function(i,c,h){var x=t.locales[t.options.currentLocale],u={before:c.match(/^([\+|\-|\(|\s|\$]*)/)[0],after:c.match(/([\+|\-|\)|\s|\$]*)$/)[0]},E,R,S;for(c=c.replace(/\s?\$\s?/,""),E=t._.numberToFormat(i,c,h),i>=0?(u.before=u.before.replace(/[\-\(]/,""),u.after=u.after.replace(/[\-\)]/,"")):i<0&&!t._.includes(u.before,"-")&&!t._.includes(u.before,"(")&&(u.before="-"+u.before),S=0;S<u.before.length;S++)switch(R=u.before[S],R){case"$":E=t._.insert(E,x.currency.symbol,S);break;case" ":E=t._.insert(E," ",S+x.currency.symbol.length-1);break}for(S=u.after.length-1;S>=0;S--)switch(R=u.after[S],R){case"$":E=S===u.after.length-1?E+x.currency.symbol:t._.insert(E,x.currency.symbol,-(u.after.length-(1+S)));break;case" ":E=S===u.after.length-1?E+" ":t._.insert(E," ",-(u.after.length-(1+S)+x.currency.symbol.length-1));break}return E}})}(),function(){t.register("format","exponential",{regexps:{format:/(e\+|e-)/,unformat:/(e\+|e-)/},format:function(i,c,h){var x,u=typeof i=="number"&&!t._.isNaN(i)?i.toExponential():"0e+0",E=u.split("e");return c=c.replace(/e[\+|\-]{1}0/,""),x=t._.numberToFormat(Number(E[0]),c,h),x+"e"+E[1]},unformat:function(i){var c=t._.includes(i,"e+")?i.split("e+"):i.split("e-"),h=Number(c[0]),x=Number(c[1]);x=t._.includes(i,"e-")?x*=-1:x;function u(E,R,S,b){var y=t._.correctionFactor(E,R),j=E*y*(R*y)/(y*y);return j}return t._.reduce([h,Math.pow(10,x)],u,1)}})}(),function(){t.register("format","ordinal",{regexps:{format:/(o)/},format:function(i,c,h){var x=t.locales[t.options.currentLocale],u,E=t._.includes(c," o")?" ":"";return c=c.replace(/\s?o/,""),E+=x.ordinal(i),u=t._.numberToFormat(i,c,h),u+E}})}(),function(){t.register("format","percentage",{regexps:{format:/(%)/,unformat:/(%)/},format:function(i,c,h){var x=t._.includes(c," %")?" ":"",u;return t.options.scalePercentBy100&&(i=i*100),c=c.replace(/\s?\%/,""),u=t._.numberToFormat(i,c,h),t._.includes(u,")")?(u=u.split(""),u.splice(-1,0,x+"%"),u=u.join("")):u=u+x+"%",u},unformat:function(i){var c=t._.stringToNumber(i);return t.options.scalePercentBy100?c*.01:c}})}(),function(){t.register("format","time",{regexps:{format:/(:)/,unformat:/(:)/},format:function(i,c,h){var x=Math.floor(i/60/60),u=Math.floor((i-x*60*60)/60),E=Math.round(i-x*60*60-u*60);return x+":"+(u<10?"0"+u:u)+":"+(E<10?"0"+E:E)},unformat:function(i){var c=i.split(":"),h=0;return c.length===3?(h=h+Number(c[0])*60*60,h=h+Number(c[1])*60,h=h+Number(c[2])):c.length===2&&(h=h+Number(c[0])*60,h=h+Number(c[1])),Number(h)}})}(),t})})(numeral$1);var numeralExports=numeral$1.exports;const numeral=getDefaultExportFromCjs(numeralExports),LabelWidget=e=>{const t=useComponentsStore(E=>E.components),o=e.componentId?t.find(E=>E.id===e.componentId):void 0,r=o?{...e,...o.props}:e,{text:s="标签",color:a="#1976d2",fontSize:d=16,background:g="#fff",align:v="left",style:i={},dataBinding:c}=r,h=useDataSourceStore(E=>E.dataSources);let x=s;if(e.bindingData)x=e.bindingData;else if(c?.dataSource&&c?.field){const E=h.find(R=>R.key===c.dataSource);E&&E.fields.includes(c.field)&&E.sample&&(x=E.sample[c.field]??s)}x=formatLabelValue(x,c,numeral,dayjs);const u=getJustifyContent(v);return jsxRuntimeExports.jsx("div",{style:{display:"flex",justifyContent:u,width:"100%",background:g,...i,transform:i.transform,opacity:i.opacity},children:jsxRuntimeExports.jsx("span",{style:{color:a,fontSize:d,padding:"2px 8px",borderRadius:4,fontWeight:500,background:"transparent"},children:x})})},LabelWidgetMeta={type:"label",displayName:"标签",Component:LabelWidget,icon:jsxRuntimeExports.jsx(RefIcon$1,{})},__vite_glob_0_1=Object.freeze(Object.defineProperty({__proto__:null,LabelWidgetMeta,default:LabelWidget},Symbol.toStringTag,{value:"Module"})),QRCodeWidget=e=>{const t=useComponentsStore(u=>u.components),o=e.componentId?t.find(u=>u.id===e.componentId):void 0,r=o?{...e,...o.props}:e,{size:s=120,color:a="#1976d2",bgColor:d="#fff",style:g={},qrValue:v="二维码内容",bordered:i=!0,dataBinding:c}=r,h=useDataSourceStore(u=>u.dataSources);let x="";if(e.bindingData)x=String(e.bindingData);else if(c?.dataSource&&c?.field){const u=h.find(E=>E.key===c.dataSource);if(u&&u.sample){const E=u.sample[c.field];E!=null&&(x=String(E))}}return x||(x=v),jsxRuntimeExports.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%",background:d,...g},children:jsxRuntimeExports.jsx(QRCode,{value:x,size:s,color:a,bgColor:d,bordered:i})})},QRCodeWidgetMeta={type:"qrcode",displayName:"二维码",Component:QRCodeWidget,icon:jsxRuntimeExports.jsx(RefIcon$2,{})},__vite_glob_0_2=Object.freeze(Object.defineProperty({__proto__:null,QRCodeWidgetMeta,default:QRCodeWidget},Symbol.toStringTag,{value:"Module"}));function getNestedDataSource(e,t){if(!t)return[];const o=t.split(".");let r=e;for(const s of o)if(Array.isArray(r)?r=r.flatMap(a=>a?.[s]||[]):r=r?.[s],!r)break;return Array.isArray(r)?r:[]}const TableWidget=e=>{const t=useComponentsStore(b=>b.components),o=e.componentId?t.find(b=>b.id===e.componentId):void 0,r=o?.props?.dataBinding||{},s=r.columns||e.columns||[],a=r.dataSource||e.dataSourceKey||"",d=r.dataNode,g=o?.props?.pagination??e.pagination??!0,v=o?.props?.showPagination??e.showPagination??!1,i=o?.props?.pageSize??e.pageSize??10,c=e.bordered??!1,h=e.size,x=e.style||{},u=useDataSourceStore(b=>b.dataSources);let E=[];if(e.dataSource!==void 0)E=e.dataSource;else{const b=u.find(y=>y.key===a)?.data;b&&d?E=getNestedDataSource(b,d):b?E=Array.isArray(b)?b:[]:E=[]}const R=s.filter(b=>b.visible!==!1).map(b=>{const y=(M,D)=>{let _=M;if(b.expression)try{_=new Function("record","value",b.expression)(D,M)}catch{}return _=formatLabelValue(_,b,numeral,dayjs),_},j=()=>{const M={};return b.align&&(M.style={textAlign:b.align}),b.width&&(M.style={...M.style||{},width:b.width}),M};return{title:b.label||"-",dataIndex:b.field||"_placeholder_data_index",key:b.field||`col_${Math.random().toString(36).slice(2)}`,align:b.align,width:b.width,render:y,onCell:j}}),S={pageSize:i,showSizeChanger:!1,showQuickJumper:!1,itemRender:v?void 0:()=>null};return R.length?jsxRuntimeExports.jsx(ForwardTable,{columns:R,dataSource:E,pagination:g?S:!1,bordered:c,size:h,style:{width:"100%",...x,borderRadius:4},scroll:{x:!0},rowKey:b=>b?.id||b?.key||(s.length>0&&s[0].field&&b?.[s[0].field]!==void 0?String(b[s[0].field]):void 0)||`row_${JSON.stringify(b)}_${Math.random().toString(36).slice(2)}`}):jsxRuntimeExports.jsx("div",{style:{color:"#bbb",textAlign:"center",padding:16},children:"请先配置字段映射"})},TableWidgetMeta={type:"table",displayName:"表格",Component:TableWidget,icon:jsxRuntimeExports.jsx(RefIcon$3,{})},__vite_glob_0_3=Object.freeze(Object.defineProperty({__proto__:null,TableWidgetMeta,default:TableWidget},Symbol.toStringTag,{value:"Module"})),componentRegistry={};function registerComponent(e){componentRegistry[e.type]&&console.warn(`组件类型 ${e.type} 已注册，自动覆盖`),componentRegistry[e.type]=e}const modules=Object.assign({"./ImageWidget.tsx":__vite_glob_0_0,"./LabelWidget.tsx":__vite_glob_0_1,"./QRCodeWidget.tsx":__vite_glob_0_2,"./TableWidget.tsx":__vite_glob_0_3});for(const e in modules){const t=modules[e];for(const o in t)if(o.endsWith("Meta")){const r=t[o];r&&typeof r.type=="string"&&r.Component?r.icon!==void 0?registerComponent(r):console.warn(`Widget module at ${e} exports ${o} missing icon property.`):console.warn(`Widget module at ${e} exports ${o} not a valid widget meta object.`)}}console.log("Widgets registered automatically:",Object.keys(componentRegistry));const iconBtnProps={type:"text",shape:"circle",size:"small",style:{fontSize:18,margin:0,padding:0}},BatchToolbar=({onShowAll:e,onDeleteSelected:t,onAlign:o,onDistribute:r,onBatchLock:s,onBatchVisible:a,onBatchResizable:d,onBatchRotatable:g,onBatchRotation:v,onBatchOpacity:i,selectedCount:c=0,canDistribute:h=!1,allRotatable:x=!1})=>{const u=c===0;return jsxRuntimeExports.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:4,background:"#fff",border:"1px solid #e5e5e5",borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.08)",padding:"10px",zIndex:1e3,width:"fit-content"},children:[jsxRuntimeExports.jsx("span",{style:{color:u?"#aaa":"#222",fontSize:14,marginRight:4},children:u?"未选中组件":`已选中 ${c} 个组件`}),jsxRuntimeExports.jsx(Tooltip,{title:"删除",children:jsxRuntimeExports.jsx(Button,{...iconBtnProps,icon:jsxRuntimeExports.jsx(RefIcon$4,{}),onClick:t,disabled:u})}),jsxRuntimeExports.jsx(Tooltip,{title:"锁定",children:jsxRuntimeExports.jsx(Button,{...iconBtnProps,icon:jsxRuntimeExports.jsx(RefIcon$5,{}),onClick:()=>s(!0),disabled:u})}),jsxRuntimeExports.jsx(Tooltip,{title:"解锁",children:jsxRuntimeExports.jsx(Button,{...iconBtnProps,icon:jsxRuntimeExports.jsx(RefIcon$6,{}),onClick:()=>s(!1),disabled:u})}),jsxRuntimeExports.jsx(Tooltip,{title:"显示",children:jsxRuntimeExports.jsx(Button,{...iconBtnProps,icon:jsxRuntimeExports.jsx(RefIcon$7,{}),onClick:()=>a(!0),disabled:u})}),jsxRuntimeExports.jsx(Tooltip,{title:"隐藏",children:jsxRuntimeExports.jsx(Button,{...iconBtnProps,icon:jsxRuntimeExports.jsx(RefIcon$8,{}),onClick:()=>a(!1),disabled:u})}),jsxRuntimeExports.jsx(Tooltip,{title:"显示全部",children:jsxRuntimeExports.jsx(Button,{...iconBtnProps,icon:jsxRuntimeExports.jsx(RefIcon$9,{}),onClick:e})}),jsxRuntimeExports.jsx(Divider,{type:"vertical",style:{height:20,margin:"0 4px",background:"#eee"}}),jsxRuntimeExports.jsx(Tooltip,{title:"左对齐",children:jsxRuntimeExports.jsx(Button,{...iconBtnProps,icon:jsxRuntimeExports.jsx(RefIcon$a,{}),onClick:()=>o("left"),disabled:u})}),jsxRuntimeExports.jsx(Tooltip,{title:"右对齐",children:jsxRuntimeExports.jsx(Button,{...iconBtnProps,icon:jsxRuntimeExports.jsx(RefIcon$b,{}),onClick:()=>o("right"),disabled:u})}),jsxRuntimeExports.jsx(Tooltip,{title:"顶对齐",children:jsxRuntimeExports.jsx(Button,{...iconBtnProps,icon:jsxRuntimeExports.jsx(RefIcon$c,{}),onClick:()=>o("top"),disabled:u})}),jsxRuntimeExports.jsx(Tooltip,{title:"底对齐",children:jsxRuntimeExports.jsx(Button,{...iconBtnProps,icon:jsxRuntimeExports.jsx(RefIcon$d,{}),onClick:()=>o("bottom"),disabled:u})}),jsxRuntimeExports.jsx(Tooltip,{title:"水平居中",children:jsxRuntimeExports.jsx(Button,{...iconBtnProps,icon:jsxRuntimeExports.jsx(RefIcon$e,{}),onClick:()=>o("hcenter"),disabled:u})}),jsxRuntimeExports.jsx(Tooltip,{title:"垂直居中",children:jsxRuntimeExports.jsx(Button,{...iconBtnProps,icon:jsxRuntimeExports.jsx(RefIcon$f,{}),onClick:()=>o("vcenter"),disabled:u})}),h&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Divider,{type:"vertical",style:{height:20,margin:"0 4px",background:"#eee"}}),jsxRuntimeExports.jsx(Tooltip,{title:"水平分布",children:jsxRuntimeExports.jsx(Button,{...iconBtnProps,icon:jsxRuntimeExports.jsx(RefIcon$g,{}),onClick:()=>r("horizontal"),disabled:u})}),jsxRuntimeExports.jsx(Tooltip,{title:"垂直分布",children:jsxRuntimeExports.jsx(Button,{...iconBtnProps,icon:jsxRuntimeExports.jsx(RefIcon$h,{}),onClick:()=>r("vertical"),disabled:u})})]}),jsxRuntimeExports.jsx(Divider,{type:"vertical",style:{height:20,margin:"0 4px",background:"#eee"}}),jsxRuntimeExports.jsxs(Tooltip,{title:"可缩放",children:[jsxRuntimeExports.jsx("span",{style:{fontWeight:400,color:"#888"},children:"可缩放"}),jsxRuntimeExports.jsx(Switch,{defaultChecked:!0,onChange:d,size:"small",disabled:u})]}),jsxRuntimeExports.jsxs(Tooltip,{title:"可旋转",children:[jsxRuntimeExports.jsx("span",{style:{fontWeight:400,color:"#888"},children:"可旋转"}),jsxRuntimeExports.jsx(Switch,{defaultChecked:!1,onChange:g,size:"small",disabled:u})]}),jsxRuntimeExports.jsx("span",{style:{fontWeight:400,color:"#888"},children:"旋转角度"}),jsxRuntimeExports.jsx(TypedInputNumber,{min:-360,max:360,step:1,defaultValue:0,onChange:E=>typeof E=="number"&&v(E),size:"small",disabled:u||!x,style:{width:60}}),jsxRuntimeExports.jsx("span",{style:{fontWeight:400,color:"#888"},children:"透明度"}),jsxRuntimeExports.jsx(TypedInputNumber,{min:0,max:1,step:.01,defaultValue:1,onChange:E=>typeof E=="number"&&i(E),size:"small",disabled:u,style:{width:60}})]})},canUseDOM=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function isWindow(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function isNode(e){return"nodeType"in e}function getWindow(e){var t,o;return e?isWindow(e)?e:isNode(e)&&(t=(o=e.ownerDocument)==null?void 0:o.defaultView)!=null?t:window:window}function isDocument(e){const{Document:t}=getWindow(e);return e instanceof t}function isHTMLElement(e){return isWindow(e)?!1:e instanceof getWindow(e).HTMLElement}function isSVGElement(e){return e instanceof getWindow(e).SVGElement}function getOwnerDocument(e){return e?isWindow(e)?e.document:isNode(e)?isDocument(e)?e:isHTMLElement(e)||isSVGElement(e)?e.ownerDocument:document:document:document}const useIsomorphicLayoutEffect=canUseDOM?reactExports.useLayoutEffect:reactExports.useEffect;function useEvent(e){const t=reactExports.useRef(e);return useIsomorphicLayoutEffect(()=>{t.current=e}),reactExports.useCallback(function(){for(var o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return t.current==null?void 0:t.current(...r)},[])}function useInterval(){const e=reactExports.useRef(null),t=reactExports.useCallback((r,s)=>{e.current=setInterval(r,s)},[]),o=reactExports.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,o]}function useLatestValue(e,t){t===void 0&&(t=[e]);const o=reactExports.useRef(e);return useIsomorphicLayoutEffect(()=>{o.current!==e&&(o.current=e)},t),o}function useLazyMemo(e,t){const o=reactExports.useRef();return reactExports.useMemo(()=>{const r=e(o.current);return o.current=r,r},[...t])}function useNodeRef(e){const t=useEvent(e),o=reactExports.useRef(null),r=reactExports.useCallback(s=>{s!==o.current&&t?.(s,o.current),o.current=s},[]);return[o,r]}function usePrevious(e){const t=reactExports.useRef();return reactExports.useEffect(()=>{t.current=e},[e]),t.current}let ids={};function useUniqueId(e,t){return reactExports.useMemo(()=>{if(t)return t;const o=ids[e]==null?0:ids[e]+1;return ids[e]=o,e+"-"+o},[e,t])}function createAdjustmentFn(e){return function(t){for(var o=arguments.length,r=new Array(o>1?o-1:0),s=1;s<o;s++)r[s-1]=arguments[s];return r.reduce((a,d)=>{const g=Object.entries(d);for(const[v,i]of g){const c=a[v];c!=null&&(a[v]=c+e*i)}return a},{...t})}}const add=createAdjustmentFn(1),subtract=createAdjustmentFn(-1);function hasViewportRelativeCoordinates(e){return"clientX"in e&&"clientY"in e}function isKeyboardEvent(e){if(!e)return!1;const{KeyboardEvent:t}=getWindow(e.target);return t&&e instanceof t}function isTouchEvent(e){if(!e)return!1;const{TouchEvent:t}=getWindow(e.target);return t&&e instanceof t}function getEventCoordinates(e){if(isTouchEvent(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:o}=e.touches[0];return{x:t,y:o}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:o}=e.changedTouches[0];return{x:t,y:o}}}return hasViewportRelativeCoordinates(e)?{x:e.clientX,y:e.clientY}:null}const SELECTOR="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function findFirstFocusableNode(e){return e.matches(SELECTOR)?e:e.querySelector(SELECTOR)}const hiddenStyles={display:"none"};function HiddenText(e){let{id:t,value:o}=e;return React.createElement("div",{id:t,style:hiddenStyles},o)}function LiveRegion(e){let{id:t,announcement:o,ariaLiveType:r="assertive"}=e;const s={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return React.createElement("div",{id:t,style:s,role:"status","aria-live":r,"aria-atomic":!0},o)}function useAnnouncement(){const[e,t]=reactExports.useState("");return{announce:reactExports.useCallback(r=>{r!=null&&t(r)},[]),announcement:e}}const DndMonitorContext=reactExports.createContext(null);function useDndMonitor(e){const t=reactExports.useContext(DndMonitorContext);reactExports.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function useDndMonitorProvider(){const[e]=reactExports.useState(()=>new Set),t=reactExports.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[reactExports.useCallback(r=>{let{type:s,event:a}=r;e.forEach(d=>{var g;return(g=d[s])==null?void 0:g.call(d,a)})},[e]),t]}const defaultScreenReaderInstructions={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},defaultAnnouncements={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:o}=e;return o?"Draggable item "+t.id+" was moved over droppable area "+o.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:o}=e;return o?"Draggable item "+t.id+" was dropped over droppable area "+o.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function Accessibility(e){let{announcements:t=defaultAnnouncements,container:o,hiddenTextDescribedById:r,screenReaderInstructions:s=defaultScreenReaderInstructions}=e;const{announce:a,announcement:d}=useAnnouncement(),g=useUniqueId("DndLiveRegion"),[v,i]=reactExports.useState(!1);if(reactExports.useEffect(()=>{i(!0)},[]),useDndMonitor(reactExports.useMemo(()=>({onDragStart(h){let{active:x}=h;a(t.onDragStart({active:x}))},onDragMove(h){let{active:x,over:u}=h;t.onDragMove&&a(t.onDragMove({active:x,over:u}))},onDragOver(h){let{active:x,over:u}=h;a(t.onDragOver({active:x,over:u}))},onDragEnd(h){let{active:x,over:u}=h;a(t.onDragEnd({active:x,over:u}))},onDragCancel(h){let{active:x,over:u}=h;a(t.onDragCancel({active:x,over:u}))}}),[a,t])),!v)return null;const c=React.createElement(React.Fragment,null,React.createElement(HiddenText,{id:r,value:s.draggable}),React.createElement(LiveRegion,{id:g,announcement:d}));return o?reactDomExports.createPortal(c,o):c}var Action;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(Action||(Action={}));function noop(){}const defaultCoordinates=Object.freeze({x:0,y:0});function sortCollisionsDesc(e,t){let{data:{value:o}}=e,{data:{value:r}}=t;return r-o}function getFirstCollision(e,t){if(!e||e.length===0)return null;const[o]=e;return o[t]}function getIntersectionRatio(e,t){const o=Math.max(t.top,e.top),r=Math.max(t.left,e.left),s=Math.min(t.left+t.width,e.left+e.width),a=Math.min(t.top+t.height,e.top+e.height),d=s-r,g=a-o;if(r<s&&o<a){const v=t.width*t.height,i=e.width*e.height,c=d*g,h=c/(v+i-c);return Number(h.toFixed(4))}return 0}const rectIntersection=e=>{let{collisionRect:t,droppableRects:o,droppableContainers:r}=e;const s=[];for(const a of r){const{id:d}=a,g=o.get(d);if(g){const v=getIntersectionRatio(g,t);v>0&&s.push({id:d,data:{droppableContainer:a,value:v}})}}return s.sort(sortCollisionsDesc)};function adjustScale(e,t,o){return{...e,scaleX:t&&o?t.width/o.width:1,scaleY:t&&o?t.height/o.height:1}}function getRectDelta(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:defaultCoordinates}function createRectAdjustmentFn(e){return function(o){for(var r=arguments.length,s=new Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];return s.reduce((d,g)=>({...d,top:d.top+e*g.y,bottom:d.bottom+e*g.y,left:d.left+e*g.x,right:d.right+e*g.x}),{...o})}}const getAdjustedRect=createRectAdjustmentFn(1);function parseTransform(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function inverseTransform(e,t,o){const r=parseTransform(t);if(!r)return e;const{scaleX:s,scaleY:a,x:d,y:g}=r,v=e.left-d-(1-s)*parseFloat(o),i=e.top-g-(1-a)*parseFloat(o.slice(o.indexOf(" ")+1)),c=s?e.width/s:e.width,h=a?e.height/a:e.height;return{width:c,height:h,top:i,right:v+c,bottom:i+h,left:v}}const defaultOptions={ignoreTransform:!1};function getClientRect(e,t){t===void 0&&(t=defaultOptions);let o=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:i,transformOrigin:c}=getWindow(e).getComputedStyle(e);i&&(o=inverseTransform(o,i,c))}const{top:r,left:s,width:a,height:d,bottom:g,right:v}=o;return{top:r,left:s,width:a,height:d,bottom:g,right:v}}function getTransformAgnosticClientRect(e){return getClientRect(e,{ignoreTransform:!0})}function getWindowClientRect(e){const t=e.innerWidth,o=e.innerHeight;return{top:0,left:0,right:t,bottom:o,width:t,height:o}}function isFixed(e,t){return t===void 0&&(t=getWindow(e).getComputedStyle(e)),t.position==="fixed"}function isScrollable(e,t){t===void 0&&(t=getWindow(e).getComputedStyle(e));const o=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(s=>{const a=t[s];return typeof a=="string"?o.test(a):!1})}function getScrollableAncestors(e,t){const o=[];function r(s){if(t!=null&&o.length>=t||!s)return o;if(isDocument(s)&&s.scrollingElement!=null&&!o.includes(s.scrollingElement))return o.push(s.scrollingElement),o;if(!isHTMLElement(s)||isSVGElement(s)||o.includes(s))return o;const a=getWindow(e).getComputedStyle(s);return s!==e&&isScrollable(s,a)&&o.push(s),isFixed(s,a)?o:r(s.parentNode)}return e?r(e):o}function getFirstScrollableAncestor(e){const[t]=getScrollableAncestors(e,1);return t??null}function getScrollableElement(e){return!canUseDOM||!e?null:isWindow(e)?e:isNode(e)?isDocument(e)||e===getOwnerDocument(e).scrollingElement?window:isHTMLElement(e)?e:null:null}function getScrollXCoordinate(e){return isWindow(e)?e.scrollX:e.scrollLeft}function getScrollYCoordinate(e){return isWindow(e)?e.scrollY:e.scrollTop}function getScrollCoordinates(e){return{x:getScrollXCoordinate(e),y:getScrollYCoordinate(e)}}var Direction;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(Direction||(Direction={}));function isDocumentScrollingElement(e){return!canUseDOM||!e?!1:e===document.scrollingElement}function getScrollPosition(e){const t={x:0,y:0},o=isDocumentScrollingElement(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-o.width,y:e.scrollHeight-o.height},s=e.scrollTop<=t.y,a=e.scrollLeft<=t.x,d=e.scrollTop>=r.y,g=e.scrollLeft>=r.x;return{isTop:s,isLeft:a,isBottom:d,isRight:g,maxScroll:r,minScroll:t}}const defaultThreshold={x:.2,y:.2};function getScrollDirectionAndSpeed(e,t,o,r,s){let{top:a,left:d,right:g,bottom:v}=o;r===void 0&&(r=10),s===void 0&&(s=defaultThreshold);const{isTop:i,isBottom:c,isLeft:h,isRight:x}=getScrollPosition(e),u={x:0,y:0},E={x:0,y:0},R={height:t.height*s.y,width:t.width*s.x};return!i&&a<=t.top+R.height?(u.y=Direction.Backward,E.y=r*Math.abs((t.top+R.height-a)/R.height)):!c&&v>=t.bottom-R.height&&(u.y=Direction.Forward,E.y=r*Math.abs((t.bottom-R.height-v)/R.height)),!x&&g>=t.right-R.width?(u.x=Direction.Forward,E.x=r*Math.abs((t.right-R.width-g)/R.width)):!h&&d<=t.left+R.width&&(u.x=Direction.Backward,E.x=r*Math.abs((t.left+R.width-d)/R.width)),{direction:u,speed:E}}function getScrollElementRect(e){if(e===document.scrollingElement){const{innerWidth:a,innerHeight:d}=window;return{top:0,left:0,right:a,bottom:d,width:a,height:d}}const{top:t,left:o,right:r,bottom:s}=e.getBoundingClientRect();return{top:t,left:o,right:r,bottom:s,width:e.clientWidth,height:e.clientHeight}}function getScrollOffsets(e){return e.reduce((t,o)=>add(t,getScrollCoordinates(o)),defaultCoordinates)}function getScrollXOffset(e){return e.reduce((t,o)=>t+getScrollXCoordinate(o),0)}function getScrollYOffset(e){return e.reduce((t,o)=>t+getScrollYCoordinate(o),0)}function scrollIntoViewIfNeeded(e,t){if(t===void 0&&(t=getClientRect),!e)return;const{top:o,left:r,bottom:s,right:a}=t(e);getFirstScrollableAncestor(e)&&(s<=0||a<=0||o>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const properties=[["x",["left","right"],getScrollXOffset],["y",["top","bottom"],getScrollYOffset]];class Rect{constructor(t,o){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=getScrollableAncestors(o),s=getScrollOffsets(r);this.rect={...t},this.width=t.width,this.height=t.height;for(const[a,d,g]of properties)for(const v of d)Object.defineProperty(this,v,{get:()=>{const i=g(r),c=s[a]-i;return this.rect[v]+c},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Listeners{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(o=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...o)})},this.target=t}add(t,o,r){var s;(s=this.target)==null||s.addEventListener(t,o,r),this.listeners.push([t,o,r])}}function getEventListenerTarget(e){const{EventTarget:t}=getWindow(e);return e instanceof t?e:getOwnerDocument(e)}function hasExceededDistance(e,t){const o=Math.abs(e.x),r=Math.abs(e.y);return typeof t=="number"?Math.sqrt(o**2+r**2)>t:"x"in t&&"y"in t?o>t.x&&r>t.y:"x"in t?o>t.x:"y"in t?r>t.y:!1}var EventName;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(EventName||(EventName={}));function preventDefault(e){e.preventDefault()}function stopPropagation(e){e.stopPropagation()}var KeyboardCode;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(KeyboardCode||(KeyboardCode={}));const defaultKeyboardCodes={start:[KeyboardCode.Space,KeyboardCode.Enter],cancel:[KeyboardCode.Esc],end:[KeyboardCode.Space,KeyboardCode.Enter,KeyboardCode.Tab]},defaultKeyboardCoordinateGetter=(e,t)=>{let{currentCoordinates:o}=t;switch(e.code){case KeyboardCode.Right:return{...o,x:o.x+25};case KeyboardCode.Left:return{...o,x:o.x-25};case KeyboardCode.Down:return{...o,y:o.y+25};case KeyboardCode.Up:return{...o,y:o.y-25}}};class KeyboardSensor{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:o}}=t;this.props=t,this.listeners=new Listeners(getOwnerDocument(o)),this.windowListeners=new Listeners(getWindow(o)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(EventName.Resize,this.handleCancel),this.windowListeners.add(EventName.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(EventName.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:o}=this.props,r=t.node.current;r&&scrollIntoViewIfNeeded(r),o(defaultCoordinates)}handleKeyDown(t){if(isKeyboardEvent(t)){const{active:o,context:r,options:s}=this.props,{keyboardCodes:a=defaultKeyboardCodes,coordinateGetter:d=defaultKeyboardCoordinateGetter,scrollBehavior:g="smooth"}=s,{code:v}=t;if(a.end.includes(v)){this.handleEnd(t);return}if(a.cancel.includes(v)){this.handleCancel(t);return}const{collisionRect:i}=r.current,c=i?{x:i.left,y:i.top}:defaultCoordinates;this.referenceCoordinates||(this.referenceCoordinates=c);const h=d(t,{active:o,context:r.current,currentCoordinates:c});if(h){const x=subtract(h,c),u={x:0,y:0},{scrollableAncestors:E}=r.current;for(const R of E){const S=t.code,{isTop:b,isRight:y,isLeft:j,isBottom:M,maxScroll:D,minScroll:_}=getScrollPosition(R),w=getScrollElementRect(R),C={x:Math.min(S===KeyboardCode.Right?w.right-w.width/2:w.right,Math.max(S===KeyboardCode.Right?w.left:w.left+w.width/2,h.x)),y:Math.min(S===KeyboardCode.Down?w.bottom-w.height/2:w.bottom,Math.max(S===KeyboardCode.Down?w.top:w.top+w.height/2,h.y))},T=S===KeyboardCode.Right&&!y||S===KeyboardCode.Left&&!j,A=S===KeyboardCode.Down&&!M||S===KeyboardCode.Up&&!b;if(T&&C.x!==h.x){const I=R.scrollLeft+x.x,B=S===KeyboardCode.Right&&I<=D.x||S===KeyboardCode.Left&&I>=_.x;if(B&&!x.y){R.scrollTo({left:I,behavior:g});return}B?u.x=R.scrollLeft-I:u.x=S===KeyboardCode.Right?R.scrollLeft-D.x:R.scrollLeft-_.x,u.x&&R.scrollBy({left:-u.x,behavior:g});break}else if(A&&C.y!==h.y){const I=R.scrollTop+x.y,B=S===KeyboardCode.Down&&I<=D.y||S===KeyboardCode.Up&&I>=_.y;if(B&&!x.x){R.scrollTo({top:I,behavior:g});return}B?u.y=R.scrollTop-I:u.y=S===KeyboardCode.Down?R.scrollTop-D.y:R.scrollTop-_.y,u.y&&R.scrollBy({top:-u.y,behavior:g});break}}this.handleMove(t,add(subtract(h,this.referenceCoordinates),u))}}}handleMove(t,o){const{onMove:r}=this.props;t.preventDefault(),r(o)}handleEnd(t){const{onEnd:o}=this.props;t.preventDefault(),this.detach(),o()}handleCancel(t){const{onCancel:o}=this.props;t.preventDefault(),this.detach(),o()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}KeyboardSensor.activators=[{eventName:"onKeyDown",handler:(e,t,o)=>{let{keyboardCodes:r=defaultKeyboardCodes,onActivation:s}=t,{active:a}=o;const{code:d}=e.nativeEvent;if(r.start.includes(d)){const g=a.activatorNode.current;return g&&e.target!==g?!1:(e.preventDefault(),s?.({event:e.nativeEvent}),!0)}return!1}}];function isDistanceConstraint(e){return!!(e&&"distance"in e)}function isDelayConstraint(e){return!!(e&&"delay"in e)}class AbstractPointerSensor{constructor(t,o,r){var s;r===void 0&&(r=getEventListenerTarget(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=o;const{event:a}=t,{target:d}=a;this.props=t,this.events=o,this.document=getOwnerDocument(d),this.documentListeners=new Listeners(this.document),this.listeners=new Listeners(r),this.windowListeners=new Listeners(getWindow(d)),this.initialCoordinates=(s=getEventCoordinates(a))!=null?s:defaultCoordinates,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:o,bypassActivationConstraint:r}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(EventName.Resize,this.handleCancel),this.windowListeners.add(EventName.DragStart,preventDefault),this.windowListeners.add(EventName.VisibilityChange,this.handleCancel),this.windowListeners.add(EventName.ContextMenu,preventDefault),this.documentListeners.add(EventName.Keydown,this.handleKeydown),o){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(isDelayConstraint(o)){this.timeoutId=setTimeout(this.handleStart,o.delay),this.handlePending(o);return}if(isDistanceConstraint(o)){this.handlePending(o);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,o){const{active:r,onPending:s}=this.props;s(r,t,this.initialCoordinates,o)}handleStart(){const{initialCoordinates:t}=this,{onStart:o}=this.props;t&&(this.activated=!0,this.documentListeners.add(EventName.Click,stopPropagation,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(EventName.SelectionChange,this.removeTextSelection),o(t))}handleMove(t){var o;const{activated:r,initialCoordinates:s,props:a}=this,{onMove:d,options:{activationConstraint:g}}=a;if(!s)return;const v=(o=getEventCoordinates(t))!=null?o:defaultCoordinates,i=subtract(s,v);if(!r&&g){if(isDistanceConstraint(g)){if(g.tolerance!=null&&hasExceededDistance(i,g.tolerance))return this.handleCancel();if(hasExceededDistance(i,g.distance))return this.handleStart()}if(isDelayConstraint(g)&&hasExceededDistance(i,g.tolerance))return this.handleCancel();this.handlePending(g,i);return}t.cancelable&&t.preventDefault(),d(v)}handleEnd(){const{onAbort:t,onEnd:o}=this.props;this.detach(),this.activated||t(this.props.active),o()}handleCancel(){const{onAbort:t,onCancel:o}=this.props;this.detach(),this.activated||t(this.props.active),o()}handleKeydown(t){t.code===KeyboardCode.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const events={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class PointerSensor extends AbstractPointerSensor{constructor(t){const{event:o}=t,r=getOwnerDocument(o.target);super(t,events,r)}}PointerSensor.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:o}=e,{onActivation:r}=t;return!o.isPrimary||o.button!==0?!1:(r?.({event:o}),!0)}}];const events$1={move:{name:"mousemove"},end:{name:"mouseup"}};var MouseButton;(function(e){e[e.RightClick=2]="RightClick"})(MouseButton||(MouseButton={}));class MouseSensor extends AbstractPointerSensor{constructor(t){super(t,events$1,getOwnerDocument(t.event.target))}}MouseSensor.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:o}=e,{onActivation:r}=t;return o.button===MouseButton.RightClick?!1:(r?.({event:o}),!0)}}];const events$2={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class TouchSensor extends AbstractPointerSensor{constructor(t){super(t,events$2)}static setup(){return window.addEventListener(events$2.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(events$2.move.name,t)};function t(){}}}TouchSensor.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:o}=e,{onActivation:r}=t;const{touches:s}=o;return s.length>1?!1:(r?.({event:o}),!0)}}];var AutoScrollActivator;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(AutoScrollActivator||(AutoScrollActivator={}));var TraversalOrder;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(TraversalOrder||(TraversalOrder={}));function useAutoScroller(e){let{acceleration:t,activator:o=AutoScrollActivator.Pointer,canScroll:r,draggingRect:s,enabled:a,interval:d=5,order:g=TraversalOrder.TreeOrder,pointerCoordinates:v,scrollableAncestors:i,scrollableAncestorRects:c,delta:h,threshold:x}=e;const u=useScrollIntent({delta:h,disabled:!a}),[E,R]=useInterval(),S=reactExports.useRef({x:0,y:0}),b=reactExports.useRef({x:0,y:0}),y=reactExports.useMemo(()=>{switch(o){case AutoScrollActivator.Pointer:return v?{top:v.y,bottom:v.y,left:v.x,right:v.x}:null;case AutoScrollActivator.DraggableRect:return s}},[o,s,v]),j=reactExports.useRef(null),M=reactExports.useCallback(()=>{const _=j.current;if(!_)return;const w=S.current.x*b.current.x,C=S.current.y*b.current.y;_.scrollBy(w,C)},[]),D=reactExports.useMemo(()=>g===TraversalOrder.TreeOrder?[...i].reverse():i,[g,i]);reactExports.useEffect(()=>{if(!a||!i.length||!y){R();return}for(const _ of D){if(r?.(_)===!1)continue;const w=i.indexOf(_),C=c[w];if(!C)continue;const{direction:T,speed:A}=getScrollDirectionAndSpeed(_,C,y,t,x);for(const I of["x","y"])u[I][T[I]]||(A[I]=0,T[I]=0);if(A.x>0||A.y>0){R(),j.current=_,E(M,d),S.current=A,b.current=T;return}}S.current={x:0,y:0},b.current={x:0,y:0},R()},[t,M,r,R,a,d,JSON.stringify(y),JSON.stringify(u),E,i,D,c,JSON.stringify(x)])}const defaultScrollIntent={x:{[Direction.Backward]:!1,[Direction.Forward]:!1},y:{[Direction.Backward]:!1,[Direction.Forward]:!1}};function useScrollIntent(e){let{delta:t,disabled:o}=e;const r=usePrevious(t);return useLazyMemo(s=>{if(o||!r||!s)return defaultScrollIntent;const a={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[Direction.Backward]:s.x[Direction.Backward]||a.x===-1,[Direction.Forward]:s.x[Direction.Forward]||a.x===1},y:{[Direction.Backward]:s.y[Direction.Backward]||a.y===-1,[Direction.Forward]:s.y[Direction.Forward]||a.y===1}}},[o,t,r])}function useCachedNode(e,t){const o=t!=null?e.get(t):void 0,r=o?o.node.current:null;return useLazyMemo(s=>{var a;return t==null?null:(a=r??s)!=null?a:null},[r,t])}function useCombineActivators(e,t){return reactExports.useMemo(()=>e.reduce((o,r)=>{const{sensor:s}=r,a=s.activators.map(d=>({eventName:d.eventName,handler:t(d.handler,r)}));return[...o,...a]},[]),[e,t])}var MeasuringStrategy;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(MeasuringStrategy||(MeasuringStrategy={}));var MeasuringFrequency;(function(e){e.Optimized="optimized"})(MeasuringFrequency||(MeasuringFrequency={}));const defaultValue=new Map;function useDroppableMeasuring(e,t){let{dragging:o,dependencies:r,config:s}=t;const[a,d]=reactExports.useState(null),{frequency:g,measure:v,strategy:i}=s,c=reactExports.useRef(e),h=S(),x=useLatestValue(h),u=reactExports.useCallback(function(b){b===void 0&&(b=[]),!x.current&&d(y=>y===null?b:y.concat(b.filter(j=>!y.includes(j))))},[x]),E=reactExports.useRef(null),R=useLazyMemo(b=>{if(h&&!o)return defaultValue;if(!b||b===defaultValue||c.current!==e||a!=null){const y=new Map;for(let j of e){if(!j)continue;if(a&&a.length>0&&!a.includes(j.id)&&j.rect.current){y.set(j.id,j.rect.current);continue}const M=j.node.current,D=M?new Rect(v(M),M):null;j.rect.current=D,D&&y.set(j.id,D)}return y}return b},[e,a,o,h,v]);return reactExports.useEffect(()=>{c.current=e},[e]),reactExports.useEffect(()=>{h||u()},[o,h]),reactExports.useEffect(()=>{a&&a.length>0&&d(null)},[JSON.stringify(a)]),reactExports.useEffect(()=>{h||typeof g!="number"||E.current!==null||(E.current=setTimeout(()=>{u(),E.current=null},g))},[g,h,u,...r]),{droppableRects:R,measureDroppableContainers:u,measuringScheduled:a!=null};function S(){switch(i){case MeasuringStrategy.Always:return!1;case MeasuringStrategy.BeforeDragging:return o;default:return!o}}}function useInitialValue(e,t){return useLazyMemo(o=>e?o||(typeof t=="function"?t(e):e):null,[t,e])}function useInitialRect(e,t){return useInitialValue(e,t)}function useMutationObserver(e){let{callback:t,disabled:o}=e;const r=useEvent(t),s=reactExports.useMemo(()=>{if(o||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:a}=window;return new a(r)},[r,o]);return reactExports.useEffect(()=>()=>s?.disconnect(),[s]),s}function useResizeObserver(e){let{callback:t,disabled:o}=e;const r=useEvent(t),s=reactExports.useMemo(()=>{if(o||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:a}=window;return new a(r)},[o]);return reactExports.useEffect(()=>()=>s?.disconnect(),[s]),s}function defaultMeasure(e){return new Rect(getClientRect(e),e)}function useRect(e,t,o){t===void 0&&(t=defaultMeasure);const[r,s]=reactExports.useState(null);function a(){s(v=>{if(!e)return null;if(e.isConnected===!1){var i;return(i=v??o)!=null?i:null}const c=t(e);return JSON.stringify(v)===JSON.stringify(c)?v:c})}const d=useMutationObserver({callback(v){if(e)for(const i of v){const{type:c,target:h}=i;if(c==="childList"&&h instanceof HTMLElement&&h.contains(e)){a();break}}}}),g=useResizeObserver({callback:a});return useIsomorphicLayoutEffect(()=>{a(),e?(g?.observe(e),d?.observe(document.body,{childList:!0,subtree:!0})):(g?.disconnect(),d?.disconnect())},[e]),r}function useRectDelta(e){const t=useInitialValue(e);return getRectDelta(e,t)}const defaultValue$1=[];function useScrollableAncestors(e){const t=reactExports.useRef(e),o=useLazyMemo(r=>e?r&&r!==defaultValue$1&&e&&t.current&&e.parentNode===t.current.parentNode?r:getScrollableAncestors(e):defaultValue$1,[e]);return reactExports.useEffect(()=>{t.current=e},[e]),o}function useScrollOffsets(e){const[t,o]=reactExports.useState(null),r=reactExports.useRef(e),s=reactExports.useCallback(a=>{const d=getScrollableElement(a.target);d&&o(g=>g?(g.set(d,getScrollCoordinates(d)),new Map(g)):null)},[]);return reactExports.useEffect(()=>{const a=r.current;if(e!==a){d(a);const g=e.map(v=>{const i=getScrollableElement(v);return i?(i.addEventListener("scroll",s,{passive:!0}),[i,getScrollCoordinates(i)]):null}).filter(v=>v!=null);o(g.length?new Map(g):null),r.current=e}return()=>{d(e),d(a)};function d(g){g.forEach(v=>{const i=getScrollableElement(v);i?.removeEventListener("scroll",s)})}},[s,e]),reactExports.useMemo(()=>e.length?t?Array.from(t.values()).reduce((a,d)=>add(a,d),defaultCoordinates):getScrollOffsets(e):defaultCoordinates,[e,t])}function useScrollOffsetsDelta(e,t){t===void 0&&(t=[]);const o=reactExports.useRef(null);return reactExports.useEffect(()=>{o.current=null},t),reactExports.useEffect(()=>{const r=e!==defaultCoordinates;r&&!o.current&&(o.current=e),!r&&o.current&&(o.current=null)},[e]),o.current?subtract(e,o.current):defaultCoordinates}function useSensorSetup(e){reactExports.useEffect(()=>{if(!canUseDOM)return;const t=e.map(o=>{let{sensor:r}=o;return r.setup==null?void 0:r.setup()});return()=>{for(const o of t)o?.()}},e.map(t=>{let{sensor:o}=t;return o}))}function useSyntheticListeners(e,t){return reactExports.useMemo(()=>e.reduce((o,r)=>{let{eventName:s,handler:a}=r;return o[s]=d=>{a(d,t)},o},{}),[e,t])}function useWindowRect(e){return reactExports.useMemo(()=>e?getWindowClientRect(e):null,[e])}const defaultValue$2=[];function useRects(e,t){t===void 0&&(t=getClientRect);const[o]=e,r=useWindowRect(o?getWindow(o):null),[s,a]=reactExports.useState(defaultValue$2);function d(){a(()=>e.length?e.map(v=>isDocumentScrollingElement(v)?r:new Rect(t(v),v)):defaultValue$2)}const g=useResizeObserver({callback:d});return useIsomorphicLayoutEffect(()=>{g?.disconnect(),d(),e.forEach(v=>g?.observe(v))},[e]),s}function getMeasurableNode(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return isHTMLElement(t)?t:e}function useDragOverlayMeasuring(e){let{measure:t}=e;const[o,r]=reactExports.useState(null),s=reactExports.useCallback(i=>{for(const{target:c}of i)if(isHTMLElement(c)){r(h=>{const x=t(c);return h?{...h,width:x.width,height:x.height}:x});break}},[t]),a=useResizeObserver({callback:s}),d=reactExports.useCallback(i=>{const c=getMeasurableNode(i);a?.disconnect(),c&&a?.observe(c),r(c?t(c):null)},[t,a]),[g,v]=useNodeRef(d);return reactExports.useMemo(()=>({nodeRef:g,rect:o,setRef:v}),[o,g,v])}const defaultSensors=[{sensor:PointerSensor,options:{}},{sensor:KeyboardSensor,options:{}}],defaultData={current:{}},defaultMeasuringConfiguration={draggable:{measure:getTransformAgnosticClientRect},droppable:{measure:getTransformAgnosticClientRect,strategy:MeasuringStrategy.WhileDragging,frequency:MeasuringFrequency.Optimized},dragOverlay:{measure:getClientRect}};class DroppableContainersMap extends Map{get(t){var o;return t!=null&&(o=super.get(t))!=null?o:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:o}=t;return!o})}getNodeFor(t){var o,r;return(o=(r=this.get(t))==null?void 0:r.node.current)!=null?o:void 0}}const defaultPublicContext={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new DroppableContainersMap,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:noop},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:defaultMeasuringConfiguration,measureDroppableContainers:noop,windowRect:null,measuringScheduled:!1},defaultInternalContext={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:noop,draggableNodes:new Map,over:null,measureDroppableContainers:noop},InternalContext=reactExports.createContext(defaultInternalContext),PublicContext=reactExports.createContext(defaultPublicContext);function getInitialState(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new DroppableContainersMap}}}function reducer(e,t){switch(t.type){case Action.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case Action.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case Action.DragEnd:case Action.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Action.RegisterDroppable:{const{element:o}=t,{id:r}=o,s=new DroppableContainersMap(e.droppable.containers);return s.set(r,o),{...e,droppable:{...e.droppable,containers:s}}}case Action.SetDroppableDisabled:{const{id:o,key:r,disabled:s}=t,a=e.droppable.containers.get(o);if(!a||r!==a.key)return e;const d=new DroppableContainersMap(e.droppable.containers);return d.set(o,{...a,disabled:s}),{...e,droppable:{...e.droppable,containers:d}}}case Action.UnregisterDroppable:{const{id:o,key:r}=t,s=e.droppable.containers.get(o);if(!s||r!==s.key)return e;const a=new DroppableContainersMap(e.droppable.containers);return a.delete(o),{...e,droppable:{...e.droppable,containers:a}}}default:return e}}function RestoreFocus(e){let{disabled:t}=e;const{active:o,activatorEvent:r,draggableNodes:s}=reactExports.useContext(InternalContext),a=usePrevious(r),d=usePrevious(o?.id);return reactExports.useEffect(()=>{if(!t&&!r&&a&&d!=null){if(!isKeyboardEvent(a)||document.activeElement===a.target)return;const g=s.get(d);if(!g)return;const{activatorNode:v,node:i}=g;if(!v.current&&!i.current)return;requestAnimationFrame(()=>{for(const c of[v.current,i.current]){if(!c)continue;const h=findFirstFocusableNode(c);if(h){h.focus();break}}})}},[r,t,s,d,a]),null}function applyModifiers(e,t){let{transform:o,...r}=t;return e!=null&&e.length?e.reduce((s,a)=>a({transform:s,...r}),o):o}function useMeasuringConfiguration(e){return reactExports.useMemo(()=>({draggable:{...defaultMeasuringConfiguration.draggable,...e?.draggable},droppable:{...defaultMeasuringConfiguration.droppable,...e?.droppable},dragOverlay:{...defaultMeasuringConfiguration.dragOverlay,...e?.dragOverlay}}),[e?.draggable,e?.droppable,e?.dragOverlay])}function useLayoutShiftScrollCompensation(e){let{activeNode:t,measure:o,initialRect:r,config:s=!0}=e;const a=reactExports.useRef(!1),{x:d,y:g}=typeof s=="boolean"?{x:s,y:s}:s;useIsomorphicLayoutEffect(()=>{if(!d&&!g||!t){a.current=!1;return}if(a.current||!r)return;const i=t?.node.current;if(!i||i.isConnected===!1)return;const c=o(i),h=getRectDelta(c,r);if(d||(h.x=0),g||(h.y=0),a.current=!0,Math.abs(h.x)>0||Math.abs(h.y)>0){const x=getFirstScrollableAncestor(i);x&&x.scrollBy({top:h.y,left:h.x})}},[t,d,g,r,o])}const ActiveDraggableContext=reactExports.createContext({...defaultCoordinates,scaleX:1,scaleY:1});var Status;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Status||(Status={}));const DndContext=reactExports.memo(function e(t){var o,r,s,a;let{id:d,accessibility:g,autoScroll:v=!0,children:i,sensors:c=defaultSensors,collisionDetection:h=rectIntersection,measuring:x,modifiers:u,...E}=t;const R=reactExports.useReducer(reducer,void 0,getInitialState),[S,b]=R,[y,j]=useDndMonitorProvider(),[M,D]=reactExports.useState(Status.Uninitialized),_=M===Status.Initialized,{draggable:{active:w,nodes:C,translate:T},droppable:{containers:A}}=S,I=w!=null?C.get(w):null,B=reactExports.useRef({initial:null,translated:null}),P=reactExports.useMemo(()=>{var Q;return w!=null?{id:w,data:(Q=I?.data)!=null?Q:defaultData,rect:B}:null},[w,I]),F=reactExports.useRef(null),[O,Z]=reactExports.useState(null),[$,ue]=reactExports.useState(null),H=useLatestValue(E,Object.values(E)),re=useUniqueId("DndDescribedBy",d),K=reactExports.useMemo(()=>A.getEnabled(),[A]),ee=useMeasuringConfiguration(x),{droppableRects:W,measureDroppableContainers:ne,measuringScheduled:fe}=useDroppableMeasuring(K,{dragging:_,dependencies:[T.x,T.y],config:ee.droppable}),V=useCachedNode(C,w),oe=reactExports.useMemo(()=>$?getEventCoordinates($):null,[$]),ce=Ye(),Re=useInitialRect(V,ee.draggable.measure);useLayoutShiftScrollCompensation({activeNode:w!=null?C.get(w):null,config:ce.layoutShiftCompensation,initialRect:Re,measure:ee.draggable.measure});const G=useRect(V,ee.draggable.measure,Re),z=useRect(V?V.parentElement:null),N=reactExports.useRef({activatorEvent:null,active:null,activeNode:V,collisionRect:null,collisions:null,droppableRects:W,draggableNodes:C,draggingNode:null,draggingNodeRect:null,droppableContainers:A,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),J=A.getNodeFor((o=N.current.over)==null?void 0:o.id),L=useDragOverlayMeasuring({measure:ee.dragOverlay.measure}),U=(r=L.nodeRef.current)!=null?r:V,Y=_?(s=L.rect)!=null?s:G:null,pe=!!(L.nodeRef.current&&L.rect),te=useRectDelta(pe?null:G),se=useWindowRect(U?getWindow(U):null),me=useScrollableAncestors(_?J??V:null),Me=useRects(me),Te=applyModifiers(u,{transform:{x:T.x-te.x,y:T.y-te.y,scaleX:1,scaleY:1},activatorEvent:$,active:P,activeNodeRect:G,containerNodeRect:z,draggingNodeRect:Y,over:N.current.over,overlayNodeRect:L.rect,scrollableAncestors:me,scrollableAncestorRects:Me,windowRect:se}),Ne=oe?add(oe,T):null,Be=useScrollOffsets(me),Fe=useScrollOffsetsDelta(Be),$e=useScrollOffsetsDelta(Be,[G]),Se=add(Te,Fe),we=Y?getAdjustedRect(Y,Te):null,Ce=P&&we?h({active:P,collisionRect:we,droppableRects:W,droppableContainers:K,pointerCoordinates:Ne}):null,Oe=getFirstCollision(Ce,"id"),[be,Pe]=reactExports.useState(null),We=pe?Te:add(Te,$e),Ke=adjustScale(We,(a=be?.rect)!=null?a:null,G),_e=reactExports.useRef(null),Le=reactExports.useCallback((Q,ie)=>{let{sensor:ae,options:ye}=ie;if(F.current==null)return;const de=C.get(F.current);if(!de)return;const le=Q.nativeEvent,he=new ae({active:F.current,activeNode:de,event:le,options:ye,context:N,onAbort(X){if(!C.get(X))return;const{onDragAbort:ge}=H.current,xe={id:X};ge?.(xe),y({type:"onDragAbort",event:xe})},onPending(X,ve,ge,xe){if(!C.get(X))return;const{onDragPending:De}=H.current,Ee={id:X,constraint:ve,initialCoordinates:ge,offset:xe};De?.(Ee),y({type:"onDragPending",event:Ee})},onStart(X){const ve=F.current;if(ve==null)return;const ge=C.get(ve);if(!ge)return;const{onDragStart:xe}=H.current,ke={activatorEvent:le,active:{id:ve,data:ge.data,rect:B}};reactDomExports.unstable_batchedUpdates(()=>{xe?.(ke),D(Status.Initializing),b({type:Action.DragStart,initialCoordinates:X,active:ve}),y({type:"onDragStart",event:ke}),Z(_e.current),ue(le)})},onMove(X){b({type:Action.DragMove,coordinates:X})},onEnd:je(Action.DragEnd),onCancel:je(Action.DragCancel)});_e.current=he;function je(X){return async function(){const{active:ge,collisions:xe,over:ke,scrollAdjustedTranslate:De}=N.current;let Ee=null;if(ge&&De){const{cancelDrop:Ie}=H.current;Ee={activatorEvent:le,active:ge,collisions:xe,delta:De,over:ke},X===Action.DragEnd&&typeof Ie=="function"&&await Promise.resolve(Ie(Ee))&&(X=Action.DragCancel)}F.current=null,reactDomExports.unstable_batchedUpdates(()=>{b({type:X}),D(Status.Uninitialized),Pe(null),Z(null),ue(null),_e.current=null;const Ie=X===Action.DragEnd?"onDragEnd":"onDragCancel";if(Ee){const Ae=H.current[Ie];Ae?.(Ee),y({type:Ie,event:Ee})}})}}},[C]),Ue=reactExports.useCallback((Q,ie)=>(ae,ye)=>{const de=ae.nativeEvent,le=C.get(ye);if(F.current!==null||!le||de.dndKit||de.defaultPrevented)return;const he={active:le};Q(ae,ie.options,he)===!0&&(de.dndKit={capturedBy:ie.sensor},F.current=ye,Le(ae,ie))},[C,Le]),ze=useCombineActivators(c,Ue);useSensorSetup(c),useIsomorphicLayoutEffect(()=>{G&&M===Status.Initializing&&D(Status.Initialized)},[G,M]),reactExports.useEffect(()=>{const{onDragMove:Q}=H.current,{active:ie,activatorEvent:ae,collisions:ye,over:de}=N.current;if(!ie||!ae)return;const le={active:ie,activatorEvent:ae,collisions:ye,delta:{x:Se.x,y:Se.y},over:de};reactDomExports.unstable_batchedUpdates(()=>{Q?.(le),y({type:"onDragMove",event:le})})},[Se.x,Se.y]),reactExports.useEffect(()=>{const{active:Q,activatorEvent:ie,collisions:ae,droppableContainers:ye,scrollAdjustedTranslate:de}=N.current;if(!Q||F.current==null||!ie||!de)return;const{onDragOver:le}=H.current,he=ye.get(Oe),je=he&&he.rect.current?{id:he.id,rect:he.rect.current,data:he.data,disabled:he.disabled}:null,X={active:Q,activatorEvent:ie,collisions:ae,delta:{x:de.x,y:de.y},over:je};reactDomExports.unstable_batchedUpdates(()=>{Pe(je),le?.(X),y({type:"onDragOver",event:X})})},[Oe]),useIsomorphicLayoutEffect(()=>{N.current={activatorEvent:$,active:P,activeNode:V,collisionRect:we,collisions:Ce,droppableRects:W,draggableNodes:C,draggingNode:U,draggingNodeRect:Y,droppableContainers:A,over:be,scrollableAncestors:me,scrollAdjustedTranslate:Se},B.current={initial:Y,translated:we}},[P,V,Ce,we,C,U,Y,W,A,be,me,Se]),useAutoScroller({...ce,delta:T,draggingRect:we,pointerCoordinates:Ne,scrollableAncestors:me,scrollableAncestorRects:Me});const Ve=reactExports.useMemo(()=>({active:P,activeNode:V,activeNodeRect:G,activatorEvent:$,collisions:Ce,containerNodeRect:z,dragOverlay:L,draggableNodes:C,droppableContainers:A,droppableRects:W,over:be,measureDroppableContainers:ne,scrollableAncestors:me,scrollableAncestorRects:Me,measuringConfiguration:ee,measuringScheduled:fe,windowRect:se}),[P,V,G,$,Ce,z,L,C,A,W,be,ne,me,Me,ee,fe,se]),Je=reactExports.useMemo(()=>({activatorEvent:$,activators:ze,active:P,activeNodeRect:G,ariaDescribedById:{draggable:re},dispatch:b,draggableNodes:C,over:be,measureDroppableContainers:ne}),[$,ze,P,G,b,re,C,be,ne]);return React.createElement(DndMonitorContext.Provider,{value:j},React.createElement(InternalContext.Provider,{value:Je},React.createElement(PublicContext.Provider,{value:Ve},React.createElement(ActiveDraggableContext.Provider,{value:Ke},i)),React.createElement(RestoreFocus,{disabled:g?.restoreFocus===!1})),React.createElement(Accessibility,{...g,hiddenTextDescribedById:re}));function Ye(){const Q=O?.autoScrollEnabled===!1,ie=typeof v=="object"?v.enabled===!1:v===!1,ae=_&&!Q&&!ie;return typeof v=="object"?{...v,enabled:ae}:{enabled:ae}}}),NullContext=reactExports.createContext(null),defaultRole="button",ID_PREFIX="Draggable";function useDraggable(e){let{id:t,data:o,disabled:r=!1,attributes:s}=e;const a=useUniqueId(ID_PREFIX),{activators:d,activatorEvent:g,active:v,activeNodeRect:i,ariaDescribedById:c,draggableNodes:h,over:x}=reactExports.useContext(InternalContext),{role:u=defaultRole,roleDescription:E="draggable",tabIndex:R=0}=s??{},S=v?.id===t,b=reactExports.useContext(S?ActiveDraggableContext:NullContext),[y,j]=useNodeRef(),[M,D]=useNodeRef(),_=useSyntheticListeners(d,t),w=useLatestValue(o);useIsomorphicLayoutEffect(()=>(h.set(t,{id:t,key:a,node:y,activatorNode:M,data:w}),()=>{const T=h.get(t);T&&T.key===a&&h.delete(t)}),[h,t]);const C=reactExports.useMemo(()=>({role:u,tabIndex:R,"aria-disabled":r,"aria-pressed":S&&u===defaultRole?!0:void 0,"aria-roledescription":E,"aria-describedby":c.draggable}),[r,u,R,S,E,c.draggable]);return{active:v,activatorEvent:g,activeNodeRect:i,attributes:C,isDragging:S,listeners:r?void 0:_,node:y,over:x,setNodeRef:j,setActivatorNodeRef:D,transform:b}}const ID_PREFIX$1="Droppable",defaultResizeObserverConfig={timeout:25};function useDroppable(e){let{data:t,disabled:o=!1,id:r,resizeObserverConfig:s}=e;const a=useUniqueId(ID_PREFIX$1),{active:d,dispatch:g,over:v,measureDroppableContainers:i}=reactExports.useContext(InternalContext),c=reactExports.useRef({disabled:o}),h=reactExports.useRef(!1),x=reactExports.useRef(null),u=reactExports.useRef(null),{disabled:E,updateMeasurementsFor:R,timeout:S}={...defaultResizeObserverConfig,...s},b=useLatestValue(R??r),y=reactExports.useCallback(()=>{if(!h.current){h.current=!0;return}u.current!=null&&clearTimeout(u.current),u.current=setTimeout(()=>{i(Array.isArray(b.current)?b.current:[b.current]),u.current=null},S)},[S]),j=useResizeObserver({callback:y,disabled:E||!d}),M=reactExports.useCallback((C,T)=>{j&&(T&&(j.unobserve(T),h.current=!1),C&&j.observe(C))},[j]),[D,_]=useNodeRef(M),w=useLatestValue(t);return reactExports.useEffect(()=>{!j||!D.current||(j.disconnect(),h.current=!1,j.observe(D.current))},[D,j]),reactExports.useEffect(()=>(g({type:Action.RegisterDroppable,element:{id:r,key:a,disabled:o,node:D,rect:x,data:w}}),()=>g({type:Action.UnregisterDroppable,key:a,id:r})),[r]),reactExports.useEffect(()=>{o!==c.current.disabled&&(g({type:Action.SetDroppableDisabled,id:r,key:a,disabled:o}),c.current.disabled=o)},[r,a,o,g]),{active:d,rect:x,isOver:v?.id===r,node:D,over:v,setNodeRef:_}}function ComponentItem({componentId:e,comp:t,isSelected:o,onSelect:r,onResize:s,showGroupDragHandle:a,onGroupDragPointerDown:d}){const{attributes:g,listeners:v,setNodeRef:i,transform:c,isDragging:h}=useDraggable({id:t.id}),x=reactExports.useRef(!1),u=reactExports.useRef({x:0,y:0,width:0,height:0}),[E,R]=reactExports.useState(!1),[S,b]=reactExports.useState({x:0,y:0}),y=[{key:"top",label:"置顶"},{key:"bottom",label:"置底"},{key:"up",label:"上移一层"},{key:"down",label:"下移一层"},{type:"divider"},{key:"delete",label:"删除"},{key:"copy",label:"复制"},{type:"divider"},{key:"lock",label:t.locked?"解锁":"锁定"},{key:"visible",label:t.visible?"隐藏":"显示"}],j=useComponentsStore(O=>O.components),D=(e?j.find(O=>O.id===e):void 0)||t;if(D.visible===!1)return null;const _=O=>{O.stopPropagation(),x.current=!0,u.current={x:O.clientX,y:O.clientY,width:D.width,height:D.height},document.addEventListener("mousemove",w),document.addEventListener("mouseup",C)},w=O=>{if(!x.current)return;const Z=O.clientX-u.current.x,$=O.clientY-u.current.y,ue=Math.max(20,u.current.width+Z),H=Math.max(20,u.current.height+$);s(ue,H)},C=()=>{x.current=!1,document.removeEventListener("mousemove",w),document.removeEventListener("mouseup",C)},T=O=>{O.stopPropagation(),x.current?console.log("[ComponentItem] handleClick 忽略(正在缩放)",D.id):r()},A=O=>{O.preventDefault(),O.stopPropagation(),b({x:O.clientX,y:O.clientY}),R(!0)},I=({key:O})=>{R(!1),window.dispatchEvent(new CustomEvent("component-menu",{detail:{key:O,id:D.id}}))},B={position:"absolute",left:D.x+(c?.x||0),top:D.y+(c?.y||0),width:D.width,height:D.height,background:D.locked?"#f5f5f5":"#fff",border:o?"2.5px solid #ff9800":"none",borderRadius:4,display:"flex",alignItems:"center",justifyContent:"center",fontWeight:500,color:"#1976d2",boxShadow:o?"0 0 0 3px #ffe0b2":"0 2px 8px #1976d233",cursor:D.locked?"not-allowed":h?"grabbing":"move",userSelect:"none",zIndex:D.zindex??1,transition:"box-shadow 0.2s, border 0.2s",opacity:typeof D.opacity=="number"?D.opacity:D.locked?.5:h?.7:1,transform:D.rotatable&&typeof D.rotation=="number"?`rotate(${D.rotation}deg)`:void 0,overflow:"visible",pointerEvents:D.locked?"none":"auto"},P=componentRegistry[D.type]?.Component||(()=>jsxRuntimeExports.jsxs("span",{style:{color:"red"},children:["未知组件类型: ",D.type]})),F=jsxRuntimeExports.jsx(P,{componentId:D.id,style:{opacity:B.opacity}});return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{ref:i,style:B,tabIndex:0,onClick:D.locked?void 0:T,onPointerDown:D.locked?void 0:()=>{},onMouseDown:D.locked?void 0:()=>{},onPointerUp:D.locked?void 0:()=>{},onContextMenu:A,children:[D.locked&&jsxRuntimeExports.jsx("span",{style:{position:"absolute",left:4,top:4,color:"#bdbdbd",fontSize:16,zIndex:100,pointerEvents:"none"},title:"已锁定",children:jsxRuntimeExports.jsx(RefIcon$5,{})}),!D.locked&&a&&d?jsxRuntimeExports.jsx("div",{style:{position:"absolute",left:-10,top:-10,width:18,height:18,background:"#1976d2",borderRadius:4,cursor:"grab",zIndex:99,display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontSize:12,userSelect:"none",boxShadow:"0 2px 8px #1976d233"},onPointerDown:d,onClick:O=>O.stopPropagation(),title:"多选拖动",children:"≡"}):!D.locked&&jsxRuntimeExports.jsx("div",{...v,...g,style:{position:"absolute",left:-10,top:-10,width:18,height:18,background:"#1976d2",borderRadius:4,cursor:h?"grabbing":"grab",zIndex:99,display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontSize:12,userSelect:"none",boxShadow:"0 2px 8px #1976d233"},"data-drag-handle":"true",onClick:O=>O.stopPropagation(),title:"拖拽移动",children:"≡"}),jsxRuntimeExports.jsxs("div",{style:{width:"100%",height:"100%"},children:[F,o&&!D.locked&&D.resizable!==!1&&jsxRuntimeExports.jsx("div",{onMouseDown:_,style:{position:"absolute",right:-10,bottom:-10,width:18,height:18,background:"#fff",border:"2.5px solid #ff9800",borderRadius:4,cursor:"nwse-resize",zIndex:99,boxShadow:"0 2px 8px #1976d233",display:"flex",alignItems:"center",justifyContent:"center"},children:jsxRuntimeExports.jsx("div",{style:{width:10,height:10,background:"#ff9800",borderRadius:2}})})]}),jsxRuntimeExports.jsxs("span",{style:{position:"absolute",right:4,top:4,background:"#ccc",color:"#fff",fontSize:12,borderRadius:4,padding:"0 6px",zIndex:101,pointerEvents:"none",opacity:.85,fontWeight:100},title:"层级(zIndex)",children:["z: ",D.zindex??1]})]}),jsxRuntimeExports.jsx(Dropdown,{menu:{items:y,onClick:I},open:E,trigger:[],onOpenChange:R,getPopupContainer:()=>document.body,overlayStyle:{position:"fixed",left:S.x,top:S.y,zIndex:2e3}})]})}const CanvasContent=({components:e,selectedIds:t,setSelectedIds:o,isSelecting:r,selectRect:s,handleMouseDown:a,onResize:d,onMove:g})=>{const[,v]=reactExports.useState({}),i=reactExports.useRef(!1),c=reactExports.useRef(null),h=reactExports.useRef({}),x=React.useCallback(S=>{if(!i.current||!c.current)return;const b=S.clientX-c.current.x,y=S.clientY-c.current.y;Object.entries(h.current).forEach(([j,M])=>{g(j,M.x+b,M.y+y)})},[g]),u=React.useCallback(()=>{i.current=!1,c.current=null,h.current={},document.removeEventListener("pointermove",x),document.removeEventListener("pointerup",u),v({})},[x]);let E=null;if(t.length>1){const S=e.filter(C=>t.includes(C.id)),b=Math.min(...S.map(C=>C.x)),y=Math.min(...S.map(C=>C.y)),j=Math.max(...S.map(C=>C.x+C.width)),M=Math.max(...S.map(C=>C.y+C.height)),D=j-b,_=M-y,w=C=>{C.stopPropagation(),C.preventDefault(),i.current=!0,c.current={x:C.clientX,y:C.clientY};const T={};S.forEach(A=>{T[A.id]={x:A.x,y:A.y}}),h.current=T,document.addEventListener("pointermove",x),document.addEventListener("pointerup",u)};E=jsxRuntimeExports.jsx("div",{style:{position:"absolute",left:b,top:y,width:D,height:_,border:"2px dashed #1976d2",background:"rgba(25, 118, 210, 0.04)",zIndex:999,pointerEvents:"auto"},children:jsxRuntimeExports.jsx("div",{style:{position:"absolute",right:-14,top:-14,width:24,height:24,background:"#e53935",borderRadius:6,color:"#fff",fontSize:14,display:"flex",alignItems:"center",justifyContent:"center",cursor:"grab",zIndex:1e3,pointerEvents:"auto",boxShadow:"0 2px 8px #e5393522",border:"2px solid #fff"},onPointerDown:w,title:"拖动选中组件组",children:"≡"})})}const R=S=>{S.target.getAttribute("data-drag-handle")!=="true"&&(i.current||a(S))};return jsxRuntimeExports.jsxs("div",{style:{position:"absolute",left:16,top:16,width:"100%",height:"100%",userSelect:s?"none":void 0,zIndex:10,background:"transparent"},onMouseDown:R,children:[s&&jsxRuntimeExports.jsx("div",{style:{position:"absolute",left:s.x,top:s.y,width:s.w,height:s.h,border:"1.5px dashed #1976d2",background:"rgba(25, 118, 210, 0.08)",pointerEvents:"none",zIndex:1e3}}),E,jsxRuntimeExports.jsxs("div",{style:{width:"100%",height:"100%",position:"absolute",left:0,top:0,pointerEvents:r?"none":"auto",zIndex:20},children:[e.length===0&&jsxRuntimeExports.jsx("div",{children:"拖拽左侧组件到此处"}),e.map(S=>jsxRuntimeExports.jsx(ComponentItem,{componentId:S.id,comp:S,isSelected:t.includes(S.id),onSelect:()=>o([S.id]),onResize:(b,y)=>d(S.id,b,y)},S.id))]})]})},Grid=({canvasConfig:e})=>{if(!e.showGrid)return null;const{width:t,height:o,gridSize:r}=e,s=[];for(let a=r;a<t;a+=r)s.push(jsxRuntimeExports.jsx("div",{style:{position:"absolute",left:a+16,top:16,width:1,height:o,background:"#e0e0e0",zIndex:5}},"v-"+a));for(let a=r;a<o;a+=r)s.push(jsxRuntimeExports.jsx("div",{style:{position:"absolute",top:a+16,left:16,width:t,height:1,background:"#e0e0e0",zIndex:5}},"h-"+a));return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:s})},Ruler=({canvasConfig:e})=>{if(!e.showRuler)return null;const{width:t,height:o,gridSize:r}=e,s=[];for(let d=0;d<=t;d+=r)s.push(jsxRuntimeExports.jsx("div",{style:{position:"absolute",left:d,top:0,width:1,height:16,background:"#bdbdbd"}},d)),d%(r*5)===0&&s.push(jsxRuntimeExports.jsx("div",{style:{position:"absolute",left:d+2,top:0,fontSize:10,color:"#888",userSelect:"none"},children:d},d+"-label"));const a=[];for(let d=0;d<=o;d+=r)a.push(jsxRuntimeExports.jsx("div",{style:{position:"absolute",top:d,left:0,width:16,height:1,background:"#bdbdbd"}},d)),d%(r*5)===0&&a.push(jsxRuntimeExports.jsx("div",{style:{position:"absolute",top:d+2,left:0,fontSize:10,color:"#888",userSelect:"none"},children:d},d+"-label"));return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{style:{position:"absolute",left:16,top:0,width:t,height:16,background:"#f5f5f5",borderBottom:"1px solid #e0e0e0",zIndex:20},children:s}),jsxRuntimeExports.jsx("div",{style:{position:"absolute",left:0,top:16,width:16,height:o,background:"#f5f5f5",borderRight:"1px solid #e0e0e0",zIndex:20},children:a})]})};function useBatchActions(e,t,o,r,s,a,d,g,v){return{handleDeleteSelected:()=>{o(t)},handleBatchLock:R=>{r(t,R)},handleBatchVisible:R=>{s(t,R)},handleShowAll:()=>{s(e.map(R=>R.id),!0)},handleAlign:R=>{if(t.length<2)return;const S=g(e,t,R);Object.entries(S).forEach(([b,y])=>a([b],y))},handleDistribute:R=>{if(t.length<3)return;const S=v(e,t,R);Object.entries(S).forEach(([b,y])=>a([b],y))}}}function useCanvasDnd({components:e,canvasConfig:t,addComponent:o,setSelectedIds:r,updateComponent:s}){useDndMonitor({onDragEnd(a){const{active:d,over:g,delta:v}=a;if(g?.id==="canvas"&&d.data?.current?.type){const i=d.data.current.type,c=`${i}_${Date.now()}`;let h={};i==="label"?h={text:"新标签"}:i==="image"?h={src:""}:i==="table"&&(h={dataBinding:{dataSource:"",dataNode:"",columns:[]}}),o({id:c,type:i,x:40+Math.random()*200,y:40+Math.random()*100,width:120,height:40,locked:!1,visible:!0,zindex:1,props:h,resizable:!0,rotatable:!1,rotation:0,opacity:1}),r([c])}if(d.id&&typeof d.id=="string"&&e.some(i=>i.id===d.id)&&v){const i=e.find(c=>c.id===d.id);if(i){let c=i.x+v.x,h=i.y+v.y;if(t.allowSnapToGrid){const x=t.gridSize;c=Math.round(c/x)*x,h=Math.round(h/x)*x}s(i.id,{x:c,y:h})}}}})}function useComponentMenu({components:e,updateComponent:t,removeComponent:o,copyComponent:r,moveComponentZIndex:s,setSelectedIds:a}){reactExports.useEffect(()=>{const d=g=>{const{key:v,id:i}=g.detail,c=e.find(h=>h.id===i);if(c){switch(v){case"top":s(i,"top");break;case"bottom":s(i,"bottom");break;case"up":s(i,"up");break;case"down":s(i,"down");break;case"delete":o(i);break;case"copy":r(i);break;case"lock":t(i,{locked:!c.locked});break;case"visible":t(i,{visible:!c.visible});break}a([i])}};return window.addEventListener("component-menu",d),()=>window.removeEventListener("component-menu",d)},[e,t,o,r,s,a])}function useSelectionBox(e,t){const[o,r]=reactExports.useState(null),[s,a]=reactExports.useState(!1),d=reactExports.useRef(null),g=reactExports.useRef(!1),v=reactExports.useRef(5),i=reactExports.useRef(5),c=reactExports.useRef(e);c.current=e;const h=reactExports.useRef(t);h.current=t;const x=reactExports.useCallback(b=>{if(!d.current)return;const y=document.getElementById("report-canvas-main");if(!y)return;const j=y.getBoundingClientRect(),M=b.clientX-j.left,D=b.clientY-j.top,_=Math.abs(M-d.current.x),w=Math.abs(D-d.current.y);if(!g.current&&_>v.current&&w>i.current&&(g.current=!0,a(!0)),g.current){const C=Math.min(d.current.x,M),T=Math.min(d.current.y,D),A=Math.abs(M-d.current.x),I=Math.abs(D-d.current.y);r({x:C,y:T,w:A,h:I})}},[]),u=reactExports.useCallback(b=>{if(b.stopPropagation(),!d.current)return;const y=document.getElementById("report-canvas-main");if(!y)return;const j=y.getBoundingClientRect(),M=16,D=16,_=b.clientX-j.left-M,w=b.clientY-j.top-D,C=d.current.x-M,T=d.current.y-D,A=Math.min(C,_),I=Math.min(T,w),B=Math.max(C,_),P=Math.max(T,w);if(g.current){const F=c.current.filter(O=>{const Z=O.x,$=O.y,ue=O.x+O.width,H=O.y+O.height;return Z<B&&ue>A&&$<P&&H>I});h.current(F.map(O=>O.id))}else{const F=_,O=w,Z=c.current.find($=>F>=$.x&&F<=$.x+$.width&&O>=$.y&&O<=$.y+$.height);h.current(Z?[Z.id]:[])}r(null),d.current=null,a(!1),g.current=!1,document.removeEventListener("mousemove",E.current),document.removeEventListener("mouseup",R.current)},[]),E=reactExports.useRef(null),R=reactExports.useRef(null);return E.current=x,R.current=u,{selectRect:o,isSelecting:s,handleMouseDown:b=>{if(b.button!==0)return;const y=b.currentTarget.getBoundingClientRect(),j=b.clientX-y.left,M=b.clientY-y.top;d.current={x:j,y:M},r(null),a(!1),g.current=!1,e.length>0?(v.current=Math.max(5,Math.min(...e.map(D=>D.width))),i.current=Math.max(5,Math.min(...e.map(D=>D.height)))):(v.current=5,i.current=5),document.addEventListener("mousemove",E.current),document.addEventListener("mouseup",R.current)}}}let justSelectedByBox=!1;function Canvas(){const{setNodeRef:e,isOver:t}=useDroppable({id:"canvas"}),o=useComponentsStore(w=>w.addComponent),r=useComponentsStore(w=>w.components),s=useSelectionStore(w=>w.selectedIds),a=useSelectionStore(w=>w.setSelectedIds),d=useComponentsStore(w=>w.updateComponent),g=useCanvasStore(w=>w.canvasConfig),v=useComponentsStore(w=>w.batchUpdateComponent),i=useComponentsStore(w=>w.batchRemoveComponent),c=useComponentsStore(w=>w.batchLockComponent),h=useComponentsStore(w=>w.batchVisibleComponent),x=useComponentsStore(w=>w.removeComponent),u=useComponentsStore(w=>w.copyComponent),E=useComponentsStore(w=>w.moveComponentZIndex),R=useComponentsStore(w=>w.undo),S=useComponentsStore(w=>w.redo),{selectRect:b,isSelecting:y,handleMouseDown:j}=useSelectionBox(r,(...w)=>{a(...w),justSelectedByBox=!0,setTimeout(()=>{justSelectedByBox=!1},0)}),M=useBatchActions(r,s,i,c,h,v,a,getAlignUpdates,getDistributeUpdates);useCanvasDnd({components:r,canvasConfig:g,addComponent:o,setSelectedIds:a,updateComponent:d}),useComponentMenu({components:r,updateComponent:d,removeComponent:x,copyComponent:u,moveComponentZIndex:E,setSelectedIds:a});const D=s.length>0&&s.every(w=>{const C=r.find(T=>T.id===w);return C&&C.rotatable}),_=reactExports.useRef(null);return reactExports.useEffect(()=>{const w=C=>{const T=C.target?.tagName?.toLowerCase();if(!(T==="input"||T==="textarea"||C.target?.isContentEditable)){if((C.ctrlKey||C.metaKey)&&C.key.toLowerCase()==="z"){C.preventDefault(),R();return}if((C.ctrlKey||C.metaKey)&&C.key.toLowerCase()==="y"){C.preventDefault(),S();return}if((C.key==="Delete"||C.key==="Backspace")&&s.length>0){C.preventDefault(),i(s);return}if((C.ctrlKey||C.metaKey)&&C.key.toLowerCase()==="c"){if(s.length>0){C.preventDefault();const A=r.filter(I=>s.includes(I.id));_.current=JSON.parse(JSON.stringify(A))}return}if((C.ctrlKey||C.metaKey)&&C.key.toLowerCase()==="v"){if(_.current&&_.current.length>0){C.preventDefault();const A=_.current.map(I=>{const B=`${I.id}_paste_${Date.now()}_${Math.floor(Math.random()*1e4)}`;return{...I,id:B,x:(I.x||0)+30,y:(I.y||0)+30,name:void 0}});A.forEach(I=>o(I)),setTimeout(()=>{a(A.map(I=>I.id))},0)}return}}};return window.addEventListener("keydown",w),()=>window.removeEventListener("keydown",w)},[r,s,i,o,a,R,S]),jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",width:"100%",height:"100%",margin:"auto"},children:[jsxRuntimeExports.jsx(BatchToolbar,{selectedCount:s.length,canDistribute:s.length>=3,allRotatable:D,onDeleteSelected:M.handleDeleteSelected,onBatchLock:M.handleBatchLock,onBatchVisible:M.handleBatchVisible,onShowAll:M.handleShowAll,onAlign:M.handleAlign,onDistribute:M.handleDistribute,onBatchResizable:w=>{s.forEach(C=>d(C,{resizable:w}))},onBatchRotatable:w=>{s.forEach(C=>d(C,{rotatable:w}))},onBatchRotation:w=>{s.forEach(C=>d(C,{rotation:w}))},onBatchOpacity:w=>{s.forEach(C=>d(C,{opacity:w}))}}),jsxRuntimeExports.jsxs("div",{ref:e,id:"report-canvas-main",style:{minHeight:g.height+16,minWidth:g.width+16,width:g.width+16,height:g.height+16,padding:0,fontWeight:600,color:t?"#fff":"#1976d2",background:t?"#1976d2":"#e3f2fd",border:"2px solid #1976d2",borderRadius:6,transition:"all 0.2s",position:"relative",overflow:"visible"},onClick:()=>{justSelectedByBox||a([])},children:[jsxRuntimeExports.jsx(Ruler,{canvasConfig:g}),jsxRuntimeExports.jsx(Grid,{canvasConfig:g}),jsxRuntimeExports.jsx(CanvasContent,{components:r,selectedIds:s,setSelectedIds:a,isSelecting:y,selectRect:b,handleMouseDown:j,onResize:(w,C,T)=>d(w,{width:C,height:T}),onMove:(w,C,T)=>d(w,{x:C,y:T})})]})]})})}const COMPONENTS=Object.values(componentRegistry).map(e=>({type:e.type,name:e.displayName,icon:e.icon}));function DraggableItem({type:e,name:t,icon:o}){const{attributes:r,listeners:s,setNodeRef:a,isDragging:d}=useDraggable({id:e,data:{type:e}});return jsxRuntimeExports.jsxs("div",{ref:a,...s,...r,style:{padding:12,marginBottom:12,fontWeight:600,color:d?"#fff":"#d32f2f",background:d?"#d32f2f":"#fffbe6",border:"2px solid #d32f2f",borderRadius:6,cursor:"grab",opacity:d?.6:1,userSelect:"none",transition:"all 0.2s",display:"flex",alignItems:"center",gap:8},children:[jsxRuntimeExports.jsx("span",{style:{fontSize:18},children:o}),t]})}function ComponentLibrary(){return jsxRuntimeExports.jsx("div",{style:{padding:16},children:COMPONENTS.map(e=>jsxRuntimeExports.jsx(DraggableItem,{type:e.type,name:e.name,icon:e.icon},e.type))})}function ColumnsField({value:e=[],onChange:t,itemSchema:o,dataSourceFields:r=[]}){const s=(i,c,h)=>{const x=e.map((u,E)=>E===i?{...u,[c]:c==="label"?typeof h=="string"?h:h?.label||h?.value||"":h}:u);t(x)},a=()=>{const i={};o.forEach(c=>{c.type==="switch"?i[c.key]=!0:i[c.key]=void 0}),t([...e||[],i])},d=i=>{const c=e.filter((h,x)=>x!==i);t(c)},g=(i,c,h)=>{const x={value:c[i.key],onChange:u=>s(h,i.key,u),item:i};if(i.type==="input")return jsxRuntimeExports.jsx(Input,{value:typeof c[i.key]=="string"||typeof c[i.key]=="number"?c[i.key]:c[i.key]?.label||c[i.key]?.value||"",onChange:u=>s(h,i.key,u.target.value)});if(i.type==="number")return jsxRuntimeExports.jsx(TypedInputNumber,{...x});if(i.type==="switch")return jsxRuntimeExports.jsx(Switch,{checked:!!c[i.key],onChange:u=>s(h,i.key,u)});if(i.type==="select"){const u=i.key==="field"&&r&&r.length>0?r:i.options||[];return jsxRuntimeExports.jsx(Select,{...x,options:u,style:{minWidth:80}})}return jsxRuntimeExports.jsx(Input,{...x})},v=[...o.map(i=>({title:i.label,dataIndex:i.key,key:i.key,render:(c,h,x)=>g(i,h,x)})),{title:"操作",key:"actions",render:(i,c,h)=>jsxRuntimeExports.jsx(Button,{danger:!0,size:"small",onClick:()=>d(h),children:"删除"})}];return jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(ForwardTable,{columns:v,dataSource:e.map((i,c)=>({...i,_rowKey:c})),rowKey:"_rowKey",pagination:!1,size:"small",bordered:!0}),jsxRuntimeExports.jsx(Space,{style:{marginTop:8},children:jsxRuntimeExports.jsx(Button,{type:"dashed",onClick:a,size:"small",children:"添加字段"})})]})}function FieldRenderer({item:e,value:t,onChange:o,dataSourceFields:r}){switch(e.type){case"input":return jsxRuntimeExports.jsx(Input,{value:t,onChange:s=>o(s.target.value),style:{width:180},disabled:e.disabled});case"number":return jsxRuntimeExports.jsx(TypedInputNumber,{value:t,onChange:o,style:{width:120},disabled:e.disabled});case"switch":return jsxRuntimeExports.jsx(Switch,{checked:!!t,onChange:o,disabled:e.disabled});case"select":return jsxRuntimeExports.jsx(Select,{value:t,onChange:o,style:{width:120},options:e.options||[],disabled:e.disabled});case"color":return jsxRuntimeExports.jsx(Input,{type:"color",value:t,onChange:s=>o(s.target.value),style:{width:40,height:32,padding:0,border:"none",background:"none"},disabled:e.disabled});case"json":return jsxRuntimeExports.jsx(Input.TextArea,{value:typeof t=="string"?t:JSON.stringify(t,null,2),onChange:s=>{const a=s.target.value;try{const d=JSON.parse(a);o(d)}catch{}},autoSize:{minRows:4,maxRows:16},style:{width:320},placeholder:"请输入合法的 JSON 格式"});case"textarea":return jsxRuntimeExports.jsx(Input.TextArea,{value:t,onChange:s=>o(s.target.value),autoSize:{minRows:2,maxRows:8},style:{width:320},disabled:e.disabled,placeholder:e.placeholder});case"text":return jsxRuntimeExports.jsx(Input,{value:t,disabled:!0,style:{width:180}});case"columns":return jsxRuntimeExports.jsx(ColumnsField,{value:t,onChange:o,itemSchema:e.itemSchema,dataSourceFields:r});default:return null}}const BasePropertyPanel=({schema:e,selected:t,isRotatable:o,handleBaseChange:r})=>jsxRuntimeExports.jsx("div",{children:e.base?.map(s=>{const a=s.key==="rotation"?{...s,disabled:!o}:s;return jsxRuntimeExports.jsxs("div",{style:{marginBottom:8,display:"flex",alignItems:"center",gap:8},children:[jsxRuntimeExports.jsxs("span",{style:{width:80},children:[s.label,"："]}),jsxRuntimeExports.jsx(FieldRenderer,{item:a,value:t[s.key]??s.default,onChange:d=>r(s.key,d)})]},s.key)})}),DataBindingPanel=({schema:e,selected:t,dataSources:o,handleDataBindingChange:r})=>{const[s,a]=reactExports.useState(!1),d=t?.type,g=t.props?.dataBinding?.dataSource,v=o.find(y=>y.key===g),i=v?.dataNodes?.map(y=>({label:y,value:y}))||[],c=t.props?.dataBinding?.dataNode,h=(v?.dataNodeFields?.[c]||[]).map(y=>({label:y,value:y})),x=(v?.fields||[]).map(y=>({label:y,value:y})),u=e.dataBinding?.find(y=>y.key==="columns"),E=t.props?.dataBinding?.columns??[],R=e.dataBinding?.find(y=>y.key==="field"),S=t.props?.dataBinding?.field??void 0,b=(y,j)=>{if(y==="dataSource"){const M={dataSource:j};d==="table"?(M.dataNode="",M.columns=[]):M.field=void 0,r("all",M);return}if(y==="dataNode"){d==="table"&&r("all",{dataSource:g,dataNode:j,columns:[]});return}r(y,j)};return jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{style:{marginBottom:8,display:"flex",alignItems:"center",gap:8},children:[jsxRuntimeExports.jsx("span",{style:{width:80},children:"数据源："}),jsxRuntimeExports.jsx(Select,{style:{minWidth:220},value:g??"",options:[{label:"请选择数据源",value:""},...o.map(y=>({label:y.name,value:y.key}))],onChange:y=>b("dataSource",y)})]}),g&&jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:d==="table"?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{style:{marginBottom:8,display:"flex",alignItems:"center",gap:8},children:[jsxRuntimeExports.jsx("span",{style:{width:80},children:"数据节点："}),jsxRuntimeExports.jsx(Select,{style:{minWidth:220},value:c??"",options:[{label:"请选择数据节点",value:""},...i],onChange:y=>b("dataNode",y)})]}),c&&u&&jsxRuntimeExports.jsxs("div",{style:{marginBottom:8,display:"flex",alignItems:"center",gap:8},children:[jsxRuntimeExports.jsx("span",{style:{width:80},children:"字段映射："}),jsxRuntimeExports.jsx(Button,{size:"small",onClick:()=>a(!0),children:"编辑"}),jsxRuntimeExports.jsx("div",{style:{flex:1},children:E&&E.length>0?jsxRuntimeExports.jsx("ul",{style:{margin:0,padding:0,listStyle:"none"},children:E.map((y,j)=>jsxRuntimeExports.jsxs("li",{style:{fontSize:12,color:"#888"},children:[y.label||y.field||"-",y.visible===!1?jsxRuntimeExports.jsx("span",{style:{color:"#bbb",marginLeft:4},children:"[隐藏]"}):null]},y.field?`${y.field}_${j}`:j))}):jsxRuntimeExports.jsx("span",{style:{color:"#bbb",fontSize:12},children:"未配置字段"})}),jsxRuntimeExports.jsxs(Drawer,{title:"字段映射配置",placement:"right",open:s,onClose:()=>a(!1),width:900,destroyOnClose:!0,footer:null,children:[jsxRuntimeExports.jsx(FieldRenderer,{item:u,value:E,onChange:y=>b("columns",y),dataSourceFields:h}),jsxRuntimeExports.jsx("div",{style:{textAlign:"right",marginTop:16},children:jsxRuntimeExports.jsx(Button,{onClick:()=>a(!1),style:{marginRight:8},children:"关闭"})})]})]})]}):R&&jsxRuntimeExports.jsxs("div",{style:{marginBottom:8,display:"flex",alignItems:"center",gap:8},children:[jsxRuntimeExports.jsx("span",{style:{width:80},children:"绑定字段："}),jsxRuntimeExports.jsx(Select,{style:{minWidth:220},value:S??void 0,options:[{label:"请选择字段",value:void 0},...x],onChange:y=>b("field",y)})]})})]})},StandardPropertyPanel=({schema:e,selected:t,handleStandardChange:o})=>jsxRuntimeExports.jsx("div",{children:e.standard?.map(r=>jsxRuntimeExports.jsxs("div",{style:{marginBottom:8,display:"flex",alignItems:"center",gap:8},children:[jsxRuntimeExports.jsxs("span",{style:{width:80},children:[r.label,"："]}),jsxRuntimeExports.jsx(FieldRenderer,{item:r,value:t.props?.[r.key]??r.default,onChange:s=>o(r.key,s)})]},r.key))}),baseSchema=[{key:"id",label:"ID",type:"text",disabled:!0},{key:"type",label:"类型",type:"text",disabled:!0},{key:"name",label:"名称",type:"input"},{key:"x",label:"X 坐标",type:"number"},{key:"y",label:"Y 坐标",type:"number"},{key:"width",label:"宽度",type:"number"},{key:"height",label:"高度",type:"number"},{key:"locked",label:"锁定",type:"switch"},{key:"visible",label:"显示",type:"switch"},{key:"zindex",label:"层级",type:"number"},{key:"resizable",label:"可缩放",type:"switch"},{key:"rotatable",label:"可旋转",type:"switch"},{key:"rotation",label:"旋转角度",type:"number"},{key:"opacity",label:"透明度",type:"number"}],schemaRegistry={};function registerComponentSchema(e,t){schemaRegistry[e]=t}function getComponentSchema(e){return schemaRegistry[e]}const labelSchema={base:baseSchema,standard:[{key:"text",label:"文本内容",type:"input",default:"标签"},{key:"color",label:"字体颜色",type:"color",default:"#1976d2"},{key:"fontSize",label:"字号",type:"number",default:16},{key:"background",label:"背景色",type:"color",default:"#fff"},{key:"align",label:"对齐方式",type:"select",options:[{label:"左对齐",value:"left"},{label:"居中",value:"center"},{label:"右对齐",value:"right"}],default:"left"}],dataBinding:[{key:"dataSource",label:"数据源",type:"select",options:[]},{key:"field",label:"字段",type:"select",options:[]},{key:"format",label:"格式化",type:"select",options:[{label:"数字",value:"number"},{label:"日期",value:"date"},{label:"百分比",value:"percent"},{label:"货币",value:"currency"},{label:"自定义",value:"custom"}],default:"number"},{key:"customFormat",label:"自定义格式化",type:"textarea",default:""},{key:"expression",label:"表达式",type:"textarea"},{key:"mock",label:"模拟数据",type:"json"},{key:"formatPattern",label:"格式字符串",type:"input",default:""}]};registerComponentSchema("label",labelSchema);const imageSchema={base:baseSchema,standard:[{key:"src",label:"图片地址",type:"input"},{key:"width",label:"宽度",type:"number"},{key:"height",label:"高度",type:"number"},{key:"alt",label:"替代文本",type:"input"}],dataBinding:[{key:"dataSource",label:"数据源",type:"select",options:[]},{key:"field",label:"字段",type:"select",options:[]}]};registerComponentSchema("image",imageSchema);const tableSchema={base:baseSchema,standard:[{key:"pagination",label:"分页",type:"switch"},{key:"showPagination",label:"显示分页控件",type:"switch",default:!1},{key:"bordered",label:"边框",type:"switch"},{key:"size",label:"尺寸",type:"select",options:[{label:"中等",value:"middle"},{label:"紧凑",value:"small"}]},{key:"pageSize",label:"每页条数",type:"number",default:10}],dataBinding:[{key:"dataSource",label:"数据源",type:"select",options:[]},{key:"dataNode",label:"数据节点",type:"select",options:[]},{key:"columns",label:"字段映射",type:"columns",itemSchema:[{key:"field",label:"字段",type:"select",options:[]},{key:"label",label:"列名",type:"input"},{key:"format",label:"格式化",type:"select",options:[{label:"无",value:""},{label:"数字",value:"number"},{label:"百分比",value:"percent"},{label:"货币",value:"currency"},{label:"日期",value:"date"},{label:"自定义",value:"custom"}]},{key:"expression",label:"表达式",type:"input"},{key:"width",label:"宽度",type:"number"},{key:"align",label:"对齐",type:"select",options:[{label:"左",value:"left"},{label:"中",value:"center"},{label:"右",value:"right"}]},{key:"visible",label:"显示",type:"switch"}]}]};registerComponentSchema("table",tableSchema);const qrcodeSchema={base:baseSchema,standard:[{key:"qrValue",label:"值",type:"input"},{key:"size",label:"大小",type:"number"},{key:"color",label:"颜色",type:"color"},{key:"bgColor",label:"背景色",type:"color"},{key:"bordered",label:"边框",type:"switch"}],dataBinding:[{key:"dataSource",label:"数据源",type:"select",options:[]},{key:"field",label:"字段",type:"select",options:[]}]};registerComponentSchema("qrcode",qrcodeSchema);function usePropertyChangeHandlers(e){const t=useComponentsStore(a=>a.updateComponent),o=reactExports.useCallback((a,d)=>{e&&t(e.id,{[a]:d})},[e,t]),r=reactExports.useCallback((a,d)=>{e&&t(e.id,{props:{...e.props,[a]:d}})},[e,t]),s=reactExports.useCallback((a,d)=>{if(e){if(a==="dataNodeAndColumns"){t(e.id,{props:{...e.props,dataBinding:{...e.props.dataBinding,dataNode:d.dataNode,columns:d.columns}}});return}if(a==="all"){t(e.id,{props:{...e.props,dataBinding:{...e.props.dataBinding,...d}}});return}t(e.id,{props:{...e.props,dataBinding:{...e.props.dataBinding,[a]:d}}})}},[e,t]);return{handleBaseChange:o,handleStandardChange:r,handleDataBindingChange:s}}function PropertyPanel(){const e=useSelectionStore(i=>i.selectedIds),t=useComponentsStore(i=>i.components),o=useDataSourceStore(i=>i.dataSources),r=reactExports.useMemo(()=>t.find(i=>e[0]===i.id),[t,e]),s=reactExports.useMemo(()=>getComponentSchema(r?.type||"")||{base:[],standard:[],dataBinding:[]},[r]),a=!!r?.rotatable,{handleBaseChange:d,handleStandardChange:g,handleDataBindingChange:v}=usePropertyChangeHandlers(r);return r?jsxRuntimeExports.jsxs("div",{style:{padding:16,overflowY:"auto",maxHeight:"100vh",border:"2px solid #388e3c",borderRadius:6,marginRight:16},children:[jsxRuntimeExports.jsx("div",{style:{fontWeight:600,marginBottom:12},children:"属性面板"}),jsxRuntimeExports.jsx(Tabs,{defaultActiveKey:"base",size:"small",style:{background:"#fff"},items:[{key:"base",label:"基础属性",children:jsxRuntimeExports.jsx(BasePropertyPanel,{schema:s,selected:r,isRotatable:a,handleBaseChange:d})},{key:"standard",label:"标准属性",children:jsxRuntimeExports.jsx(StandardPropertyPanel,{schema:s,selected:r,handleStandardChange:g})},{key:"dataBinding",label:"数据绑定",children:jsxRuntimeExports.jsx(DataBindingPanel,{schema:s,selected:r,dataSources:o,handleDataBindingChange:v})}]})]}):jsxRuntimeExports.jsx("div",{style:{padding:16,fontWeight:600,color:"#388e3c",background:"#e8f5e9",border:"2px solid #388e3c",borderRadius:6,marginRight:16},children:"请选择画布上的组件"})}const TABLE_PAGE_SIZE=5;function PrintPreview(){const e=useComponentsStore(g=>g.components),t=useCanvasStore(g=>g.canvasConfig),o=useDataSourceStore(g=>g.dataSources),r="users",a=o.find(g=>g.key===r)?.data||[];if(a.length===0)return jsxRuntimeExports.jsx("div",{children:"没有可用的数据用于预览"});const d=[];return a.forEach((g,v)=>{const i=e.filter(h=>h.type==="table"&&h.props?.dataBinding?.dataSource===r&&h.props?.dataBinding?.dataNode);let c=1;i.forEach(h=>{const x=h.props.dataBinding.dataNode,u=g[x];if(Array.isArray(u)){const E=Math.ceil(u.length/TABLE_PAGE_SIZE)||1;c=Math.max(c,E)}});for(let h=0;h<c;h++){const x=`user-${v}-page-${h}`,u=jsxRuntimeExports.jsx("div",{style:{width:t.width,height:t.height,background:"#fff",margin:"0 auto 32px auto",position:"relative",overflow:"hidden",pageBreakAfter:"always",boxShadow:"0 0 8px #ccc"},children:e.filter(E=>E.visible!==!1).map(E=>{const R=componentRegistry[E.type]?.Component;if(!R)return null;let S=null;const b=E.props?.dataBinding;if(b){const{dataSource:y,dataNode:j,field:M}=b;if(y===r)if(E.type==="table"&&j){const D=g[j];Array.isArray(D)?S=D.slice(h*TABLE_PAGE_SIZE,(h+1)*TABLE_PAGE_SIZE):S=[]}else M&&(S=g[M])}else console.warn(`Component ${E.id} has no data binding or invalid data source.`);return jsxRuntimeExports.jsx("div",{style:{position:"absolute",left:E.x,top:E.y,width:E.width,height:E.height,pointerEvents:"none"},children:E.type==="table"?jsxRuntimeExports.jsx(R,{componentId:E.id,dataSource:S}):jsxRuntimeExports.jsx(R,{componentId:E.id,bindingData:S})},`${E.id}-${x}`)})},x);d.push(u)}}),jsxRuntimeExports.jsx("div",{children:d})}var lib={exports:{}};(function(e,t){(function(o,r){e.exports=r(reactExports)})(typeof self<"u"?self:commonjsGlobal,function(o){return function(){var r={155:function(b){b.exports=o}},s={};function a(b){var y=s[b];if(y!==void 0)return y.exports;var j=s[b]={exports:{}};return r[b](j,j.exports,a),j.exports}a.d=function(b,y){for(var j in y)a.o(y,j)&&!a.o(b,j)&&Object.defineProperty(b,j,{enumerable:!0,get:y[j]})},a.o=function(b,y){return Object.prototype.hasOwnProperty.call(b,y)},a.r=function(b){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(b,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(b,"__esModule",{value:!0})};var d={};a.r(d),a.d(d,{useReactToPrint:function(){return S}});var g=a(155);function v({level:b="error",messages:y,suppressErrors:j=!1}){j||(b==="error"?console.error(y):b==="warning"?console.warn(y):console.debug(y))}function i(b,y){if(y||!b){const j=document.getElementById("printWindow");j&&document.body.removeChild(j)}}function c(b){return b instanceof Error?b:new Error("Unknown Error")}function h(b,y){const{documentTitle:j,onAfterPrint:M,onPrintError:D,preserveAfterPrint:_,print:w,suppressErrors:C}=y;setTimeout(()=>{var T,A;if(b.contentWindow){let I=function(){M?.(),i(_)};if(b.contentWindow.focus(),w)w(b).then(I).catch(B=>{D?D("print",c(B)):v({messages:["An error was thrown by the specified `print` function"],suppressErrors:C})});else{if(b.contentWindow.print){const B=(A=(T=b.contentDocument)===null||T===void 0?void 0:T.title)!==null&&A!==void 0?A:"",P=b.ownerDocument.title;j&&(b.ownerDocument.title=j,b.contentDocument&&(b.contentDocument.title=j)),b.contentWindow.print(),j&&(b.ownerDocument.title=P,b.contentDocument&&(b.contentDocument.title=B))}else v({messages:["Printing for this browser is not currently possible: the browser does not have a `print` method available for iframes."],suppressErrors:C});[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/BlackBerry/i,/Windows Phone/i].some(B=>{var P,F;return((F=(P=navigator.userAgent)!==null&&P!==void 0?P:navigator.vendor)!==null&&F!==void 0?F:"opera"in window&&window.opera).match(B)})?setTimeout(I,500):I()}}else v({messages:["Printing failed because the `contentWindow` of the print iframe did not load. This is possibly an error with `react-to-print`. Please file an issue: https://github.com/MatthewHerbst/react-to-print/issues/"],suppressErrors:C})},500)}function x(b){const y=[],j=document.createTreeWalker(b,NodeFilter.SHOW_ELEMENT,null);let M=j.nextNode();for(;M;)y.push(M),M=j.nextNode();return y}function u(b,y,j){const M=x(b),D=x(y);if(M.length===D.length)for(let _=0;_<M.length;_++){const w=M[_],C=D[_],T=w.shadowRoot;if(T!==null){const A=C.attachShadow({mode:T.mode});A.innerHTML=T.innerHTML,u(T,A,j)}}else v({messages:["When cloning shadow root content, source and target elements have different size. `onBeforePrint` likely resolved too early.",b,y],suppressErrors:j})}const E=`
    @page {
        /* Remove browser default header (title) and footer (url) */
        margin: 0;
    }
    @media print {
        body {
            /* Tell browsers to print background colors */
            color-adjust: exact; /* Firefox. This is an older version of "print-color-adjust" */
            print-color-adjust: exact; /* Firefox/Safari */
            -webkit-print-color-adjust: exact; /* Chrome/Safari/Edge/Opera */
        }
    }
`;function R(b,y,j,M){var D,_,w,C,T;const{contentNode:A,clonedContentNode:I,clonedImgNodes:B,clonedVideoNodes:P,numResourcesToLoad:F,originalCanvasNodes:O}=j,{bodyClass:Z,fonts:$,ignoreGlobalStyles:ue,pageStyle:H,nonce:re,suppressErrors:K,copyShadowRoots:ee}=M;b.onload=null;const W=(D=b.contentDocument)!==null&&D!==void 0?D:(_=b.contentWindow)===null||_===void 0?void 0:_.document;if(W){const ne=W.body.appendChild(I);ee&&u(A,ne,!!K),$&&(!((w=b.contentDocument)===null||w===void 0)&&w.fonts&&(!((C=b.contentWindow)===null||C===void 0)&&C.FontFace)?$.forEach(z=>{const N=new FontFace(z.family,z.source,{weight:z.weight,style:z.style});b.contentDocument.fonts.add(N),N.loaded.then(()=>{y(N)}).catch(J=>{y(N,["Failed loading the font:",N,"Load error:",c(J)])})}):($.forEach(z=>{y(z)}),v({messages:['"react-to-print" is not able to load custom fonts because the browser does not support the FontFace API but will continue attempting to print the page'],suppressErrors:K})));const fe=H??E,V=W.createElement("style");re&&(V.setAttribute("nonce",re),W.head.setAttribute("nonce",re)),V.appendChild(W.createTextNode(fe)),W.head.appendChild(V),Z&&W.body.classList.add(...Z.split(" "));const oe=W.querySelectorAll("canvas");for(let z=0;z<O.length;++z){const N=O[z],J=oe[z];if(J===void 0){v({messages:["A canvas element could not be copied for printing, has it loaded? `onBeforePrint` likely resolved too early.",N],suppressErrors:K});continue}const L=J.getContext("2d");L&&L.drawImage(N,0,0)}for(let z=0;z<B.length;z++){const N=B[z],J=N.getAttribute("src");if(J){const L=new Image;L.onload=()=>{y(N)},L.onerror=(U,Y,pe,te,se)=>{y(N,["Error loading <img>",N,"Error",se])},L.src=J}else y(N,['Found an <img> tag with an empty "src" attribute. This prevents pre-loading it.',N])}for(let z=0;z<P.length;z++){const N=P[z];N.preload="auto";const J=N.getAttribute("poster");if(J){const L=new Image;L.onload=()=>{y(N)},L.onerror=(U,Y,pe,te,se)=>{y(N,["Error loading video poster",J,"for video",N,"Error:",se])},L.src=J}else N.readyState>=2?y(N):N.src?(N.onloadeddata=()=>{y(N)},N.onerror=(L,U,Y,pe,te)=>{y(N,["Error loading video",N,"Error",te])},N.onstalled=()=>{y(N,["Loading video stalled, skipping",N])}):y(N,["Error loading video, `src` is empty",N])}const ce="select",Re=A.querySelectorAll(ce),G=W.querySelectorAll(ce);for(let z=0;z<Re.length;z++)G[z].value=Re[z].value;if(!ue){const z=document.querySelectorAll("style, link[rel~='stylesheet'], link[as='style']");for(let N=0,J=z.length;N<J;++N){const L=z[N];if(L.tagName.toLowerCase()==="style"){const U=W.createElement(L.tagName),Y=L.sheet;if(Y){let pe="";try{const te=Y.cssRules.length;for(let se=0;se<te;++se)typeof Y.cssRules[se].cssText=="string"&&(pe+=`${Y.cssRules[se].cssText}\r
`)}catch(te){v({messages:["A stylesheet could not be accessed. This is likely due to the stylesheet having cross-origin imports, and many browsers block script access to cross-origin stylesheets. See https://github.com/MatthewHerbst/react-to-print/issues/429 for details. You may be able to load the sheet by both marking the stylesheet with the cross `crossorigin` attribute, and setting the `Access-Control-Allow-Origin` header on the server serving the stylesheet. Alternatively, host the stylesheet on your domain to avoid this issue entirely.",L,`Original error: ${c(te).message}`],level:"warning"})}U.setAttribute("id",`react-to-print-${N}`),re&&U.setAttribute("nonce",re),U.appendChild(W.createTextNode(pe)),W.head.appendChild(U)}}else if(L.getAttribute("href"))if(L.hasAttribute("disabled"))v({messages:["`react-to-print` encountered a <link> tag with a `disabled` attribute and will ignore it. Note that the `disabled` attribute is deprecated, and some browsers ignore it. You should stop using it. https://developer.mozilla.org/en-US/docs/Web/HTML/Element/link#attr-disabled. The <link> is:",L],level:"warning"}),y(L);else{const U=W.createElement(L.tagName);for(let Y=0,pe=L.attributes.length;Y<pe;++Y){const te=L.attributes[Y];te&&U.setAttribute(te.nodeName,(T=te.nodeValue)!==null&&T!==void 0?T:"")}U.onload=()=>{y(U)},U.onerror=(Y,pe,te,se,me)=>{y(U,["Failed to load",U,"Error:",me])},re&&U.setAttribute("nonce",re),W.head.appendChild(U)}else v({messages:["`react-to-print` encountered a <link> tag with an empty `href` attribute. In addition to being invalid HTML, this can cause problems in many browsers, and so the <link> was not loaded. The <link> is:",L],level:"warning"}),y(L)}}}F===0&&h(b,M)}function S({bodyClass:b,contentRef:y,copyShadowRoots:j,documentTitle:M,fonts:D,ignoreGlobalStyles:_,nonce:w,onAfterPrint:C,onBeforePrint:T,onPrintError:A,pageStyle:I,preserveAfterPrint:B,print:P,suppressErrors:F}){return(0,g.useCallback)(O=>{function Z(){const $={bodyClass:b,contentRef:y,copyShadowRoots:j,documentTitle:M,fonts:D,ignoreGlobalStyles:_,nonce:w,onAfterPrint:C,onPrintError:A,pageStyle:I,preserveAfterPrint:B,print:P,suppressErrors:F},ue=function(){const K=document.createElement("iframe");return K.width=`${document.documentElement.clientWidth}px`,K.height=`${document.documentElement.clientHeight}px`,K.style.position="absolute",K.style.top=`-${document.documentElement.clientHeight+100}px`,K.style.left=`-${document.documentElement.clientWidth+100}px`,K.id="printWindow",K.srcdoc="<!DOCTYPE html>",K}(),H=function(K,ee){const{contentRef:W,fonts:ne,ignoreGlobalStyles:fe,suppressErrors:V}=ee,oe=function({contentRef:J,optionalContent:L,suppressErrors:U}){return!L||L instanceof Event||(J&&v({level:"warning",messages:['"react-to-print" received a `contentRef` option and a optional-content param passed to its callback. The `contentRef` option will be ignored.']}),typeof L!="function")?J?J.current:void v({messages:['"react-to-print" did not receive a `contentRef` option or a optional-content param pass to its callback.'],suppressErrors:U}):L()}({contentRef:W,optionalContent:K,suppressErrors:V});if(!oe)return;const ce=oe.cloneNode(!0),Re=document.querySelectorAll("link[rel~='stylesheet'], link[as='style']"),G=ce.querySelectorAll("img"),z=ce.querySelectorAll("video"),N=ne?ne.length:0;return{contentNode:oe,clonedContentNode:ce,clonedImgNodes:G,clonedVideoNodes:z,numResourcesToLoad:(fe?0:Re.length)+G.length+z.length+N,originalCanvasNodes:oe.querySelectorAll("canvas")}}(O,$);if(!H)return void v({messages:["There is nothing to print"],suppressErrors:F});const re=function(K,ee,W){const{suppressErrors:ne}=K,fe=[],V=[];return function(oe,ce){fe.includes(oe)?v({level:"debug",messages:["Tried to mark a resource that has already been handled",oe],suppressErrors:ne}):(ce?(v({messages:['"react-to-print" was unable to load a resource but will continue attempting to print the page',...ce],suppressErrors:ne}),V.push(oe)):fe.push(oe),fe.length+V.length===ee&&h(W,K))}}($,H.numResourcesToLoad,ue);(function(K,ee,W,ne){K.onload=()=>{R(K,ee,W,ne)},document.body.appendChild(K)})(ue,re,H,$)}i(B,!0),T?T().then(()=>{Z()}).catch($=>{A?.("onBeforePrint",c($))}):Z()},[b,y,j,M,D,_,w,C,T,A,I,B,P,F])}return d}()})})(lib);var libExports=lib.exports;const PrintPreviewModal=({visible:e,onClose:t,children:o})=>{const r=reactExports.useRef(null),s=useCanvasStore(g=>g.canvasConfig),a=(s?.width||1200)+64,d=libExports.useReactToPrint({contentRef:r,documentTitle:"",pageStyle:"@media print { @page { margin: 0; size: auto; } body { margin: 0; } }",onAfterPrint:()=>{}});return jsxRuntimeExports.jsx(Modal,{title:"打印预览",open:e,onCancel:t,width:a,footer:[jsxRuntimeExports.jsx(Button,{type:"primary",onClick:d,children:"打印"},"print"),jsxRuntimeExports.jsx(Button,{onClick:t,children:"关闭"},"close")],style:{top:32},children:jsxRuntimeExports.jsx("div",{ref:r,style:{width:s.width,margin:"0 auto",background:"#fff"},children:o})})},CANVAS_SIZES=[{label:"A4横向",value:"A4-landscape",width:1123,height:794},{label:"A4纵向",value:"A4-portrait",width:794,height:1123},{label:"16:9",value:"16-9",width:1280,height:720},{label:"4:3",value:"4-3",width:1024,height:768}];function Toolbar(){const e=useCanvasStore(I=>I.canvasConfig),t=useCanvasStore(I=>I.setCanvasConfig),[o,r]=reactExports.useState(!1),[s,a]=reactExports.useState(!1),[d,g]=reactExports.useState(!1),[v,i]=reactExports.useState(""),[c,h]=reactExports.useState([]),x=reactExports.useRef(null),u=I=>{const B=CANVAS_SIZES.find(P=>P.value===I);B&&t({width:B.width,height:B.height,sizeType:B.value})},E=I=>{t({showGrid:I})},R=I=>{t({showRuler:I})},S=I=>{typeof I=="number"&&t({gridSize:I})},b=I=>{t({allowSnapToGrid:I})},y=useComponentsStore(I=>I.setComponents),j=I=>{useDataSourceStore.setState({dataSources:I})},M=()=>{a(!0),i("");const I=JSON.parse(localStorage.getItem("reportDesignList")||"[]");h(I),setTimeout(()=>{x.current?.focus()},100)},D=()=>{if(!v.trim()){staticMethods.warning("请输入报表名称");return}const I={components:useComponentsStore.getState().components,canvasConfig:useCanvasStore.getState().canvasConfig,dataSources:useDataSourceStore.getState().dataSources},B=JSON.parse(localStorage.getItem("reportDesignList")||"[]"),P=B.findIndex(F=>F.name===v);if(P>-1){Modal.confirm({title:"报表已存在，是否覆盖？",onOk:()=>{B[P].data=I,localStorage.setItem("reportDesignList",JSON.stringify(B)),a(!1),staticMethods.success("报表已覆盖保存")}});return}B.push({name:v,data:I}),localStorage.setItem("reportDesignList",JSON.stringify(B)),a(!1),staticMethods.success("报表已保存")},_=()=>{g(!0);const I=JSON.parse(localStorage.getItem("reportDesignList")||"[]");h(I)},w=I=>{y(I.data.components||[]),t(I.data.canvasConfig||{}),j(I.data.dataSources||[]),g(!1),staticMethods.success(`已打开报表：${I.name}`)},C=()=>{Modal.confirm({title:"新建报表",content:"确定要新建报表吗？当前内容将被清空，无法恢复。",okText:"确定",cancelText:"取消",onOk:()=>{y([]),t({...defaultConfig}),j([...initialDataSources]),staticMethods.success("已新建空白报表")}})},T=useComponentsStore(I=>I.undo),A=useComponentsStore(I=>I.redo);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{style:{height:52,padding:"0 16px",fontSize:15,color:"#f57c00",background:"#fff3e0",border:"1px solid #f57c00",borderRadius:6,display:"flex",alignItems:"center",gap:12},children:[jsxRuntimeExports.jsx("span",{style:{fontWeight:600},children:"工具栏"}),jsxRuntimeExports.jsx("span",{style:{fontWeight:400,color:"#888",margin:"0 4px"},children:"| 画布尺寸："}),jsxRuntimeExports.jsx(Select,{value:e.sizeType,style:{width:120,marginRight:8},onChange:u,options:CANVAS_SIZES.map(I=>({label:I.label,value:I.value})),size:"small"}),jsxRuntimeExports.jsx("span",{style:{fontWeight:400,color:"#888",margin:"0 4px"},children:"| 网格："}),jsxRuntimeExports.jsx(Switch,{checked:e.showGrid,onChange:E,size:"small",style:{marginRight:4}}),jsxRuntimeExports.jsx("span",{style:{fontWeight:400,color:"#888",margin:"0 4px"},children:"间距"}),jsxRuntimeExports.jsx(TypedInputNumber,{min:5,max:200,step:1,value:e.gridSize,onChange:S,style:{width:60,marginRight:8},size:"small"}),jsxRuntimeExports.jsx("span",{style:{fontWeight:400,color:"#888",margin:"0 4px"},children:"| 标尺："}),jsxRuntimeExports.jsx(Switch,{checked:e.showRuler,onChange:R,size:"small",style:{marginRight:8}}),jsxRuntimeExports.jsx("span",{style:{fontWeight:400,color:"#888",margin:"0 4px"},children:"| 吸附网格："}),jsxRuntimeExports.jsx(Switch,{checked:e.allowSnapToGrid,onChange:b,size:"small",style:{marginRight:8}}),jsxRuntimeExports.jsx("div",{style:{flex:1}}),jsxRuntimeExports.jsx(Button,{icon:jsxRuntimeExports.jsx(RefIcon$i,{}),onClick:T,style:{marginRight:8},size:"small",children:"撤销"}),jsxRuntimeExports.jsx(Button,{icon:jsxRuntimeExports.jsx(RefIcon$j,{}),onClick:A,style:{marginRight:8},size:"small",children:"重做"}),jsxRuntimeExports.jsx(Button,{icon:jsxRuntimeExports.jsx(RefIcon$k,{}),onClick:C,style:{marginRight:8},size:"small",children:"新建"}),jsxRuntimeExports.jsx(Button,{icon:jsxRuntimeExports.jsx(RefIcon$l,{}),onClick:M,style:{marginRight:8},size:"small",children:"保存"}),jsxRuntimeExports.jsx(Button,{icon:jsxRuntimeExports.jsx(RefIcon$m,{}),onClick:_,style:{marginRight:8},size:"small",children:"打开"}),jsxRuntimeExports.jsx(Button,{type:"primary",icon:jsxRuntimeExports.jsx(RefIcon$n,{}),onClick:()=>r(!0),size:"small",children:"打印预览"})]}),jsxRuntimeExports.jsx(PrintPreviewModal,{visible:o,onClose:()=>r(!1),children:jsxRuntimeExports.jsx(PrintPreview,{})}),jsxRuntimeExports.jsxs(Modal,{title:"保存报表",open:s,onOk:D,onCancel:()=>a(!1),okText:"保存",cancelText:"取消",children:[jsxRuntimeExports.jsx(Input,{ref:x,placeholder:"请输入报表名称",value:v,onChange:I=>i(I.target.value),onPressEnter:D}),c.length>0&&jsxRuntimeExports.jsxs("div",{style:{marginTop:12,color:"#888",fontSize:12},children:["已有报表：",c.map(I=>I.name).join("、")]})]}),jsxRuntimeExports.jsx(Modal,{title:"打开报表",open:d,onCancel:()=>g(!1),footer:null,children:jsxRuntimeExports.jsx(List,{dataSource:c,renderItem:I=>jsxRuntimeExports.jsx(List.Item,{style:{cursor:"pointer"},onClick:()=>w(I),children:I.name}),locale:{emptyText:"暂无已保存报表"}})})]})}const{Header,Sider,Content}=Layout,Designer=()=>jsxRuntimeExports.jsx(DndContext,{children:jsxRuntimeExports.jsxs(Layout,{style:{height:"100vh"},children:[jsxRuntimeExports.jsx(Header,{style:{background:"#fafafa",padding:0,borderBottom:"1px solid #eee"},children:jsxRuntimeExports.jsx(Toolbar,{})}),jsxRuntimeExports.jsxs(Layout,{children:[jsxRuntimeExports.jsx(Sider,{width:220,style:{background:"#f7f8fa",borderRight:"1px solid #eee"},children:jsxRuntimeExports.jsx(ComponentLibrary,{})}),jsxRuntimeExports.jsx(Content,{style:{background:"#fff",position:"relative",display:"flex",justifyContent:"center",alignItems:"center",flex:1},children:jsxRuntimeExports.jsx(Canvas,{})}),jsxRuntimeExports.jsx(Sider,{width:500,style:{background:"#fafbfc",borderLeft:"1px solid #eee"},children:jsxRuntimeExports.jsx(PropertyPanel,{})})]})]})}),App=()=>jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx(Designer,{})});var client={},m=reactDomExports;client.createRoot=m.createRoot,client.hydrateRoot=m.hydrateRoot;client.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(App,{}));
//# sourceMappingURL=index-BHhsCl5f.js.map
