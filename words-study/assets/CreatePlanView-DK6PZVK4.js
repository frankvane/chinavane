import{h as F,A as m,u as M,i as W}from"./index-CNVOlx-d.js";import{E as A,A as h,B as j,C as Q,L as z,e as n,G as e,f as v,d as w,T as L,K as s,J as c,v as f,X as $,I as N,F as k,k as C,S as ee,Y as te,o as i,g as S,j as V,Z as se,n as B}from"./vue-BPmSeTKS.js";import{_ as T}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./dayjs-Bof1u0Bp.js";const oe={class:"bg-gray-50 rounded-lg shadow-lg p-4 flex flex-1 flex-col overflow-hidden"},re={class:"flex-1 overflow-y-auto pr-2"},le={class:"bg-white border border-gray-200 rounded-lg p-3 mb-4"},ne={class:"mb-3"},ie={class:"grid grid-cols-2 gap-3 mb-3"},de={class:"flex items-center gap-1"},ae={class:"flex items-center gap-1"},ce={class:"grid grid-cols-2 gap-3 mb-3"},ue=["value"],ge={class:"bg-indigo-50 border border-indigo-200 rounded p-2"},me={class:"text-center"},xe={class:"text-lg font-bold text-indigo-600"},be={class:"mb-6"},pe={class:"grid grid-cols-3 gap-3"},fe=["value","disabled"],ve={class:"flex items-center justify-between flex-1"},_e={key:0,class:"flex items-center"},ye=["value","disabled"],he={class:"flex items-center justify-between flex-1"},we={key:0,class:"flex items-center"},Pe=["value","disabled"],ke={class:"flex items-center justify-between flex-1"},Ce={key:0,class:"flex items-center"},Se={key:0,class:"mb-6"},Ee={class:"flex items-center justify-between mb-4"},Me={class:"mb-4 p-4 bg-green-50 border border-gray-200 rounded-lg"},Le={class:"text-sm font-bold text-gray-800 pb-5 flex justify-between"},Ne={key:0,class:"space-y-3"},Fe={class:"space-y-2 max-h-64 overflow-y-auto"},Ae={class:"flex-1"},Oe={class:"text-sm font-medium text-gray-800"},$e={class:"text-xs text-gray-600 ml-2"},Te=["onClick"],Ie={key:1,class:"text-sm text-green-600"},De={class:"flex flex-1 min-h-0"},Re={class:"w-1/3 border-r border-gray-200 flex flex-col min-h-0"},Ge={class:"flex-1 overflow-y-auto px-6 pb-6 min-h-0"},Be={class:"space-y-3"},We=["onClick"],je={class:"text-blue-700 font-bold"},ze={class:"text-gray-600 text-sm"},Ve={class:"flex-1 flex flex-col min-h-0"},Ue={class:"flex-1 overflow-y-auto px-6 pb-6 min-h-0"},Ye={class:"space-y-6"},He={class:"text-sm text-indigo-500"},Ke={class:"grid grid-cols-1 gap-3"},qe={class:"flex items-center flex-1"},Je=["checked","onChange"],Xe={class:"font-medium text-base text-gray-800 flex-1"},Ze={class:"text-sm text-blue-600 font-semibold ml-4 flex-shrink-0 bg-blue-100 px-2 py-1 rounded-full"},Qe={class:"flex items-center justify-between p-6 border-t border-gray-200 bg-gray-50"},et={class:"text-sm text-gray-600"},tt={key:1,class:"mb-6"},st={class:"border border-gray-200 rounded-lg p-4 bg-white"},ot={class:"grid grid-cols-2 gap-3 mb-4"},rt=["checked","onChange"],lt={class:"text-yellow-500 mr-2 text-base"},nt={class:"text-sm font-medium"},it=["checked"],dt={key:0,class:"text-sm text-gray-600 text-center bg-gray-50 rounded p-2"},at={class:"space-y-3"},ct=["disabled"],ut=A({__name:"PlanBasicInfo",setup(O){const l=te(),o=F(),u=h(!1),p=h([]),y=h([]),x=h(!1),b=h({}),P=h(""),U=j(()=>o.isEditing?"更新计划":"创建计划"),Y=async()=>{if(o.canCreatePlan){o.isCreating=!0;try{if(o.currentPlanForm.selectionMode===m.PLAN_SELECTION_MODES.BY_FILE){const d=new Set;o.currentPlanForm.selectedGroups.forEach(t=>{d.add(t.fileIdx)}),o.currentPlanForm.selectedFiles=Array.from(d)}o.isEditing?(await o.updateStudyPlan(o.selectedWords),alert("学习计划更新成功！")):(await o.createStudyPlan(o.selectedWords),alert("学习计划创建成功！")),l.push("/plan-manage")}catch{alert(o.isEditing?"更新计划失败，请重试":"创建计划失败，请重试")}finally{o.isCreating=!1}}},H=()=>{o.cancelEdit(),l.push("/plan-manage")},I=d=>o.currentPlanForm.selectedGroups.some(t=>t.fileIdx===d.fileIdx&&t.groupName===d.name),D=d=>{const t=d.groupName||d.name,r=d.fileIdx,a=o.currentPlanForm.selectedGroups.findIndex(g=>g.fileIdx===r&&g.groupName===t);if(a>-1?o.currentPlanForm.selectedGroups.splice(a,1):o.currentPlanForm.selectedGroups.push({fileIdx:r,groupName:t}),o.currentPlanForm.selectionMode===m.PLAN_SELECTION_MODES.BY_FILE){const g=new Set(o.currentPlanForm.selectedGroups.map(_=>_.fileIdx));o.currentPlanForm.selectedFiles=Array.from(g)}},R=()=>{const d=M();let t=0;return o.currentPlanForm.selectedGroups.forEach(({fileIdx:r,groupName:a})=>{const g=d.fileData[r];if(g&&g.groups){const _=g.groups.find(Z=>Z.name===a);_&&_.words&&(t+=_.words.length)}}),t},K=d=>{const r=M().fileData[d.fileIdx];if(r&&r.groups){const a=r.groups.find(g=>g.name===d.groupName);if(a&&a.words)return a.words.length}return 0},G=d=>{o.currentPlanForm.starFilter=d},q=(d,t)=>{t&&t instanceof HTMLElement&&(b.value[d]=t)},E=()=>{x.value=!1,P.value=""},J=d=>{P.value=d;const t=b.value[d];if(t){const r=t.closest(".overflow-y-auto");if(r){const a=r.getBoundingClientRect(),g=t.getBoundingClientRect(),_=r.scrollTop+g.top-a.top-20;r.scrollTo({top:_,behavior:"smooth"})}}};Q(()=>o.currentPlanForm.selectionMode,async(d,t)=>{if(d!==t){u.value=!0;try{await new Promise(r=>{setTimeout(()=>{p.value=[],y.value=[],o.currentPlanForm.selectedFiles=[],o.currentPlanForm.selectedGroups=[],o.currentPlanForm.starFilter=-1,o.isEditing||(o.selectedWords=[]),r(void 0)},50)})}finally{u.value=!1}}});const X=()=>{if(o.isEditing&&o.editingPlan){const d=o.editingPlan;if(d.selectionMode===m.PLAN_SELECTION_MODES.BY_GROUP&&d.selectedGroups&&(p.value=d.selectedGroups.map(t=>`${t.fileIdx}-${t.groupName}`)),d.selectionMode===m.PLAN_SELECTION_MODES.BY_FILE&&d.selectedFiles){const t=M(),r=[];d.selectedFiles.forEach(a=>{const g=t.fileData[a];g&&g.groups&&g.groups.forEach(_=>{r.push(`${a}-${_.name}`)})}),p.value=r}if(d.selectionMode===m.PLAN_SELECTION_MODES.RATING&&d.words&&d.words.length>0){const t=M(),r=new Set;d.words.forEach(a=>{const g=t.getEffectiveWordRating(a.__fileIdx,a.__groupName,a.original);r.add(g)}),y.value=Array.from(r)}}};return z(()=>{X()}),(d,t)=>(i(),n("div",oe,[t[34]||(t[34]=e("h2",{class:"text-xl font-semibold text-gray-800 mb-4 pb-2 border-b border-gray-200"}," 基本信息 ",-1)),e("div",re,[e("div",le,[e("div",ne,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"计划名称",-1)),w(e("input",{"onUpdate:modelValue":t[0]||(t[0]=r=>s(o).currentPlanForm.name=r),type:"text",placeholder:"输入学习计划名称",class:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-indigo-500"},null,512),[[L,s(o).currentPlanForm.name]])]),e("div",ie,[e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"每日目标",-1)),e("div",de,[w(e("input",{"onUpdate:modelValue":t[1]||(t[1]=r=>s(o).currentPlanForm.dailyTarget=r),type:"number",min:"1",max:"100",class:"flex-1 px-2 py-1.5 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-indigo-500"},null,512),[[L,s(o).currentPlanForm.dailyTarget,void 0,{number:!0}]]),t[11]||(t[11]=e("span",{class:"text-xs text-gray-500"},"词/天",-1))])]),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"计划周期",-1)),e("div",ae,[w(e("input",{"onUpdate:modelValue":t[2]||(t[2]=r=>s(o).currentPlanForm.duration=r),type:"number",min:"1",max:"365",class:"flex-1 px-2 py-1.5 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-indigo-500"},null,512),[[L,s(o).currentPlanForm.duration,void 0,{number:!0}]]),t[13]||(t[13]=e("span",{class:"text-xs text-gray-500"},"天",-1))])])]),e("div",ce,[e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"开始日期",-1)),w(e("input",{"onUpdate:modelValue":t[3]||(t[3]=r=>s(o).currentPlanForm.startDate=r),type:"date",class:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-indigo-500"},null,512),[[L,s(o).currentPlanForm.startDate]])]),e("div",null,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"结束日期",-1)),e("input",{value:s(o).endDate,type:"date",readonly:"",class:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded bg-gray-50 text-gray-600"},null,8,ue),t[17]||(t[17]=e("p",{class:"text-xs text-gray-500 mt-1"}," 根据开始日期和计划周期自动计算 ",-1))])]),e("div",ge,[e("div",me,[e("div",xe,c(s(o).estimatedWordCount),1),t[18]||(t[18]=e("div",{class:"text-xs text-indigo-500"},"预计学习单词数量",-1))])])]),e("div",be,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"},"词汇选择模式",-1)),e("div",pe,[e("label",{class:f(["flex items-center p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",s(o).currentPlanForm.selectionMode===s(m).PLAN_SELECTION_MODES.ALL?"border-indigo-500 bg-indigo-50":""])},[w(e("input",{"onUpdate:modelValue":t[4]||(t[4]=r=>s(o).currentPlanForm.selectionMode=r),type:"radio",value:s(m).PLAN_SELECTION_MODES.ALL,disabled:u.value,class:"mr-2"},null,8,fe),[[$,s(o).currentPlanForm.selectionMode]]),e("div",ve,[e("div",{class:f(["font-medium text-sm",{"opacity-50":u.value}])}," 全部单词 ",2),u.value&&s(o).currentPlanForm.selectionMode===s(m).PLAN_SELECTION_MODES.ALL?(i(),n("div",_e,t[19]||(t[19]=[e("svg",{class:"animate-spin h-4 w-4 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"m4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):v("",!0)])],2),e("label",{class:f(["flex items-center p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",s(o).currentPlanForm.selectionMode===s(m).PLAN_SELECTION_MODES.BY_GROUP?"border-indigo-500 bg-indigo-50":""])},[w(e("input",{"onUpdate:modelValue":t[5]||(t[5]=r=>s(o).currentPlanForm.selectionMode=r),type:"radio",value:s(m).PLAN_SELECTION_MODES.BY_GROUP,disabled:u.value,class:"mr-2"},null,8,ye),[[$,s(o).currentPlanForm.selectionMode]]),e("div",he,[e("div",{class:f(["font-medium text-sm",{"opacity-50":u.value}])}," 分组选择 ",2),u.value&&s(o).currentPlanForm.selectionMode===s(m).PLAN_SELECTION_MODES.BY_GROUP?(i(),n("div",we,t[20]||(t[20]=[e("svg",{class:"animate-spin h-4 w-4 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"m4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):v("",!0)])],2),e("label",{class:f(["flex items-center p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",s(o).currentPlanForm.selectionMode===s(m).PLAN_SELECTION_MODES.RATING?"border-indigo-500 bg-indigo-50":""])},[w(e("input",{"onUpdate:modelValue":t[6]||(t[6]=r=>s(o).currentPlanForm.selectionMode=r),type:"radio",value:s(m).PLAN_SELECTION_MODES.RATING,disabled:u.value,class:"mr-2"},null,8,Pe),[[$,s(o).currentPlanForm.selectionMode]]),e("div",ke,[e("div",{class:f(["font-medium text-sm",{"opacity-50":u.value}])}," 评分选择 ",2),u.value&&s(o).currentPlanForm.selectionMode===s(m).PLAN_SELECTION_MODES.RATING?(i(),n("div",Ce,t[21]||(t[21]=[e("svg",{class:"animate-spin h-4 w-4 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"m4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):v("",!0)])],2)])]),s(o).currentPlanForm.selectionMode===s(m).PLAN_SELECTION_MODES.BY_GROUP?(i(),n("div",Se,[e("div",Ee,[t[24]||(t[24]=e("h3",{class:"text-base font-medium text-gray-700"},"选择分组",-1)),e("button",{onClick:t[7]||(t[7]=r=>x.value=!0),class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2"},t[23]||(t[23]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 10h16M4 14h16M4 18h16"})],-1),N(" 浏览所有分组 ",-1)]))]),e("div",Me,[e("div",Le,[t[25]||(t[25]=e("div",null,"已选择分组",-1)),e("div",null," (共选择 "+c(s(o).currentPlanForm.selectedGroups.length)+" 个分组， "+c(R())+" 个单词) ",1)]),s(o).currentPlanForm.selectedGroups.length>0?(i(),n("div",Ne,[e("div",Fe,[(i(!0),n(k,null,C(s(o).currentPlanForm.selectedGroups,r=>(i(),n("div",{key:`${r.fileIdx}-${r.groupName}`,class:"flex items-center justify-between p-2 bg-green-50 border border-green-200 rounded-lg hover:bg-green-100 transition-colors"},[e("div",Ae,[e("span",Oe,c(r.groupName),1),e("span",$e,"("+c(K(r))+" 词)",1)]),e("button",{onClick:a=>D(r),class:"flex-shrink-0 w-6 h-6 flex items-center justify-center text-green-600 hover:text-red-600 hover:bg-red-50 rounded-full transition-colors",title:"移除此分组"},t[26]||(t[26]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,Te)]))),128))])])):(i(),n("div",Ie,"点击上方按钮选择分组"))]),x.value?(i(),n("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:E},[e("div",{class:"bg-white rounded-lg shadow-xl max-w-6xl w-full mx-4 h-[80vh] flex flex-col",onClick:t[8]||(t[8]=ee(()=>{},["stop"]))},[e("div",{class:"flex items-center justify-between p-6 border-b border-gray-200 flex-shrink-0"},[t[28]||(t[28]=e("h2",{class:"text-xl font-semibold text-gray-800"},"选择学习分组",-1)),e("button",{onClick:E,class:"text-gray-400 hover:text-gray-600 transition-colors"},t[27]||(t[27]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("div",De,[e("div",Re,[t[29]||(t[29]=e("div",{class:"p-6 pb-3 flex-shrink-0"},[e("div",{class:"text-sm font-medium text-blue-800"},"分类概览")],-1)),e("div",Ge,[e("div",Be,[(i(!0),n(k,null,C(s(o).categoryStats,(r,a)=>(i(),n("div",{key:a,class:f(["flex justify-between items-center p-3 rounded-lg cursor-pointer transition-colors",{"bg-blue-200 border-2 border-blue-400 shadow-md":P.value===a,"bg-blue-50 hover:bg-blue-100":P.value!==a}]),onClick:g=>J(a)},[e("span",je,c(a),1),e("span",ze,c(r.groupCount)+"组 "+c(r.wordCount)+"词 ",1)],10,We))),128))])])]),e("div",Ve,[t[30]||(t[30]=e("div",{class:"p-6 pb-3 flex-shrink-0"},[e("div",{class:"text-sm font-medium text-blue-800"},"分组选择")],-1)),e("div",Ue,[e("div",Ye,[(i(!0),n(k,null,C(s(o).groupedByCategory,(r,a)=>(i(),n("div",{key:a,class:"mb-6"},[e("div",{ref_for:!0,ref:g=>q(a,g),class:"text-lg font-bold text-indigo-600 mb-4 px-2 border-b border-indigo-200 pb-2 flex justify-between items-center"},[e("span",null,c(a),1),e("span",He,c(s(o).categoryStats[a]?.groupCount)+"组 "+c(s(o).categoryStats[a]?.wordCount)+"词 ",1)],512),e("div",Ke,[(i(!0),n(k,null,C(r,g=>(i(),n("label",{key:`${g.fileIdx}-${g.name}`,class:f(["flex items-center justify-between p-4 hover:bg-blue-50 rounded-lg cursor-pointer border border-gray-200 hover:border-blue-300 hover:shadow-md transition-all duration-200",{"bg-blue-100 border-blue-400":I(g)}])},[e("div",qe,[e("input",{checked:I(g),onChange:_=>D(g),type:"checkbox",class:"mr-4 w-5 h-5 flex-shrink-0 text-blue-600 focus:ring-blue-500 focus:ring-2 rounded"},null,40,Je),e("div",Xe,c(g.name),1)]),e("div",Ze,c(g.wordCount)+" 词 ",1)],2))),128))])]))),128))])])])]),e("div",Qe,[e("div",et," 已选择 "+c(s(o).currentPlanForm.selectedGroups.length)+" 个分组， 共 "+c(R())+" 个单词 ",1),e("div",{class:"flex gap-3"},[e("button",{onClick:E,class:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-100 transition-colors"}," 取消 "),e("button",{onClick:E,class:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"}," 确认选择 ")])])])])):v("",!0)])):s(o).currentPlanForm.selectionMode===s(m).PLAN_SELECTION_MODES.RATING?(i(),n("div",tt,[t[33]||(t[33]=e("h3",{class:"text-base font-medium text-gray-700 mb-3"},"选择评分",-1)),e("div",st,[e("div",ot,[(i(),n(k,null,C([1,2,3,4,5],r=>e("label",{key:r,class:f(["flex items-center p-3 border rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",s(o).currentPlanForm.starFilter===r?"border-indigo-500 bg-indigo-50":"border-gray-200"])},[e("input",{checked:s(o).currentPlanForm.starFilter===r,onChange:a=>G(r),type:"radio",name:"starFilter",class:"mr-3 w-4 h-4"},null,40,rt),e("span",lt,c("★".repeat(r)),1),e("span",nt,c(r)+"星",1)],2)),64)),e("label",{class:f(["flex items-center p-3 border rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",s(o).currentPlanForm.starFilter===0?"border-gray-500 bg-gray-50":"border-gray-200"])},[e("input",{checked:s(o).currentPlanForm.starFilter===0,onChange:t[9]||(t[9]=r=>G(0)),type:"radio",name:"starFilter",class:"mr-3 w-4 h-4"},null,40,it),t[31]||(t[31]=e("span",{class:"text-gray-400 mr-2 text-base"},"☆☆☆☆☆",-1)),t[32]||(t[32]=e("span",{class:"text-sm font-medium"},"未评分",-1))],2)]),s(o).currentPlanForm.starFilter>=0?(i(),n("div",dt," 已筛选出 "+c(s(o).availableWords.length)+" 个单词 ",1)):v("",!0)])])):v("",!0),e("div",at,[e("button",{onClick:Y,disabled:!s(o).canCreatePlan||s(o).isCreating,class:"w-full bg-indigo-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-indigo-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors"},c(s(o).isCreating?s(o).isEditing?"更新中...":"创建中...":U.value),9,ct),s(o).isEditing?(i(),n("button",{key:0,onClick:H,class:"w-full bg-gray-500 text-white py-3 px-4 rounded-lg font-medium hover:bg-gray-600 transition-colors"}," 取消编辑 ")):v("",!0)])])]))}}),gt={class:"bg-white rounded-lg shadow-lg p-4 flex flex-1 flex-col"},mt={class:"flex items-center justify-between mb-4"},xt={class:"text-sm text-gray-500"},bt={class:"mb-4"},pt={class:"flex gap-2 flex-wrap"},ft={key:0,class:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20"},vt={key:0,"fill-rule":"evenodd",d:"M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z","clip-rule":"evenodd"},_t={key:1,"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"},yt={key:0,class:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20"},ht={key:0,"fill-rule":"evenodd",d:"M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z","clip-rule":"evenodd"},wt={key:1,"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"},Pt={key:0,class:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20"},kt={key:0,"fill-rule":"evenodd",d:"M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z","clip-rule":"evenodd"},Ct={key:1,"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"},St={class:"flex gap-2 ml-auto"},Et=["disabled"],Mt={key:0},Lt={key:1},Nt=["onClick"],Ft={class:"flex items-center justify-between"},At={class:"flex-1"},Ot={class:"font-medium text-gray-900"},$t={class:"text-sm text-gray-600"},Tt={class:"text-xs text-gray-500 mt-1"},It={class:"flex items-center gap-2"},Dt={key:0,class:"w-5 h-5 bg-indigo-600 rounded-full flex items-center justify-center"},Rt=A({__name:"AvailableWordsPanel",setup(O){const l=F(),o=h(),u=h(!1),p=async()=>{if(!u.value){u.value=!0;try{await l.selectAllAvailable()}catch{}finally{u.value=!1}}};return(y,x)=>(i(),n("div",gt,[e("div",mt,[x[5]||(x[5]=e("h2",{class:"text-xl font-semibold text-gray-800"},"待选单词",-1)),e("div",xt," 共 "+c(s(l).totalWordCount)+" 个单词 ",1)]),e("div",bt,[x[9]||(x[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"排序方式",-1)),e("div",pt,[e("button",{onClick:x[0]||(x[0]=b=>s(l).setSortMode(s(m).PLAN_SORT_MODES.RANDOM)),class:f(["px-3 py-1 rounded-md text-sm border",s(l).sortMode===s(m).PLAN_SORT_MODES.RANDOM?"bg-indigo-500 text-white border-indigo-500":"bg-white text-gray-700 border-gray-300 hover:border-indigo-300"])}," 随机排序 ",2),e("button",{onClick:x[1]||(x[1]=b=>s(l).handleSortModeClick(s(m).PLAN_SORT_MODES.ALPHABETICAL)),class:f(["px-3 py-1 rounded-md text-sm border flex items-center gap-1",s(l).sortMode===s(m).PLAN_SORT_MODES.ALPHABETICAL?"bg-indigo-500 text-white border-indigo-500":"bg-white text-gray-700 border-gray-300 hover:border-indigo-300"])},[x[6]||(x[6]=N(" 字母排序 ",-1)),s(l).sortMode===s(m).PLAN_SORT_MODES.ALPHABETICAL?(i(),n("svg",ft,[s(l).sortDirection==="asc"?(i(),n("path",vt)):(i(),n("path",_t))])):v("",!0)],2),e("button",{onClick:x[2]||(x[2]=b=>s(l).handleSortModeClick(s(m).PLAN_SORT_MODES.RATING)),class:f(["px-3 py-1 rounded-md text-sm border flex items-center gap-1",s(l).sortMode===s(m).PLAN_SORT_MODES.RATING?"bg-indigo-500 text-white border-indigo-500":"bg-white text-gray-700 border-gray-300 hover:border-indigo-300"])},[x[7]||(x[7]=N(" 评分排序 ",-1)),s(l).sortMode===s(m).PLAN_SORT_MODES.RATING?(i(),n("svg",yt,[s(l).sortDirection==="asc"?(i(),n("path",ht)):(i(),n("path",wt))])):v("",!0)],2),e("button",{onClick:x[3]||(x[3]=b=>s(l).handleSortModeClick(s(m).PLAN_SORT_MODES.SELECTION)),class:f(["px-3 py-1 rounded-md text-sm border flex items-center gap-1",s(l).sortMode===s(m).PLAN_SORT_MODES.SELECTION?"bg-indigo-500 text-white border-indigo-500":"bg-white text-gray-700 border-gray-300 hover:border-indigo-300"])},[x[8]||(x[8]=N(" 选中排序 ",-1)),s(l).sortMode===s(m).PLAN_SORT_MODES.SELECTION?(i(),n("svg",Pt,[s(l).sortDirection==="asc"?(i(),n("path",kt)):(i(),n("path",Ct))])):v("",!0)],2),e("div",St,[e("button",{onClick:p,disabled:u.value,class:"px-3 py-1 bg-green-500 text-white rounded-md text-sm hover:bg-green-600 disabled:opacity-50 disabled:cursor-not-allowed"},[u.value?(i(),n("span",Mt,"选择中...")):(i(),n("span",Lt,"全选"))],8,Et),e("button",{onClick:x[4]||(x[4]=(...b)=>s(l).clearAllSelected&&s(l).clearAllSelected(...b)),class:"px-3 py-1 bg-red-500 text-white rounded-md text-sm hover:bg-red-600"}," 清空 ")])])]),e("div",{ref_key:"availableWordsContainer",ref:o,class:"flex-1 min-h-0"},[S(s(W),{class:"scroller available-words-scroller",items:s(l).sortedAvailableWords,"item-size":100,"key-field":"original"},{default:V(({item:b})=>[e("div",{onClick:P=>s(l).toggleWordSelection(b),class:f(["p-3 mx-2 mb-2 border rounded-lg cursor-pointer transition-all hover:shadow-md",s(l).isWordSelected(b)?"border-indigo-500 bg-indigo-50":"border-gray-200 hover:border-gray-300"])},[e("div",Ft,[e("div",At,[e("div",Ot,c(b.original),1),e("div",$t,c(b.translation),1),e("div",Tt,c(b.__groupName),1)]),e("div",It,[e("div",{class:f(s(l).getWordRatingDisplay(b).color)},c(s(l).getWordRatingDisplay(b).text),3),s(l).isWordSelected(b)?(i(),n("div",Dt,x[10]||(x[10]=[e("svg",{class:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M5 13l4 4L19 7"})],-1)]))):v("",!0)])])],10,Nt)]),_:1},8,["items"])],512)]))}}),Gt=T(Rt,[["__scopeId","data-v-1ab27dde"]]),Bt={class:"bg-white rounded-lg shadow-lg p-4 flex flex-1 flex-col"},Wt={class:"flex items-center justify-between mb-4"},jt={class:"text-sm text-gray-500"},zt={class:"p-3 mx-2 mb-1 border border-gray-200 rounded-lg bg-gray-50"},Vt={class:"flex items-center justify-between"},Ut={class:"flex-1"},Yt={class:"font-medium"},Ht={class:"text-sm text-gray-600"},Kt={class:"text-xs text-gray-500 mt-1"},qt=["onClick"],Jt={key:1,class:"flex-1 flex items-center justify-center"},Xt=A({__name:"SelectedWordsPanel",setup(O){const l=F(),o=h();return(u,p)=>(i(),n("div",Bt,[e("div",Wt,[p[0]||(p[0]=e("h2",{class:"text-xl font-semibold text-gray-800"},"已选单词清单",-1)),e("div",jt," 已选 "+c(s(l).selectedWords.length)+" 个单词 ",1)]),s(l).selectedWords.length>0?(i(),n("div",{key:0,ref_key:"selectedWordsContainer",ref:o,class:"flex-1 min-h-0 border border-gray-200 rounded-md"},[S(s(W),{class:"scroller selected-words-scroller",items:s(l).selectedWordsWithKeys,"item-size":90,"key-field":"uniqueKey"},{default:V(({item:y})=>[e("div",zt,[e("div",Vt,[e("div",Ut,[e("div",Yt,c(y.word.original),1),e("div",Ht,c(y.word.translation),1),e("div",Kt,c(y.word.__groupName),1)]),e("button",{onClick:x=>s(l).removeSelectedWord(y.word),class:"ml-2 p-1 text-red-500 hover:text-red-700 hover:bg-red-50 rounded"},p[1]||(p[1]=[e("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]),8,qt)])])]),_:1},8,["items"])],512)):(i(),n("div",Jt,p[2]||(p[2]=[se('<div class="text-center" data-v-02aae4b3><div class="text-gray-400 mb-2" data-v-02aae4b3><svg class="w-12 h-12 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-02aae4b3><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" data-v-02aae4b3></path></svg></div><p class="text-gray-500 text-sm" data-v-02aae4b3>还没有选择任何单词</p><p class="text-gray-400 text-xs mt-1" data-v-02aae4b3>从左侧选择单词添加到学习计划中</p></div>',1)])))]))}}),Zt=T(Xt,[["__scopeId","data-v-02aae4b3"]]),Qt={class:"w-full h-full"},es={class:"text-center mb-6"},ts={class:"text-3xl font-bold text-gray-800 mb-2"},ss={class:"text-gray-600"},os={class:"grid grid-cols-1 lg:grid-cols-3 gap-4 h-[calc(100vh-12rem)] w-full"},rs=A({name:"CreatePlan",__name:"CreatePlanView",setup(O){const l=F(),o=j(()=>l.isEditing?"编辑学习计划":"创建学习计划");return z(async()=>{if(l.isEditing&&l.editingPlan){const u=l.editingPlan;l.currentPlanForm.name=u.name,l.currentPlanForm.description=u.description,l.currentPlanForm.dailyTarget=u.dailyTarget,l.currentPlanForm.duration=u.duration,l.currentPlanForm.selectionMode=u.selectionMode,await B(),u.selectionMode===m.PLAN_SELECTION_MODES.BY_GROUP&&u.selectedGroups&&(l.currentPlanForm.selectedGroups=u.selectedGroups.map(p=>({fileIdx:p.fileIdx,groupName:p.groupName}))),await B(),l.selectedWords=[...u.words||[]]}else l.resetForm()}),(u,p)=>(i(),n("div",Qt,[e("div",es,[e("h1",ts,c(o.value),1),e("p",ss,c(s(l).isEditing?"修改学习计划配置，优化学习效果":"制定个性化的单词学习计划，提升学习效率"),1)]),e("div",os,[S(ut),S(Gt),S(Zt)])]))}}),as=T(rs,[["__scopeId","data-v-fd564518"]]);export{as as default};
