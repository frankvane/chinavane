import{h as M,A as y,b as H,d as J,u as K}from"./index-CNVOlx-d.js";import{W as Z,P as Q,a as X,_ as ee,H as te}from"./PronunciationResultModal-u6Hb3_57.js";import{E as P,B as _,e as m,G as e,f as b,J as u,Y as se,o as d,u as oe,A as E,v as $,K as i,I as S,c as T,F as O,k as B,r as re,Z as R,g as C,j as ne,C as I,L as le,M as ae,n as Y}from"./vue-BPmSeTKS.js";import{d as de,e as ie,h as ue,i as ce,j as ge,k as D,l as A,m as V,n as z,s as ve,o as pe}from"./planStudyHelpers-CQmQDwkq.js";import"./dayjs-Bof1u0Bp.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const me={key:0,class:"bg-white rounded-lg shadow-lg p-6 mb-6"},xe={class:"flex items-center justify-between mb-4"},ye={class:"text-2xl font-bold text-gray-900"},_e={key:0,class:"text-gray-600 mt-1"},fe=P({__name:"PlanStudyHeader",setup(W){const x=se(),o=M(),g=_(()=>o.activePlan),p=()=>{x.push("/plan-manage")};return(c,n)=>(d(),m("div",null,[n[0]||(n[0]=e("div",{class:"text-center mb-8"},[e("h1",{class:"text-3xl font-bold text-gray-800 mb-2"},"è®¡åˆ’å­¦ä¹ "),e("p",{class:"text-gray-600"},"ä¸“æ³¨å­¦ä¹ ï¼Œæå‡æ•ˆç‡")],-1)),g.value?(d(),m("div",me,[e("div",xe,[e("div",null,[e("h2",ye,u(g.value.name),1),g.value.description?(d(),m("p",_e,u(g.value.description),1)):b("",!0)]),e("div",{class:"flex items-center gap-4"},[e("button",{onClick:p,class:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 transition-colors"}," è¿”å›ç®¡ç† ")])])])):b("",!0)]))}}),he={key:0},be={class:"grid grid-cols-4 gap-4 mb-6"},We={class:"text-center"},Se={class:"text-2xl font-bold text-indigo-600"},ke={class:"text-center"},Pe={class:"text-2xl font-bold text-green-600"},we={class:"text-center"},$e={class:"text-2xl font-bold text-orange-600"},Te={class:"text-center"},Ce={class:"text-2xl font-bold text-blue-600"},Me={class:"mb-6"},De={class:"flex justify-between text-sm text-gray-600 mb-2"},Ye={class:"w-full bg-gray-200 rounded-full h-3"},Ie=P({__name:"PlanStudyStats",setup(W){const x=M(),o=_(()=>x.activePlan),g=_(()=>x.completedWordsCount),p=_(()=>x.remainingWordsCount),c=()=>!o.value||o.value.progress.totalWords===0?0:Math.round(g.value/o.value.progress.totalWords*100);return(n,s)=>o.value?(d(),m("div",he,[e("div",be,[e("div",We,[e("div",Se,u(o.value.progress.totalWords),1),s[0]||(s[0]=e("div",{class:"text-sm text-gray-500"},"è®¡åˆ’ç›®æ ‡",-1))]),e("div",ke,[e("div",Pe,u(g.value),1),s[1]||(s[1]=e("div",{class:"text-sm text-gray-500"},"å·²å®Œæˆ",-1))]),e("div",we,[e("div",$e,u(p.value),1),s[2]||(s[2]=e("div",{class:"text-sm text-gray-500"},"å‰©ä½™",-1))]),e("div",Te,[e("div",Ce,u(o.value.progress.currentDay),1),s[3]||(s[3]=e("div",{class:"text-sm text-gray-500"},"å½“å‰å¤©æ•°",-1))])]),e("div",Me,[e("div",De,[s[4]||(s[4]=e("span",null,"å­¦ä¹ è¿›åº¦",-1)),e("span",null,u(c())+"%",1)]),e("div",Ye,[e("div",{class:"bg-indigo-600 h-3 rounded-full transition-all",style:oe({width:`${c()}%`})},null,4)])])])):b("",!0)}}),Ae={class:"mb-6"},Ee={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},Ne=["disabled"],Ue={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Le={key:1,class:"w-5 h-5 animate-spin",fill:"none",viewBox:"0 0 24 24"},je=P({__name:"PlanStudyControls",props:{studyMode:{}},emits:["update:studyMode"],setup(W,{emit:x}){const o=x,g=M(),p=E(!1),c=_(()=>{const t=g.activePlan;return t?t.progress.wordsToday||[]:[]}),n=_(()=>{const t=g.activePlan;return t?t.progress.completedWords||[]:[]}),s=_(()=>{const t=g.activePlan;return t?t.words||[]:[]}),r=t=>{o("update:studyMode",t)},v=async()=>{if(confirm("ç¡®å®šè¦é‡ç½®å½“å‰è®¡åˆ’çš„å­¦ä¹ è¿›åº¦å—ï¼Ÿè¿™å°†æ¸…é™¤æ‰€æœ‰å­¦ä¹ è®°å½•å’Œè¿›åº¦ã€‚"))try{p.value=!0,await g.resetPlanProgress()}catch{alert("é‡ç½®è®¡åˆ’å¤±è´¥ï¼Œè¯·é‡è¯•")}finally{p.value=!1}};return(t,l)=>(d(),m("div",Ae,[e("div",Ee,[e("button",{onClick:l[0]||(l[0]=k=>r(i(y).STUDY_MODES.TODAY)),class:$(["px-6 py-3 rounded-lg font-medium transition-colors flex items-center gap-2 text-sm",t.studyMode===i(y).STUDY_MODES.TODAY?"bg-indigo-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"])},[l[3]||(l[3]=e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})],-1)),S(" ä»Šæ—¥å­¦ä¹  ("+u(c.value.length)+") ",1)],2),e("button",{onClick:l[1]||(l[1]=k=>r(i(y).STUDY_MODES.REVIEW)),class:$(["px-6 py-3 rounded-lg font-medium transition-colors flex items-center gap-2 text-sm",t.studyMode===i(y).STUDY_MODES.REVIEW?"bg-green-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"])},[l[4]||(l[4]=e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),S(" å¤ä¹ å·²å®Œæˆ ("+u(n.value.length)+") ",1)],2),e("button",{onClick:l[2]||(l[2]=k=>r(i(y).STUDY_MODES.ALL)),class:$(["px-6 py-3 rounded-lg font-medium transition-colors flex items-center gap-2 text-sm",t.studyMode===i(y).STUDY_MODES.ALL?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"])},[l[5]||(l[5]=e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 10h16M4 14h16M4 18h16"})],-1)),S(" å…¨éƒ¨å•è¯ ("+u(s.value.length)+") ",1)],2),e("button",{onClick:v,disabled:p.value,class:$(["px-6 py-3 rounded-lg font-medium transition-colors flex items-center gap-2 text-sm",p.value?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-red-200 text-red-700 hover:bg-red-300"])},[p.value?(d(),m("svg",Le,l[7]||(l[7]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):(d(),m("svg",Ue,l[6]||(l[6]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)]))),S(" "+u(p.value?"é‡ç½®ä¸­...":"é‡ç½®å­¦ä¹ "),1)],10,Ne)])]))}}),Oe={class:"bg-white rounded-lg shadow-lg p-6 mb-6"},Be={class:"flex items-center justify-between mb-6"},Ve={class:"flex items-center gap-4"},ze={class:"text-lg font-medium text-gray-900"},He={class:"flex items-center gap-2"},Re=["disabled"],Ge=["disabled"],qe={key:0,class:"mb-4 p-4 bg-blue-50 rounded-lg"},Fe={class:"text-center"},Je={class:"text-lg font-semibold text-blue-800 mb-2"},Ke={class:"text-sm text-blue-600"},Ze={class:"flex justify-center"},Qe={key:1,class:"text-center py-8 text-gray-500"},Xe=P({__name:"PlanStudyArea",props:{studyMode:{},currentWordIndex:{},currentWords:{},currentWord:{}},emits:["update:currentWordIndex","markCompleted","shuffle"],setup(W,{emit:x}){const o=W,g=x,p=M(),c=()=>{o.currentWordIndex>0&&g("update:currentWordIndex",o.currentWordIndex-1)},n=()=>{o.currentWordIndex<o.currentWords.length-1&&g("update:currentWordIndex",o.currentWordIndex+1)},s=()=>{if(!o.currentWord||!p.activePlan)return"";const r=p.getWordProgress(o.currentWord);if(r.isCompleted)return`âœ… å·²å®Œæˆ (${r.passCount}/${r.requiredPasses}æ¬¡åˆæ ¼)`;{const v=r.passCount>0?`${r.passCount}æ¬¡åˆæ ¼`:"å°šæœªåˆæ ¼",t=r.totalAttempts>0?`ï¼Œå…±${r.totalAttempts}æ¬¡å°è¯•`:"";return`ğŸ¯ éœ€è¦${r.requiredPasses}æ¬¡åˆæ ¼ç»ƒä¹  (å½“å‰: ${v}${t})`}};return(r,v)=>(d(),m("div",Oe,[e("div",Be,[e("div",Ve,[e("span",ze,u(i(de)(o.studyMode))+" - "+u(r.currentWordIndex+1)+"/"+u(r.currentWords.length),1),e("div",He,[e("button",{onClick:c,disabled:r.currentWordIndex===0,class:$(["px-3 py-1 rounded text-sm transition-colors",r.currentWordIndex===0?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-blue-500 text-white hover:bg-blue-600"])}," ä¸Šä¸€ä¸ª ",10,Re),e("button",{onClick:n,disabled:r.currentWordIndex===r.currentWords.length-1,class:$(["px-3 py-1 rounded text-sm transition-colors",r.currentWordIndex===r.currentWords.length-1?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-blue-500 text-white hover:bg-blue-600"])}," ä¸‹ä¸€ä¸ª ",10,Ge)])])]),r.currentWord&&i(p).activePlan?(d(),m("div",qe,[e("div",Fe,[e("h3",Je,u(typeof r.currentWord=="string"?r.currentWord:r.currentWord.original),1),e("div",Ke,u(s()),1)])])):b("",!0),e("div",Ze,[r.currentWord?(d(),T(Z,{key:0,word:r.currentWord,wordIndex:r.currentWordIndex,fileIdx:r.currentWord.__fileIdx,groupName:r.currentWord.__groupName,studyType:"plan"},null,8,["word","wordIndex","fileIdx","groupName"])):(d(),m("div",Qe,"æ²¡æœ‰å¯å­¦ä¹ çš„å•è¯"))])]))}}),et={key:0,class:"mt-6 bg-gray-50 rounded-lg p-4"},tt={class:"grid grid-cols-2 gap-4 text-sm"},st={class:"flex items-center justify-between"},ot={class:"font-medium"},rt={class:"flex items-center justify-between"},nt={class:"font-medium"},lt={class:"flex items-center justify-between"},at={class:"font-medium"},dt={class:"flex items-center justify-between"},it={class:"font-medium"},ut=P({__name:"PlanStudyWordInfo",props:{currentWord:{}},setup(W){const x=W,o=M(),g=H(),p=_(()=>o.activePlan?.id),c=_(()=>(g.practiceDataTrigger,ie(x.currentWord.original,y.STUDY_TYPES.PLAN,p.value))),n=_(()=>(g.practiceDataTrigger,ue(x.currentWord,y.STUDY_TYPES.PLAN,p.value))),s=_(()=>(g.practiceDataTrigger,ce(x.currentWord,y.STUDY_TYPES.PLAN,p.value))),r=_(()=>(g.practiceDataTrigger,ge(x.currentWord,y.STUDY_TYPES.PLAN,p.value)));return(v,t)=>v.currentWord?(d(),m("div",et,[t[4]||(t[4]=e("h4",{class:"text-lg font-medium text-gray-900 mb-3"},"å½“å‰å•è¯è¯„åˆ†ä¿¡æ¯",-1)),e("div",tt,[e("div",st,[t[0]||(t[0]=e("span",{class:"text-gray-600"},"ç»ƒä¹ æ¬¡æ•°:",-1)),e("span",ot,u(c.value),1)]),e("div",rt,[t[1]||(t[1]=e("span",{class:"text-gray-600"},"å¹³å‡åˆ†æ•°:",-1)),e("span",nt,u(n.value)+"%",1)]),e("div",lt,[t[2]||(t[2]=e("span",{class:"text-gray-600"},"æœ€é«˜åˆ†æ•°:",-1)),e("span",at,u(s.value)+"%",1)]),e("div",dt,[t[3]||(t[3]=e("span",{class:"text-gray-600"},"æœ€è¿‘ç»ƒä¹ :",-1)),e("span",it,u(r.value),1)])])])):b("",!0)}}),ct={class:"bg-white rounded-lg shadow-lg p-6 mt-6"},gt={key:0,class:"mb-6"},vt={class:"text-md font-medium text-orange-600 mb-3 flex items-center gap-2"},pt={class:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 xl:grid-cols-8 gap-3"},mt=["onClick"],xt={class:"text-sm font-medium text-gray-900 truncate"},yt={class:"flex items-center justify-between mt-1"},_t={class:"text-xs text-gray-500"},ft={class:"mt-1 text-xs text-gray-500"},ht={key:0},bt={key:1},Wt={key:1},St={class:"text-md font-medium text-green-600 mb-3 flex items-center gap-2"},kt={class:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 xl:grid-cols-8 gap-3"},Pt=["onClick"],wt={class:"text-sm font-medium text-gray-900 truncate"},$t={class:"flex items-center justify-between mt-1"},Tt={class:"text-xs text-gray-500"},Ct={class:"mt-1 text-xs text-gray-500"},Mt={key:0},Dt={key:1},Yt={key:2,class:"text-center py-8"},It=P({__name:"PlanStudyWordList",props:{currentWords:{},currentWordIndex:{},activePlan:{},studyMode:{}},emits:["goToWord"],setup(W,{emit:x}){const o=W,g=x,p=M(),c=_(()=>o.activePlan?o.currentWords.filter(v=>!p.isWordCompleted(v)):[]),n=_(()=>o.activePlan?o.currentWords.filter(v=>p.isWordCompleted(v)):[]),s=r=>{g("goToWord",r)};return(r,v)=>(d(),m("div",ct,[v[7]||(v[7]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"å•è¯åˆ—è¡¨",-1)),c.value.length>0?(d(),m("div",gt,[e("h4",vt,[v[0]||(v[0]=e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),S(" æœªå®Œæˆå•è¯ ("+u(c.value.length)+") ",1)]),e("div",pt,[(d(!0),m(O,null,B(c.value,(t,l)=>(d(),m("div",{key:`incomplete-${l}`,class:$(["p-3 rounded-lg border-2 cursor-pointer transition-all",i(D)(t,o.currentWords)===r.currentWordIndex?"border-indigo-500 bg-indigo-50":"border-orange-200 hover:border-orange-300 bg-orange-50"]),onClick:k=>s(i(D)(t,o.currentWords))},[e("div",xt,u(typeof t=="string"?t:t.original),1),e("div",yt,[e("span",_t,"#"+u(i(D)(t,o.currentWords)+1),1),v[1]||(v[1]=e("span",{class:"text-xs text-orange-600 font-medium"},"æœªå®Œæˆ",-1))]),e("div",ft,[i(A)(t,i(y).STUDY_TYPES.PLAN)>0?(d(),m("span",ht,[S(" ç»ƒä¹ "+u(i(A)(t,i(y).STUDY_TYPES.PLAN))+"æ¬¡",1),v[2]||(v[2]=e("br",null,null,-1)),S(" å¹³å‡"+u(i(V)(t,i(y).STUDY_TYPES.PLAN))+"% | æœ€é«˜"+u(i(z)(t,i(y).STUDY_TYPES.PLAN))+"% ",1)])):(d(),m("span",bt,"æœªç»ƒä¹ "))])],10,mt))),128))])])):b("",!0),n.value.length>0&&o.studyMode!=="today"?(d(),m("div",Wt,[e("h4",St,[v[3]||(v[3]=e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),S(" å·²å®Œæˆå•è¯ ("+u(n.value.length)+") ",1)]),e("div",kt,[(d(!0),m(O,null,B(n.value,(t,l)=>(d(),m("div",{key:`completed-${l}`,class:$(["p-3 rounded-lg border-2 cursor-pointer transition-all",i(D)(t,o.currentWords)===r.currentWordIndex?"border-indigo-500 bg-indigo-50":"border-green-200 hover:border-green-300 bg-green-50"]),onClick:k=>s(i(D)(t,o.currentWords))},[e("div",wt,u(typeof t=="string"?t:t.original),1),e("div",$t,[e("span",Tt,"#"+u(i(D)(t,o.currentWords)+1),1),v[4]||(v[4]=e("span",{class:"text-xs text-green-600 font-medium"},"å·²å®Œæˆ",-1))]),e("div",Ct,[i(A)(t,i(y).STUDY_TYPES.PLAN)>0?(d(),m("span",Mt,[S(" ç»ƒä¹ "+u(i(A)(t,i(y).STUDY_TYPES.PLAN))+"æ¬¡",1),v[5]||(v[5]=e("br",null,null,-1)),S(" å¹³å‡"+u(i(V)(t,i(y).STUDY_TYPES.PLAN))+"% | æœ€é«˜"+u(i(z)(t,i(y).STUDY_TYPES.PLAN))+"% ",1)])):(d(),m("span",Dt,"æœªç»ƒä¹ "))])],10,Pt))),128))])])):b("",!0),c.value.length===0&&n.value.length===0?(d(),m("div",Yt,v[6]||(v[6]=[e("div",{class:"text-gray-400 mb-2"},[e("svg",{class:"w-12 h-12 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1),e("p",{class:"text-gray-500"},"å½“å‰æ¨¡å¼ä¸‹æ²¡æœ‰å•è¯",-1)]))):b("",!0)]))}}),At={class:"bg-white rounded-lg shadow-lg p-8 text-center"},Et=P({__name:"PlanStudyEmpty",setup(W){return(x,o)=>{const g=re("router-link");return d(),m("div",At,[o[1]||(o[1]=R('<div class="text-gray-400 mb-4"><svg class="w-16 h-16 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg></div><h3 class="text-lg font-medium text-gray-900 mb-2">æ²¡æœ‰æ´»è·ƒçš„å­¦ä¹ è®¡åˆ’</h3><p class="text-gray-500 mb-4">è¯·å…ˆé€‰æ‹©ä¸€ä¸ªå­¦ä¹ è®¡åˆ’å¼€å§‹å­¦ä¹ </p>',3)),C(g,{to:"/plan-manage",class:"inline-flex items-center px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition-colors"},{default:ne(()=>o[0]||(o[0]=[S(" é€‰æ‹©å­¦ä¹ è®¡åˆ’ ",-1)])),_:1,__:[0]})])}}}),Nt={class:"bg-white rounded-lg shadow-lg p-8 text-center"},Ut={class:"flex items-center justify-center gap-4"},Lt=P({__name:"PlanStudyNoWords",emits:["setStudyMode"],setup(W,{emit:x}){const o=x,g=p=>{o("setStudyMode",p)};return(p,c)=>(d(),m("div",Nt,[c[2]||(c[2]=R('<div class="text-gray-400 mb-4"><svg class="w-16 h-16 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg></div><h3 class="text-lg font-medium text-gray-900 mb-2">å½“å‰æ¨¡å¼ä¸‹æ²¡æœ‰å•è¯</h3><p class="text-gray-500 mb-4">è¯·é€‰æ‹©å…¶ä»–å­¦ä¹ æ¨¡å¼æˆ–å®Œæˆå½“å‰å­¦ä¹ ä»»åŠ¡</p>',3)),e("div",Ut,[e("button",{onClick:c[0]||(c[0]=n=>g(i(y).STUDY_MODES.TODAY)),class:"px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700 transition-colors"}," åˆ‡æ¢åˆ°ä»Šæ—¥å­¦ä¹  "),e("button",{onClick:c[1]||(c[1]=n=>g(i(y).STUDY_MODES.ALL)),class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors"}," åˆ‡æ¢åˆ°å…¨éƒ¨å•è¯ ")])]))}}),jt={class:"min-h-screen w-full p-6"},Ot={class:"w-full"},Bt={key:0,class:"bg-white rounded-lg shadow-lg p-6 mb-6"},Vt={class:"flex justify-center"},zt={class:"w-full max-w-2xl"},Zt=P({name:"PlanStudy",__name:"PlanStudyView",setup(W){const x=M(),o=J(),g=H(),p=K(),c=E(y.STUDY_MODES.TODAY),n=E(0),s=_(()=>x.activePlan),r=_(()=>s.value?s.value.progress.wordsToday||[]:[]),v=_(()=>s.value?s.value.progress.completedWords||[]:[]),t=_(()=>{if(!s.value)return[];const a=s.value.words;return!a||!Array.isArray(a)?[]:a}),l=_(()=>{let a;switch(c.value){case y.STUDY_MODES.TODAY:a=r.value;break;case y.STUDY_MODES.REVIEW:a=v.value;break;case y.STUDY_MODES.ALL:a=t.value;break;default:a=[]}return a}),k=_(()=>{if(l.value.length===0||n.value>=l.value.length)return null;const a=l.value[n.value];if(typeof a=="string"){const h=s.value?.words?.find(f=>typeof f=="object"&&f.original===a);return h&&typeof h=="object"?{...h,__fileIdx:h.__fileIdx||0,__groupName:h.__groupName||"",__fileName:h.__fileName||""}:{original:a,translation:"",phonetic:"",breakdown:[],__fileIdx:0,__groupName:"",__fileName:""}}return a}),N=a=>{ve(a,c,n)},G=()=>{if(!k.value)return;x.markWordAsCompleted(k.value,c.value)&&Y(()=>{l.value.length>0&&n.value>=l.value.length&&(n.value=0)})},q=()=>{pe(n)},F=a=>{l.value.length>0?a>=l.value.length?n.value=0:n.value=a:n.value=0};I(c,()=>{n.value=0}),I(l,a=>{n.value>=a.length&&(n.value=Math.max(0,a.length-1))}),I(()=>o.pronunciationResult,a=>{if(a&&!a.error&&s.value){o.setPronunciationResult(a,!0);const h=a.targetWord;Y(()=>{if(!s.value)return;const f=l.value.find(w=>(typeof w=="string"?w:w.original)===h)||h,j=x.getWordProgress(f).isCompleted;if(j&&c.value===y.STUDY_MODES.TODAY&&s.value&&s.value.progress.wordsToday){const w=s.value.progress.wordsToday.indexOf(h);w>-1&&s.value.progress.wordsToday.splice(w,1)}j&&setTimeout(()=>{Y(()=>{Y(()=>{if(l.value.length>0){n.value>=l.value.length&&(n.value=0);const w=n.value;n.value=-1,Y(()=>{n.value=w})}})})},3e3)})}});const U=()=>{const a=window.pageYOffset||document.documentElement.scrollTop;p.setShowBackToTop(a>300)};return I(s,a=>{a&&(n.value=0)}),le(()=>{if(window.addEventListener("scroll",U),s.value){if(s.value.progress.wordsToday.length===0&&s.value.words.length>0){const a=Math.min(s.value.dailyTarget,s.value.words.length),h=s.value.words.filter(f=>!s.value?.progress.completedWords.includes(typeof f=="string"?f:f.original));if(s.value.progress.wordsToday=h.slice(0,a).map(f=>typeof f=="string"?f:f.original),s.value){const f=x.studyPlans.findIndex(L=>L.id===s.value?.id);f!==-1&&(x.studyPlans[f]={...s.value})}}}}),ae(()=>{window.removeEventListener("scroll",U)}),(a,h)=>(d(),m("div",jt,[e("div",Ot,[C(fe),s.value?(d(),m("div",Bt,[C(Ie),C(je,{studyMode:c.value,"onUpdate:studyMode":N},null,8,["studyMode"])])):(d(),T(Et,{key:1})),e("div",Vt,[e("div",zt,[s.value&&l.value.length>0?(d(),T(Xe,{key:0,studyMode:c.value,currentWordIndex:n.value,currentWords:l.value,currentWord:k.value,"onUpdate:currentWordIndex":h[0]||(h[0]=f=>n.value=f),onMarkCompleted:G,onShuffle:q},null,8,["studyMode","currentWordIndex","currentWords","currentWord"])):b("",!0)])]),s.value&&l.value.length>0?(d(),T(ut,{key:2,currentWord:k.value},null,8,["currentWord"])):b("",!0),s.value&&l.value.length>0?(d(),T(It,{key:3,currentWords:l.value,currentWordIndex:n.value,activePlan:s.value,studyMode:c.value,onGoToWord:F},null,8,["currentWords","currentWordIndex","activePlan","studyMode"])):s.value&&l.value.length===0?(d(),T(Lt,{key:4,onSetStudyMode:N})):b("",!0)]),C(Q),C(X),i(g).showWordHistoryModal?(d(),T(te,{key:0})):b("",!0),C(ee)]))}});export{Zt as default};
