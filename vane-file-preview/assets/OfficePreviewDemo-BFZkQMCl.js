import{r as s,j as e}from"./index-BzkV6I-U.js";import{M as x,z as m,B as f,O as h,F as v,T as u,D as g,J as w}from"./index.es-BiicTeKE.js";import"./tomorrow-CyxK5Zwx.js";const r=[{name:"sample-online.docx",size:100*1024,type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",extension:".docx",url:"https://chinavane.netlify.app/test.docx",previewMode:"online"},{name:"sample-mammoth.docx",size:21*1024,type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",extension:".docx",url:"./sample.docx",previewMode:"offline",docxMode:"mammoth"},{name:"sample-docx-preview.docx",size:21*1024,type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",extension:".docx",url:"./sample.docx",previewMode:"offline",docxMode:"docx-preview"},{name:"sample.xlsx",size:13*1024,type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",extension:".xlsx",url:"./sample.xlsx"},{name:"sample.pptx",size:2042*1024,type:"application/vnd.openxmlformats-officedocument.presentationml.presentation",extension:".pptx",url:"./sample.pptx"}];function j(){const[o,l]=s.useState(r[0]),[t,c]=s.useState(!1),a=s.useMemo(()=>{const n=o.previewMode==="online",i=o.previewMode==="offline",d=o.docxMode||"mammoth",p=[x({enabled:i&&d==="mammoth"}),m({enabled:i&&d==="docx-preview"}),f(),h(),v({preferDocxOnline:n||!i&&t,viewer:"google"})];return u(w,p)},[t,o]);return e.jsx(g,{title:"Office文档预览",description:"展示Office文档的预览功能，支持DOCX、XLSX、PPTX等格式，提供在线和离线两种预览模式",children:e.jsxs("div",{style:{display:"flex",height:"600px",gap:16,padding:16,boxSizing:"border-box"},children:[e.jsxs("div",{style:{width:240,background:"#f5f5f5",borderRadius:8,padding:16,overflow:"auto",flexShrink:0},children:[e.jsx("h3",{style:{margin:"0 0 16px",fontSize:16},children:"Office文件"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:r.map((n,i)=>e.jsxs("button",{onClick:()=>l(n),style:{padding:"12px 16px",background:o.name===n.name?"#2196f3":"#fff",color:o.name===n.name?"#fff":"#333",border:"1px solid #ddd",borderRadius:6,textAlign:"left",cursor:"pointer",transition:"all 0.2s",fontSize:14},children:[e.jsx("div",{style:{fontWeight:500},children:n.name}),e.jsxs("div",{style:{fontSize:12,marginTop:4,opacity:.8},children:[n.extension," • ",(n.size/1024).toFixed(0)," KB"]}),n.previewMode&&e.jsx("div",{style:{fontSize:10,marginTop:2,opacity:.7,fontStyle:"italic"},children:n.previewMode==="online"?"在线预览":n.docxMode==="mammoth"?"离线预览 (Mammoth)":"离线预览 (docx-preview)"})]},i))})]}),e.jsxs("div",{style:{flex:1,background:"#fff",borderRadius:8,overflow:"hidden",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)"},children:[o.extension.toLowerCase()===".docx"&&!o.previewMode&&e.jsx("div",{style:{padding:8,borderBottom:"1px solid #eee"},children:e.jsxs("label",{style:{fontSize:12,color:"#555"},children:[e.jsx("input",{type:"checkbox",checked:t,onChange:n=>c(n.target.checked),style:{marginRight:8}}),"Prefer online viewer for DOCX (Office Online)"]})}),o.extension.toLowerCase()===".docx"&&o.previewMode&&e.jsxs("div",{style:{padding:8,borderBottom:"1px solid #eee",background:o.previewMode==="online"?"#e3f2fd":"#f3e5f5",fontSize:12,color:"#555"},children:["📄"," ",o.previewMode==="online"?"在线预览 (Office Online)":`离线预览 (${o.docxMode==="mammoth"?"Mammoth":"docx-preview"})`]}),e.jsx(a,{file:o})]})]})})}export{j as default};
