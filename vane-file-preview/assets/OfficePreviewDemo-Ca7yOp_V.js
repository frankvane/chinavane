import{r,j as e}from"./index-yyTIZa1r.js";import{w as x,D as m,F as f}from"./withPlugins-B1NQYkWQ.js";import{c as v,a as h,b as u,d as g,e as w}from"./PptxPreviewPlugin-Cjh95eEH.js";import"./tomorrow-BYMbY9rn.js";import"./ToolbarComponents-BZEdwMd_.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";import"./jszip.min-DpW3x3L_.js";const d=[{name:"sample-online.docx",size:100*1024,type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",extension:".docx",url:"https://chinavane.netlify.app/test.docx",previewMode:"online"},{name:"sample-mammoth.docx",size:21*1024,type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",extension:".docx",url:"./sample.docx",previewMode:"offline",docxMode:"mammoth"},{name:"sample-docx-preview.docx",size:21*1024,type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",extension:".docx",url:"./sample.docx",previewMode:"offline",docxMode:"docx-preview"},{name:"sample.xlsx",size:13*1024,type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",extension:".xlsx",url:"./sample.xlsx"},{name:"sample.pptx",size:2042*1024,type:"application/vnd.openxmlformats-officedocument.presentationml.presentation",extension:".pptx",url:"./sample.pptx"}];function z(){const[o,l]=r.useState(d[0]),[t,c]=r.useState(!1),a=r.useMemo(()=>{const i=o.previewMode==="online",n=o.previewMode==="offline",s=o.docxMode||"mammoth",p=[v({enabled:n&&s==="mammoth"}),h({enabled:n&&s==="docx-preview"}),u(),g(),w({preferDocxOnline:i||!n&&t,viewer:"google"})];return x(f,p)},[t,o]);return e.jsx(m,{title:"Office文档预览",description:"展示Office文档的预览功能，支持DOCX、XLSX、PPTX等格式，提供在线和离线两种预览模式",children:e.jsxs("div",{style:{display:"flex",height:"600px",gap:16,padding:16,boxSizing:"border-box"},children:[e.jsxs("div",{style:{width:240,background:"#f5f5f5",borderRadius:8,padding:16,overflow:"auto",flexShrink:0},children:[e.jsx("h3",{style:{margin:"0 0 16px",fontSize:16},children:"Office文件"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:d.map((i,n)=>e.jsxs("button",{onClick:()=>l(i),style:{padding:"12px 16px",background:o.name===i.name?"#2196f3":"#fff",color:o.name===i.name?"#fff":"#333",border:"1px solid #ddd",borderRadius:6,textAlign:"left",cursor:"pointer",transition:"all 0.2s",fontSize:14},children:[e.jsx("div",{style:{fontWeight:500},children:i.name}),e.jsxs("div",{style:{fontSize:12,marginTop:4,opacity:.8},children:[i.extension," • ",(i.size/1024).toFixed(0)," KB"]}),i.previewMode&&e.jsx("div",{style:{fontSize:10,marginTop:2,opacity:.7,fontStyle:"italic"},children:i.previewMode==="online"?"在线预览":i.docxMode==="mammoth"?"离线预览 (Mammoth)":"离线预览 (docx-preview)"})]},n))})]}),e.jsxs("div",{style:{flex:1,background:"#fff",borderRadius:8,overflow:"hidden",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)"},children:[o.extension.toLowerCase()===".docx"&&!o.previewMode&&e.jsx("div",{style:{padding:8,borderBottom:"1px solid #eee"},children:e.jsxs("label",{style:{fontSize:12,color:"#555"},children:[e.jsx("input",{type:"checkbox",checked:t,onChange:i=>c(i.target.checked),style:{marginRight:8}}),"Prefer online viewer for DOCX (Office Online)"]})}),o.extension.toLowerCase()===".docx"&&o.previewMode&&e.jsxs("div",{style:{padding:8,borderBottom:"1px solid #eee",background:o.previewMode==="online"?"#e3f2fd":"#f3e5f5",fontSize:12,color:"#555"},children:["📄"," ",o.previewMode==="online"?"在线预览 (Office Online)":`离线预览 (${o.docxMode==="mammoth"?"Mammoth":"docx-preview"})`]}),e.jsx(a,{file:o})]})]})})}export{z as default};
